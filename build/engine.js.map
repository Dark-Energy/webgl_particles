{"version":3,"sources":["webpack:///engine.js","webpack:///webpack/bootstrap 55cbc58a5748dca1990a","webpack:///./src/base/my_lib.js","webpack:///./src/particles/particle_affector.js","webpack:///./src/particles/particle_emitter.js","webpack:///./src/base/mouse_camera_controller.js","webpack:///./src/particles/particles_points.js","webpack:///./src/base/event_hub.js","webpack:///./src/base/mouse_intersector.js","webpack:///./src/base/simple_collider.js","webpack:///./src/particles/color_domain.js","webpack:///./src/particles/particle_shaders.js","webpack:///./src/particles/particles.js","webpack:///./src/particles/particles_manager.js","webpack:///./src/particles/point_generators.js","webpack:///./src/app/application.js","webpack:///./src/base/animations.js","webpack:///./src/base/loading_manager.js","webpack:///./src/base/package_manager.js","webpack:///./src/base/scene_serializer.js","webpack:///./src/mixins/camera_mixin.js","webpack:///./src/mixins/threejs_mixins.js","webpack:///./src/particles/custom_affector.js","webpack:///./src/particles/custom_emitter.js","webpack:///./src/particles/forces.js","webpack:///./src/particles/test_emitters.js"],"names":["Engine","modules","installedModules","__webpack_require__","moduleId","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","getDefault","getModuleExports","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","My_Lib","Viewport","Object_Animation","animation","this","update","dt","create_text_image","width","height","text","npot","background","canvas","document","createElement","context","getContext","fillStyle","fillRect","font","fillText","texture","THREE","Texture","wrapS","wrapT","TextureWrapping","ClampToEdgeWrapping","minFilter","LinearFilter","needsUpdate","Create_Quad","vertex_shader","fragment_shader","plane","PlaneBufferGeometry","material","ShaderMaterial","vertexShader","fragmentShader","quad","Mesh","rotation","y","Math","PI","Render_Target","target","WebGLRenderTarget","magFilter","NearestFilter","format","RGBFormat","camera","PerspectiveCamera","render","scene","renderer","create_overlay_camera","OrthographicCamera","Overlay","autoClear","Mouse_Controller","root","over","click","callback","event_hub","Event_Hub","events","add_event_listener","func","obj","push","on","emit","listeners","length","t","run_function","window","setTimeout","create_run_function","app","run","loop","Euler_Controller","x","z","xspeed","yspeed","zspeed","Registered_Classes","Register_Class","console","log","Get_Class","create_class","parent","child","props","create","_","copy_object","contructor","Abstract_Fabric","data","constructor","type","parse","undefined","Print_Classes","key","Particle_Affector","__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__","id","generateUUID","affect","pdata","vert","color","toJSON","params","json","Force_Affector","forces","Array","add_force","force","apply_forces","particle","acceleration","calc","velocity","uuid","f","item","Particle_Emitter","emit_per_second","emit_delta","emit_count","lifetime","min","max","emit_life","random","calc_emitted_particles","need_emit","floor","matrix","position","set","applyMatrix4","applyMatrix4_rotation","Mouse_Camera_Controller","error","set_canvas_info","offset","getBoundingClientRect","left","top","clientWidth","clientHeight","refresh_canvas","new_canvas","get_normalized_screen_coordinates","vector","Vector3","get_normalize_mouse_position","event","clientX","clientY","unproject","r","copy","get_ray_from_camera_in_screen_coordinates","ray","Ray","sub","normalize","get_ray_from_camera_in_mouse_position","Particles_Points","geometry","Points","boundingSphere","Sphere","radius","getBoundingSphere","meta","mat","geom","Object3D","raycast","raycaster","intersects","sphere","matrixWorld","intersectsSphere","shit","tr","tmp","distance","sqrt","dot","point","main_event_hub","Mouse_Intersector","__WEBPACK_IMPORTED_MODULE_0__simple_collider_js__","__WEBPACK_IMPORTED_MODULE_1__mouse_camera_controller_js__","get_normalized_screen_coords","mouse_coords_to_vector","mouse_coords_to_ray","find_intersection_with_mouse_vector","Raycaster","intersectObjects","find_intersected_object","collider","check_ray","Simple_Collider","recursive","check_invisible","intersected_objects","_tested_sphere","prepare_check","intersected_map","_fakecaster","find_intersection_with_bounding_sphere","add_intersected","check_object_bounding_sphere","computeBoundingSphere","updateMatrixWorld","inter","non_collideble","visible","children","Color_Domain","Table_Color","g","b","Color","fill","table","copy_table","default_table","index","ceil","src","Particle_Shaders","vertex","join","fragment","Particle_System","__WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__","__WEBPACK_IMPORTED_MODULE_2__particle_affector_js__","__WEBPACK_IMPORTED_MODULE_3__particles_points_js__","__WEBPACK_IMPORTED_MODULE_4__particle_shaders_js__","__WEBPACK_IMPORTED_MODULE_5__color_domain_js__","config_params","emitter","affector","particle_lifetime","dynamic_color","count","create_particle_material","node","create_particle_geometry","bounding_radius","no_fade_color","pre_alpha","depth_test","depth_write","blending","size","discrete_emission","apply_world_matrix_on_emit","set_name","suicide","remove","create_particle_data","particle_data","vertices","Float32Array","colors","color_domain","BufferAttribute","setDynamic","BufferGeometry","buffer","addAttribute","discrete_emit","emit_particles","verts","array","old_need_emit","update_particle_geometry","dummy_color","generate_material_name","my_name","blending_mode","additive","blendSrc","OneFactor","blendDst","alpha","SrcAlphaFactor","OneMinusSrcAlphaFactor","one_alpha","alpha_one","convert_blending_mode","three_blending","factors","NoBlending","CustomBlending","set_texture","Texture_Manager","uniforms","sprite","recreate_material","create_uniforms","point_size","screen_size","Vector2","calc_defines","defines","select_texture","blend_obj","transparent","depthWrite","depthTest","set_pre_alpha","set_point_size","set_blending","set_emitter","set_particle_life_length","val","set_emission_per_second","set_particle_count","set_color","set_bounding_sphere_radius","Particle_Manager","__WEBPACK_IMPORTED_MODULE_4__particles_js__","particles","particles_array","add","ps","remove_particles","indexOf","splice","get_particle_names","names","create_by_params","arr","emitter_fabric","affector_fabric","fromJSON","JSON","e","getObjectByName","load_particles","getObjectByProperty","replace_object_with_this","create_name","number","begin_name","testing","create_new","particle_manager","Particles_Config","box_size","Point_Generators","Random_Direction","get_direction","get_inner_point","beta","cos","sin","get_normal","get_point","multiplyScalar","Application","__WEBPACK_IMPORTED_MODULE_1__base_event_hub_js__","__WEBPACK_IMPORTED_MODULE_2__base_mouse_intersector_js__","config","_lifecycle_event","_init_timer","_create_loop_function","mouse_controllers","remove_animated_object","start","_set_configuration","clock","Clock","delta_time","animated_objects","requestAnimationFrame","self","get_default_configuration","dom_element","render_params","premultipliedAlpha","viewport","clear_color","main_camera","fov","near","far","aspect_ratio","_create_render","dom_screen","alert","getElementById","WebGLRenderer","appendChild","domElement","setSize","set_viewport","setClearColor","_create_main_scene","prevent","main_scene","Scene","aspect","updateProjectionMatrix","apply_configuration","configuration","load_configuration","url","xhr","XHRLoader","configuration_is_applied","onload","progress","status","load","default_config","extend","methods","child_func","Child","apply","arguments","extend_proto","proto","delta","getDelta","do_update","add_animated_object","update_all","len","pre_update","before_update","create_mouse_move_listener","mouse_move_listener","find_mouse_over_intersections","addEventListener","add_mouse_controller","Base_Animation","Euler_Animation","Scale_Animation","__WEBPACK_IMPORTED_MODULE_0__my_lib_js__","time","time_scale","stopped","scaled_dt","calc_animation","stop","reset","param","xscale","yscale","zscale","scale","first","Loading_Manager","Chain_Loader","list","stop_by_error","next","resource","item_loaded","finished","do_error","onerror","do_progress","onprogress","load_func","test_chain_loader","cl","resources","texture_loader","TextureLoader","get_async","load_list","resource_list","on_load","on_progress","on_resource_loaded","load_list_textures","load_list_json","loader","free","Package_Manager","state","defaults","parse_package_description","pack","load_resources","loaded","textures","data_loaded","Scene_Serializer","__WEBPACK_IMPORTED_MODULE_1__particles_particles_manager_js__","animation_library","anims","collect_animations","create_animations","animations","anim","bind_animations","animdata","bindings","copy_animations","bind","anim_uuid","add_animation","load_from_json","ObjectLoader","myanimations","scene_loaded","Mixin","__WEBPACK_IMPORTED_MODULE_0__base_mouse_camera_controller_js__","get_forward_plane_by_object","setFromMatrixColumn","dist","Plane","negate","get_ray_from_screen_coordinates","mc","Mix_It","elements","Object3D_Animation_Mixin","remove_animation","old_toJson","Object3D_Serialization_Mixin","standard_serialization","stringify","userData","castShadow","receiveShadow","toArray","materials","geometries","collect_materials","collect_geometry","toJSON1","extractFromCache","cache","values","metadata","isRootObject","output","images","version","generator","collect_animations_recursive","dm_mark","source","up","quaternion","matrixAutoUpdate","matrixWorldNeedsUpdate","frustumCulled","renderOrder","Custom_Affector","__WEBPACK_IMPORTED_MODULE_1__particle_affector_js__","custom_func","dummy","test_func","set_affect_function","Function","source_code","set_affect_func","Custom_Emitter","set_emit_function","test","Particle_Forces","Force","Constant_Force","create_clone_object","Cone_Emitter","Star_Dust_Emitter","Sphere_Emitter","Star_Dust_Affector","__WEBPACK_IMPORTED_MODULE_1__point_generators_js__","__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__","__WEBPACK_IMPORTED_MODULE_3__particle_affector_js__","origin","dispersion","speed","clone_field_list_one_level_recursion","set_dispersion","set_speed","emit_color","from_center","start_position","end_position","set_velocity","set_position_range","end","get_position","get_velocity","localToWorld","__WEBPACK_IMPORTED_MODULE_0__base_event_hub_js__","__WEBPACK_IMPORTED_MODULE_1__base_my_lib_js__","__WEBPACK_IMPORTED_MODULE_2__base_animations_js__","__WEBPACK_IMPORTED_MODULE_3__base_mouse_intersector_js__","__WEBPACK_IMPORTED_MODULE_4__base_mouse_camera_controller_js__","__WEBPACK_IMPORTED_MODULE_5__base_loading_manager_js__","__WEBPACK_IMPORTED_MODULE_6__base_package_manager_js__","__WEBPACK_IMPORTED_MODULE_7__particles_particles_points_js__","__WEBPACK_IMPORTED_MODULE_8__particles_particle_emitter_js__","__WEBPACK_IMPORTED_MODULE_9__particles_forces_js__","__WEBPACK_IMPORTED_MODULE_10__particles_particle_affector_js__","__WEBPACK_IMPORTED_MODULE_11__particles_point_generators_js__","__WEBPACK_IMPORTED_MODULE_12__particles_custom_emitter_js__","__WEBPACK_IMPORTED_MODULE_13__particles_custom_affector_js__","__WEBPACK_IMPORTED_MODULE_14__particles_test_emitters_js__","__WEBPACK_IMPORTED_MODULE_15__particles_particle_shaders_js__","__WEBPACK_IMPORTED_MODULE_16__particles_particles_js__","__WEBPACK_IMPORTED_MODULE_17__particles_particles_manager_js__","__WEBPACK_IMPORTED_MODULE_18__base_scene_serializer_js__","__WEBPACK_IMPORTED_MODULE_19__mixins_threejs_mixins_js__","__WEBPACK_IMPORTED_MODULE_20__mixins_camera_mixin_js__","__WEBPACK_IMPORTED_MODULE_21__app_application_js__","__WEBPACK_IMPORTED_MODULE_22__particles_color_domain_js__","__WEBPACK_IMPORTED_MODULE_23__base_simple_collider_js__"],"mappings":"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","file":"engine.js","sourcesContent":["var Engine =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 24);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return My_Lib; });\n/*\r\n*/\r\n\r\n\r\nvar My_Lib = {};\r\n\r\nMy_Lib.Viewport = {};\r\n\r\n\r\nMy_Lib.Object_Animation = function (object, animation)\r\n{\r\n\tthis.object = object;\r\n\tthis.animation = animation;\r\n}\r\n\r\nMy_Lib.Object_Animation.prototype.update = function (dt)\r\n{\r\n\tthis.animation(this.object, dt);\r\n}\r\n\r\nMy_Lib.create_text_image = function (width, height, text, npot, background) \r\n{\r\n\t// create a canvas element\r\n\tvar canvas = document.createElement('canvas');\r\n\tcanvas.width = width;\r\n\tcanvas.height = height;\r\n\tvar context = canvas.getContext('2d');\r\n\tif (background) \r\n\t{\r\n\t\tcontext.fillStyle = background;\r\n\t\tcontext.fillRect(0, 0, canvas.width, canvas.height);\r\n\t}\r\n\tcontext.font = \"Bold 40px Arial\";\r\n\tcontext.fillStyle = \"rgba(0,255,0,0.95)\";\r\n    context.fillText('Hello, world!', 0, 50);\r\n    \r\n\t// canvas contents will be used for a texture\r\n\tvar texture = new THREE.Texture(canvas) \r\n\tif (npot) {\r\n\t\ttexture.wrapS = texture.wrapT = THREE.TextureWrapping.ClampToEdgeWrapping;\r\n\t\ttexture.minFilter = THREE.LinearFilter;\r\n\t}\r\n\ttexture.needsUpdate = true; \t\r\n\treturn texture;\r\n}\r\n\r\n\r\nMy_Lib.Create_Quad = function (width, height, vertex_shader, fragment_shader)\r\n{\r\n\t//plane created turn away from camera\r\n\tvar plane = new THREE.PlaneBufferGeometry( width, height);\r\n\t\r\n\tvar material = new THREE.ShaderMaterial( {\r\n\t\tvertexShader: vertex_shader,\r\n\t\tfragmentShader: fragment_shader\r\n\t} ); \r\n\r\n\tvar quad = new THREE.Mesh( plane, material );\r\n\tquad.rotation.y = Math.PI;\r\n\treturn quad;\r\n}\r\n\r\n\r\nMy_Lib.Render_Target = function (width, height)\r\n{\r\n\tthis.target = new THREE.WebGLRenderTarget( \r\n\twidth, \r\n\theight, \r\n\t{ \r\n\t\tminFilter: THREE.LinearFilter, \r\n\t\tmagFilter: THREE.NearestFilter, \r\n\t\tformat: THREE.RGBFormat \r\n\t} ); \r\n\t\r\n\tthis.camera = new THREE.PerspectiveCamera(80, width/height, 0.1, 1000);\r\n}\r\n\r\nMy_Lib.Render_Target.prototype.render = function (scene, renderer)\r\n{\r\n\trenderer.render( scene, \r\n\t\tthis.camera, \r\n\t\tthis.target, \r\n\t\ttrue  //forceClear\r\n\t\t);\r\n}\r\n\r\n\r\nMy_Lib.create_overlay_camera = function (width, height)\r\n{\r\n\tvar camera =  new THREE.OrthographicCamera( \r\n\t\twidth / - 2, \r\n\t\twidth / 2, \r\n\t\theight / 2, \r\n\t\theight /- 2, -10000, 10000 );\r\n\treturn camera;\r\n}\r\n\r\nMy_Lib.Overlay = function (width, height)\r\n{\r\n\tthis.camera = My_Lib.create_overlay_camera(width, height);\r\n}\r\n\r\nMy_Lib.Overlay.prototype.render = function (renderer)\r\n{\r\n\tif (!this.scene) {\r\n\t\treturn;\r\n\t}\r\n\t\r\n\trenderer.autoClear = false;\r\n\trenderer.render(this.scene, this.camera);\r\n\trenderer.autoClear = true;\r\n}\r\n\r\n\r\nMy_Lib.Mouse_Controller = function (root, over, click, callback)\r\n{\r\n\tthis.root = root;\r\n\tthis.over = over;\r\n\tthis.click = !!click;\r\n\tthis.callback = callback;\r\n}\r\n\r\n\r\n\r\n/*\r\nugly hack\r\n*/\r\n\r\nMy_Lib.event_hub = new Event_Hub();\r\n\r\nfunction Event_Hub() {\r\n    this.events = {};\r\n}\r\n\r\n\r\n\r\nEvent_Hub.prototype.add_event_listener = function (name, func, obj)\r\n{\r\n    if (!this.events[name]) {\r\n        this.events[name] = [];\r\n    }\r\n    this.events[name].push( {name: name, func: func, obj: obj} );\r\n}\r\n\r\nEvent_Hub.prototype.on  = Event_Hub.prototype.add_event_listener;\r\n\r\nEvent_Hub.prototype.emit = function(name, obj)\r\n{\r\n    var listeners = this.events[name];\r\n    if (listeners) {\r\n        for(var i = 0; i < listeners.length; i++) {\r\n            var t = listeners[i];\r\n            t.func.call(t.obj, obj);            \r\n        }\r\n    }\r\n}\r\n\r\n\r\nvar run_function = //window.requestAnimationFrame;\r\n\tfunction(callback){\r\n\t\twindow.setTimeout(callback, 1000 / 60);\r\n\t}\r\n\r\n\r\nMy_Lib.create_run_function = function (app) \r\n{\r\n    My_Lib.run = function () { run_function( function () { app.loop(); }); }\r\n}\r\n\r\n\r\n\r\n\r\nMy_Lib.Euler_Controller = function (obj, x, y, z)\r\n{\r\n\tthis.obj = obj;\r\n\tthis.xspeed = x * Math.PI / 180;;\r\n\tthis.yspeed = y * Math.PI / 180;;\r\n\tthis.zspeed = z * Math.PI / 180;;\r\n}\r\n\r\nMy_Lib.Euler_Controller.prototype.update = function (dt)\r\n{\r\n\tthis.obj.rotation.x += this.xspeed * dt;\r\n\tthis.obj.rotation.y += this.yspeed * dt;\r\n\tthis.obj.rotation.z += this.zspeed * dt;\r\n}\r\n\r\n//Class Library\r\nMy_Lib.Registered_Classes = {};\r\n\r\nMy_Lib.Register_Class = function (name, func)\r\n{\r\n\tif (My_Lib.Registered_Classes[name]){\r\n\t\tconsole.log(\"Register Class ERROR! Class with this name already exists!\", name);\r\n\t}\r\n\tMy_Lib.Registered_Classes[name] = func;\r\n}\r\n\r\nMy_Lib.Get_Class = function (name)\r\n{\r\n\treturn My_Lib.Registered_Classes[name];\r\n}\r\n\r\n\r\nMy_Lib.create_class = function(parent, child, props, name)\r\n{\r\n    if (parent) {\r\n        child.prototype = Object.create(parent.prototype);\r\n    } \r\n    _.copy_object(child.prototype, props);\r\n    child.prototype.contructor = child;                \r\n    My_Lib.Register_Class(child, name);\r\n}\r\n\r\nMy_Lib.Abstract_Fabric = function (data)\r\n{\r\n    var constructor = My_Lib.Get_Class(data.type);\r\n    if (constructor) {\r\n        var object = new constructor();\r\n        object.parse(data);\r\n        return object;\r\n    }\r\n    return undefined;\r\n}\r\n\r\nMy_Lib.Print_Classes = function ()\r\n{\r\n    for(var key in this.Registered_Classes) {\r\n        console.log(\"class registered :\", key, this.Registered_Classes[key]);\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particle_Affector; });\n/* unused harmony export Force_Affector */\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n\r\n\r\n//base class for particle affector\r\nfunction Particle_Affector()\r\n{\r\n    this.id = _.generateUUID();\r\n}\r\n\r\n\r\nParticle_Affector.prototype.affect = function (dt, pdata, vert, color)\r\n{\r\n\treturn true;\r\n}\r\n\r\nParticle_Affector.prototype.toJSON = function (child)\r\n{\r\n\tif (child) {\r\n\t\treturn {};\r\n\t}\r\n\tvar data = {\r\n        id: this.id,\r\n\t\t\"name\": \"Particle_Affector\",\r\n\t\tparams : {}\r\n\t};\r\n    if (child) {\r\n        return params;\r\n    }\r\n\treturn data;\r\n}\r\n\r\nParticle_Affector.prototype.parse = function (json)\r\n{\r\n}\r\n\r\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Particle_Affector\", Particle_Affector);\r\n\r\nfunction Force_Affector()\r\n{\r\n    Particle_Affector.call(this);\r\n\tthis.forces = new Array();\r\n}\r\n\r\nForce_Affector.prototype = Object.create(Particle_Affector.prototype);\r\n\r\n_.copy_object(Force_Affector.prototype, {\r\n\tconstructor: Force_Affector,\r\n\tadd_force: function (force)\r\n\t{\r\n\t\tthis.forces.push(force);\r\n\t},\r\n\tapply_forces: function (dt, particle, vert, color)\r\n\t{\r\n\t\tvar acceleration = {x:0, y:0, z:0};\r\n\t\tfor(var i = 0; i < this.forces.length; i++) {\r\n\t\t\tthis.forces[i].calc(dt, particle, acceleration);\r\n\t\t}\r\n\t\t//integrate\r\n\t\tparticle.velocity.x += acceleration.x * dt;\r\n\t\tparticle.velocity.y += acceleration.y * dt;\r\n\t\tparticle.velocity.z += acceleration.z * dt;\r\n\t},\r\n\taffect: function (dt, particle, vert, color)\r\n\t{\r\n\t\tthis.apply_forces(dt, particle, vert, color);\r\n\t\treturn true;\r\n\t},\r\n\ttoJSON: function (child)\r\n\t{\r\n\t\tvar data = {};\r\n\t\tdata.name = \"Force_Affector\";\t\t\r\n        data.uuid = this.uuid;\r\n\t\tdata.params = Particle_Affector.prototype.toJSON.call(this, this);\r\n\t\tif (this.forces.length > 0) {\r\n\t\t\tdata.params.forces = new Array();\r\n\t\t\tfor(var i = 0; i < this.forces.length; i++) {\r\n\t\t\t\tdata.params.forces.push( this.forces[i].toJSON() );\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn data;\r\n\t},\r\n\tparse: function (json)\r\n\t{\r\n\t\tvar f, item;\r\n\t\tif (json.forces) {\r\n\t\t\t\t\r\n\t\t\tfor(var i =0; i < json.forces.length; i++) {\r\n\t\t\t\titem = json.forces[i];\r\n\t\t\t\tf = __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Get_Class(item.name);\r\n\t\t\t\tif (f) {\r\n\t\t\t\t\tf = new f();\r\n\t\t\t\t\tf.parse(item);\r\n\t\t\t\t\tthis.add_force(f);\r\n\t\t\t\t} \r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Force_Affector\", Force_Affector);\r\n\r\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particle_Emitter; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n\r\n\r\n//Base class for Particle Emitters\r\nfunction Particle_Emitter(emit_per_second)\r\n{\r\n    this.uuid = _.generateUUID();\r\n    this.name = '';\r\n\tthis.emit_delta = 0;\r\n\tthis.emit_count = 0;\r\n\tthis.emit_per_second = emit_per_second || 5;\r\n\t//linear interpolation = min + random * (max-min)\t\r\n\tthis.lifetime = {\"min\": 0, \"max\":2.0};\r\n}\r\n\r\nParticle_Emitter.prototype.emit_life = function ()\r\n{\r\n\treturn this.lifetime.min + Math.random() * (this.lifetime.max - this.lifetime.min);\r\n}\r\n\r\nParticle_Emitter.prototype.calc_emitted_particles = function (dt)\r\n{\r\n\t//count particles need emit\r\n\tthis.emit_delta += this.emit_per_second*dt;\r\n\tvar need_emit = Math.floor(this.emit_delta);\r\n\tif (need_emit > 0) {\r\n\t\tthis.emit_delta -= need_emit;\r\n\t\t//this.emit_count += need_emit;\r\n\t\t//need_emit = this.emit_count;\r\n\t}\r\n\treturn need_emit;\r\n}\r\n\r\n\r\nParticle_Emitter.prototype.emit = function (p, c, matrix)\r\n{\r\n    p.position.set(0, 0, 0);\r\n    p.velocity.set(0, 1, 0);\r\n    \r\n    if (matrix) {\r\n        p.position.applyMatrix4(matrix);\r\n        p.velocity.applyMatrix4_rotation(matrix);\r\n    }\r\n}\r\n\r\n\r\nParticle_Emitter.prototype.toJSON = function (child)\r\n{\r\n\tvar params = {\r\n        \"uuid\": this.uuid,\r\n\t\t\"emit_per_second\": this.emit_per_second,\r\n\t\t\"lifetime\": {\r\n\t\t\t\"min\": this.lifetime.min,\r\n\t\t\t\"max\": this.lifetime.max\r\n\t\t},\r\n\t};\r\n    if (this.name) {\r\n        params.name = this.name;\r\n    }\r\n\tif (child) {\r\n\t\treturn params;\r\n\t}\r\n\tvar data = {};\r\n\tdata.name = \"Particle_Emitter\";\r\n\tdata.params = params;\t\r\n\treturn data;\r\n}\r\n\r\nParticle_Emitter.prototype.parse = function (data)\r\n{\r\n\tthis.emit_per_second = data.emit_per_second;\r\n    this.name = data.name;\r\n    this.uuid = data.uuid || _.generateUUID();\r\n\t_.copy_object(this.lifetime, data.lifetime);\r\n}\r\n\r\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Particle_Emitter\", Particle_Emitter);\r\n\r\n\r\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Mouse_Camera_Controller; });\n//Unfortunately, canvas properties can change permanenty. \r\n//Because, you need do refresh_canvas on each call!\r\n//each time you need recacl BoundingRect and clientRect of the fucking canvas\r\n//also, camera may be not that camera, who render scene. it may be other camera\r\n//because you need refresh camera on eash call\r\n//i could done this normal function, but this object may do different job\r\n//this is single-time object\r\n//it easy economyfy number of arguments on calling functions\r\n\r\n//not, this class doesn't store reference to canvas, \r\n//this store only information about canvas size and position \r\n//i.e. BoundingClientRect and clientWidth,clientHeight\r\n//yes, this class store reference to camera\r\n\r\n//probably, it may be mixin to camera\r\n\r\n\r\nfunction Mouse_Camera_Controller(canvas, camera)\r\n{\r\n    if (canvas === undefined) {\r\n        console.error(\"Mouse_Camera_Controller. Propable premordial creating object. canvas is undefined. Do nothing\");\r\n    } else {\r\n        this.set_canvas_info(canvas);\r\n    }\r\n    this.camera = camera;\r\n}\r\n\r\n_.copy_object(Mouse_Camera_Controller.prototype,{\r\n    constructor : Mouse_Camera_Controller,\r\n    set_canvas_info: function (canvas)\r\n    {\r\n        var offset = canvas.getBoundingClientRect();\r\n        this.offset = \r\n        {\r\n            left: offset.left,\r\n            top : offset.top\r\n        };\r\n        this.width = canvas.clientWidth;\r\n        this.height = canvas.clientHeight;\r\n    },\r\n    refresh_canvas: function (new_canvas)\r\n    {\r\n        this.set_canvas_info(new_canvas);\r\n    }\r\n    ,\r\n    get_normalized_screen_coordinates: function (x,y)\r\n    {\r\n        //step 1 : normalized\r\n        x = (x - this.offset.left) / this.width;\r\n        y = (y - this.offset.top) / this.height;\r\n        //step 2 : from unsigned to signed, translate origin from top left corner to center \r\n        var x = x * 2.0 - 1.0;\r\n        var y = -(y * 2.0 - 1.0);\r\n        var vector = new THREE.Vector3( x, y, 1 );\r\n        return vector;        \r\n    },\r\n    \r\n    //do some what prevent method, only give mouse event instead x,y coordiantes\r\n    get_normalize_mouse_position: function (event) \r\n    {\r\n        return this.get_normalized_screen_coordinates(event.clientX, event.clientY);\r\n    },\r\n    \r\n    //return new unproject vector, not change given\r\n    //used THREE.Vector3.unproject method\r\n    //including apply inver camera matrix\r\n    //on my view, that wrong, because method do it big then promise\r\n    //unproject must do only unproject, not else thing\r\n    //because my need new method, who will do only unproject \r\n    unproject: function(vector)\r\n    {\r\n        var r = new THREE.Vector3();\r\n        r.copy(vector);\r\n        r.unproject(this.camera);\r\n        //this aready done \r\n        //r.applyMatrix4(camera.matrixWorldInverse);    \r\n        return r;\r\n    },\r\n    \r\n    \r\n    //get ray with origin in camera position and direction, \r\n    //pointed to far away where unproject screen point are\r\n    get_ray_from_camera_in_screen_coordinates: function (x,y) \r\n    {\r\n        var vector = this.get_normalized_screen_coordinates(x,y);\r\n        vector = this.unproject(vector);\r\n        var ray = new THREE.Ray( this.camera.position, vector.sub( this.camera.position ).normalize() );\r\n        return ray;\r\n    },\r\n    \r\n    //do same what prevent method, only give mouse event for convience\r\n    //see it as overriding function in C++\r\n    get_ray_from_camera_in_mouse_position: function (event)\r\n    {\r\n        return this.get_ray_from_camera_in_screen_coordinates(event.x, event.y);\r\n    },\r\n\r\n\r\n});\r\n\r\n\r\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particles_Points; });\n    \r\nfunction Particles_Points (geometry, material)\r\n{\r\n    THREE.Points.call(this, geometry, material);\r\n    this.type = 'particles_points';\r\n    \r\n    this.boundingSphere = new THREE.Sphere();\r\n    this.boundingSphere.radius = 10.0;\r\n}\r\n\r\nParticles_Points.prototype = Object.create( THREE.Points.prototype )\r\n\r\nParticles_Points.prototype.constructor = Particles_Points;\r\n\r\nParticles_Points.prototype.getBoundingSphere = function()\r\n{\r\n    return this.boundingSphere;\r\n}\r\n\r\nParticles_Points.prototype.toJSON = function (meta)\r\n{\r\n    var mat = this.material;\r\n    var geom = this.geometry;\r\n    this.material = undefined;\r\n    this.geometry = undefined;\r\n    var object =  THREE.Object3D.prototype.toJSON.call(this, meta);\r\n    this.material = mat;\r\n    this.geometry = geom;\r\n    return object;\r\n}\r\n\r\n//WTF?\r\nParticles_Points.prototype.raycast = function (raycaster, intersects)\r\n{\r\n    var sphere = new THREE.Sphere()\r\n    sphere.copy( this.boundingSphere );\r\n    sphere.applyMatrix4( this.matrixWorld ); \r\n    var r = raycaster.ray.intersectsSphere( sphere );\r\n    if ( r === false ) return;\r\n    console.log(\"INTERSECTION1\", this.name, sphere);\r\n    return;\r\n    \r\n    var shit  = new THREE.Vector3();\r\n    shit.copy(this.position);\r\n    var tr = new THREE.Ray( new THREE.Vector3(0, 0, 20), shit);\r\n    console.log(\"test \", tr.intersectsSphere(sphere), sphere);\r\n    console.log(\"hit sphere \"  + this.name, sphere, raycaster.ray);\r\n    return raycaster.ray.intersectsSphere( sphere );\r\n    \r\n    \r\n    console.log(\"hit sphere \" + this.type, \"shpere is \", sphere, \"ray is \", r);\r\n    if (r) {\r\n            var tmp = new THREE.Vector3(this.position);\r\n            tmp.sub(r);\r\n   \t\t\tintersects.push( {\r\n\t\t\t\tdistance: Math.sqrt( tmp.dot(tmp) ),\r\n\t\t\t\tpoint: this.position,\r\n\t\t\t\tobject: this\r\n\t\t\t} ); \r\n    }\r\n}\r\n\r\n\r\n\r\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return main_event_hub; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return Event_Hub; });\nfunction Event_Hub() {\r\n    this.events = {};\r\n}\r\n\r\n\r\n\r\nEvent_Hub.prototype.add_event_listener = function (name, func, obj)\r\n{\r\n    if (!this.events[name]) {\r\n        this.events[name] = [];\r\n    }\r\n    this.events[name].push( {name: name, func: func, obj: obj} );\r\n}\r\n\r\nEvent_Hub.prototype.on  = Event_Hub.prototype.add_event_listener;\r\n\r\nEvent_Hub.prototype.emit = function(name, obj)\r\n{\r\n    var listeners = this.events[name];\r\n    if (listeners) {\r\n        for(var i = 0; i < listeners.length; i++) {\r\n            var t = listeners[i];\r\n            t.func.call(t.obj, obj);            \r\n        }\r\n    }\r\n}\r\n\r\nvar main_event_hub = new Event_Hub();\r\n\r\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Mouse_Intersector; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__simple_collider_js__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__mouse_camera_controller_js__ = __webpack_require__(3);\nvar Mouse_Intersector = {};\r\n\r\n\r\n\r\n\r\n\r\nMouse_Intersector.get_normalized_screen_coords = function (canvas, x, y)\r\n{\r\n\tvar offset = canvas.getBoundingClientRect();\r\n\tvar width = canvas.clientWidth;\r\n\tvar height = canvas.clientHeight;\r\n    //normalize coordinates\r\n    var x = (x - offset.left) / width;\r\n    var y = (y - offset.top) / height;\r\n\tvar x = x * 2 - 1;\r\n\tvar y = -(y * 2 - 1);\r\n\tvar vector = new THREE.Vector3( x, y, 1 );\r\n\treturn vector;\r\n}\r\n\r\nMouse_Intersector.mouse_coords_to_vector = function (canvas, event) \r\n{\r\n    return this.get_normalized_screen_coords(canvas, event.clientX, event.clientY);\r\n}\r\n\r\n\r\nMouse_Intersector.unproject = function(vector, camera)\r\n{\r\n    var r = new THREE.Vector3();\r\n    r.copy(vector);\r\n\tr.unproject(camera);\r\n    //this done yet\r\n    //r.applyMatrix4(camera.matrixWorldInverse);    \r\n    return r;\r\n}\r\n\r\nMouse_Intersector.mouse_coords_to_ray = function (canvas, event, camera) \r\n{\r\n    var vector = this.mouse_coords_to_vector(canvas, event);\r\n    vector = this.unproject(vector, camera);\r\n\tvar ray = new THREE.Ray( camera.position, vector.sub( camera.position ).normalize() );\r\n\treturn ray;\r\n}\r\n\r\n\r\n\r\nMouse_Intersector.find_intersection_with_mouse_vector = function(vector, camera, scene)\r\n{\r\n\tvector.unproject(camera);\r\n\tvar ray = new THREE.Raycaster( camera.position, vector.sub( camera.position ).normalize() );\r\n\t// create an array containing all objects in the scene with which the ray intersects\r\n\t//var intersects = ray.intersectObjects( [grid_text.root], true ); \r\n\t//console.log(fake_plane.root.children[0].geometry);\r\n\tvar intersects = ray.intersectObjects( [scene], true ); \r\n\treturn intersects;\r\n}\r\n\r\n\r\nMouse_Intersector.find_intersected_object = function (scene, ray)\r\n{\r\n\r\n    var collider = new __WEBPACK_IMPORTED_MODULE_0__simple_collider_js__[\"a\" /* Simple_Collider */](scene);\r\n    var intersects = collider.check_ray(ray);\r\n    return intersects;\r\n}\r\n\r\n\r\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Simple_Collider; });\nfunction Simple_Collider(root, params)\r\n{\r\n    this.root = root;\r\n    if (params === undefined) {\r\n        params = {};\r\n    }\r\n    this.params = \r\n    {\r\n        recursive: params.recursive === undefined ? true : params.recursive,\r\n        check_invisible: params.check_invisible === undefined ? true : params.check_invisible \r\n    };\r\n    this.intersected_objects = [];\r\n    this._tested_sphere = new THREE.Sphere();    \r\n}\r\n\r\nSimple_Collider.prototype.prepare_check = function (ray)\r\n{\r\n    this.intersected_objects = [];\r\n    this.intersected_map = {};\r\n    this._fakecaster = {ray: ray};    \r\n}\r\n\r\nSimple_Collider.prototype.check_ray = function (ray)\r\n{\r\n    this.prepare_check(ray);\r\n    \r\n    this.find_intersection_with_bounding_sphere( this.root); \r\n    \r\n    return this.intersected_objects;\r\n}\r\n\r\nSimple_Collider.prototype.add_intersected = function (obj)\r\n{\r\n    if (!this.intersected_map[obj.uuid]) {\r\n        this.intersected_map[obj.uuid] = obj;\r\n        this.intersected_objects.push(obj);\r\n    }\r\n}\r\n\r\nSimple_Collider.prototype.check_object_bounding_sphere = function(obj)\r\n{\r\n    //get bounding sphere\r\n    if (obj.getBoundingSphere) {\r\n        this._tested_sphere.copy( obj.getBoundingSphere() );\r\n    } else if (obj.geometry)  {\r\n        //fuck this shit, why don't exists method getBoundingSphere, which encapsulates this?\r\n        if ( obj.geometry.boundingSphere === null ) obj.geometry.computeBoundingSphere();\r\n         //copy sphere from object geometry and transform it with object. matrixWorld\r\n        this._tested_sphere.copy( obj.geometry.boundingSphere );\r\n        //console.log(\"get bounding sphere\", this._tested_sphere);\r\n    } else {\r\n        return false;\r\n    }\r\n\r\n    //test bounding spere\r\n    obj.updateMatrixWorld(true);        \r\n    this._tested_sphere.applyMatrix4( obj.matrixWorld );\r\n    //find intersection\r\n    var inter = this._fakecaster.ray.intersectsSphere( this._tested_sphere );\r\n    //console.log(\"inter with sphere, level\", level, inter, sphere.center, raycaster.ray);\r\n    //add to intersected list, if success\r\n    if (inter) {\r\n        this.intersected_objects.push(obj);\r\n        return true;\r\n    } else {\r\n        return false;\r\n    }\r\n}\r\n\r\n\r\nSimple_Collider.prototype.find_intersection_with_bounding_sphere = function(object, top ) {\r\n\r\n    if ( !object.non_collideble && (object.visible || this.params.check_invisible)) {\r\n        this.check_object_bounding_sphere(object);\r\n    }\r\n    if ( !this.params.recursive) return;\r\n    \r\n    \r\n    //test children\r\n    var children = object.children;\r\n    for ( var i = 0; i < children.length; i ++ ) {\r\n        var child = children[i];\r\n        this.find_intersection_with_bounding_sphere( child );\r\n    }\r\n}\r\n\r\n\r\n\r\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Color_Domain; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return Table_Color; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n\r\n\r\nfunction Color_Domain(r,g,b)\r\n{\r\n    this.color = new THREE.Color(r,g,b);\r\n    this.uuid = _.generateUUID();\r\n    this.name = '';\r\n    this.type = \"Color_Domain\";\r\n}\r\n\r\n_.copy_object(Color_Domain.prototype, {\r\n    toJSON: function (child)\r\n    {\r\n        var data = {};\r\n        data.uuid = this.uuid;\r\n        if (this.name !== '') {\r\n            data.name = this.name;\r\n        }\r\n        data.type = this.type;\r\n        data.color = {r: this.color.r, g: this.color.g, b: this.color.b};\r\n        return ;\r\n    },\r\n    parse: function (json)\r\n    {\r\n        this.uuid = json.uuid;\r\n        if (json.name !== undefined) {\r\n            this.name = json.name;\r\n        }\r\n        if (json.color !== undefined) {\r\n            this.color.set(json.color.r, json.color.g, json.color.b);\r\n        }\r\n    },\r\n    emit: function (color)\r\n    {\r\n        color.r = this.color.r;\r\n        color.g = this.color.g;\r\n        color.b = this.color.b;\r\n    },\r\n    fill: function (color, offset) \r\n    {\r\n        color[offset+0] = this.color.r;\r\n        color[offset+1] = this.color.g;\r\n        color[offset+2] = this.color.b;\r\n    }\r\n});\r\n\r\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class('Color_Domain', Color_Domain);\r\n\r\nfunction Table_Color(table)\r\n{\r\n    if (table !== undefined) {\r\n        this.copy_table(table);        \r\n    } else {\r\n        this.default_table();\r\n    }\r\n}\r\n\r\nTable_Color.prototype = Object.create(Color_Domain);\r\n\r\n_.copy_object(Table_Color.prototype, {\r\n    constructor: Table_Color,\r\n    copy_table: function (table)\r\n    {\r\n        this.table = new Array(table.length);\r\n        for(var i = 0; i < table.length; i++) {\r\n            this.table = new THREE.Color(table[i]);\r\n        }\r\n    },\r\n    emit: function (color)\r\n    {\r\n        var index = Math.ceil(Math.random() * this.table.length) % this.table.length;\r\n        var src = this.table[index];\r\n        color.r = src.r;\r\n        color.g = src.g;\r\n        color.b = src.b;\r\n    },\r\n    fill: function (color, offset) \r\n    {\r\n        var index = Math.ceil(Math.random() * this.table.length) % this.table.length;\r\n        var src = this.table[index];\r\n        color[offset] = src.r;\r\n        color[offset+1] = src.g;\r\n        color[offset+2] = src.b;\r\n    },\r\n    default_table: function ()\r\n    {\r\n        this.table = new Array(8);\r\n        this.table[0] = new THREE.Color(1, 0, 0);\r\n        this.table[1] = new THREE.Color(0, 1, 0);\r\n        this.table[2] = new THREE.Color(0, 0, 1);\r\n        this.table[3] = new THREE.Color(1, 0, 1);\r\n        this.table[4] = new THREE.Color(1, 1, 0);\r\n        this.table[5] = new THREE.Color(1, 0.4, 0.4);\r\n        this.table[6] = new THREE.Color(0.5, 0.7, 0.98);\r\n        this.table[7] = new THREE.Color(0.9, 0.4, 0.4);\r\n    },\r\n    get: function ()\r\n    {\r\n        var r = {r: 0, g: 0, b: 0};\r\n        this.emit(r);\r\n        return r;\r\n    }\r\n});\r\n\r\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Table_Color\", Table_Color);\r\n\r\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particle_Shaders; });\nvar Particle_Shaders = {};\r\n\r\n(function () \r\n{\r\n\r\n//particle attributes:\r\n//position\r\n//color\r\n//left, size\r\nvar vertex_shader = [\r\n//'attribute vec4 position;',\r\n'attribute vec4 color;',\r\n'attribute float params;',\r\n'varying vec4 vcolor;',\r\n'uniform float lifetime;',\r\n'uniform float point_size;',\r\n'uniform vec2 screen_size;',\r\n'#ifndef DYNAMIC_COLORS',\r\n    'uniform vec3 particle_color;',\r\n'#endif',\r\n'void main () {',\r\n\t'gl_Position = projectionMatrix * viewMatrix * vec4( position, 1.0 );',\r\n'#ifdef DYNAMIC_COLORS',\r\n\t'vcolor.rgb = color.rgb;',\r\n'#else',\r\n    'vcolor.rgb = particle_color.rgb;',\r\n'#endif',\r\n'#ifdef NO_FADE_COLOR',\r\n\t'vcolor.a = 1.0;',\r\n'#else',\r\n\t//params contains life length which decreased by time\r\n\t'float tmp = params / lifetime;',\r\n\t'tmp = min(tmp, 1.0);',\t\r\n\t'vcolor.a = tmp;',\r\n'#endif',\r\n\t'float t =  screen_size.y* projectionMatrix[1][1] / gl_Position.w;',\r\n\t't = t * point_size;',\r\n\t'if (params > 0.0) {',\r\n\t\t'gl_PointSize = t;',\r\n\t'}',\r\n\t'else {',\r\n\t\t//'vcolor.a = 0.0;',\r\n\t\t'gl_PointSize = 0.0;',\r\n        'gl_Position.z = -1000.0;',\r\n\t'}',\r\n'}'\r\n];\r\n\r\nvar fragment_shader = [\r\n\t'varying vec4 vcolor;',\r\n\t'#ifdef PARTICLE_TEXTURE',\r\n\t\t'uniform sampler2D sprite;',\r\n\t'#endif',\r\n\t'void main() {',\r\n\t'#ifdef PARTICLE_TEXTURE',\r\n\t\t'vec4 tex = texture2D( sprite, gl_PointCoord );',\r\n\t\t'vec3 fragment_color = tex.rgb;',\r\n\t\t'fragment_color.rgb *= vcolor.rgb;',\r\n\t\t'float alpha = tex.a;',\t\r\n\t'#else',\r\n\t\t'vec3 fragment_color = vcolor.rgb;',\r\n\t\t'float alpha = 1.0;',\r\n\t'#endif',\r\n\t'#ifdef PRE_ALPHA',\r\n\t\t'fragment_color.rgb *= alpha;',\r\n\t'#endif',\r\n\t'#ifndef NO_FADE_COLOR',\r\n\t\t'float fragment_alpha = alpha * vcolor.a;',\r\n\t'#else',\r\n\t\t'float fragment_alpha = alpha;',\r\n\t'#endif',\r\n\t\t'gl_FragColor = vec4(fragment_color.rgb, fragment_alpha);',\r\n\t'}',\r\n];\r\n\r\nParticle_Shaders.vertex = vertex_shader.join( '\\n' );\r\nParticle_Shaders.fragment = fragment_shader.join( '\\n' );\r\n})();\r\n\r\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particle_System; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__particle_affector_js__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__particles_points_js__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__particle_shaders_js__ = __webpack_require__(9);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__color_domain_js__ = __webpack_require__(8);\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction Particle_System(data)\r\n{\r\n    this.uuid = _.generateUUID();    \r\n    \r\n    this.params = this.config_params(data);\r\n\r\n  \r\n\tthis.emitter = this.params.emitter;\r\n\tthis.affector = this.params.affector;    \r\n    this.particle_lifetime = this.params.particle_lifetime;\r\n    this.texture = this.params.texture;\r\n\t\r\n\tthis.dynamic_color = false;\r\n\r\n\tvar count = this.params.count;\r\n\t\r\n\tthis.material = this.create_particle_material();\r\n\tthis.node = new __WEBPACK_IMPORTED_MODULE_3__particles_points_js__[\"a\" /* Particles_Points */](this.create_particle_geometry(count), this.material);\r\n    this.node.name = this.name;\r\n    this.node.boundingSphere.radius = this.params.bounding_radius;\r\n    this.node.non_collideble = this.params.non_collideble;\r\n    \r\n}\r\n\r\n\r\nParticle_System.prototype.config_params = function (data)\r\n{\r\n    var params = \r\n    {\r\n    };\r\n    //default\r\n    params.particle_lifetime = 3.0;\r\n    params.no_fade_color = false;\r\n    params.pre_alpha = true;\r\n    params.depth_test = true;\r\n    params.depth_write = false;\r\n    params.color  = {\"r\":1, \"g\":1, \"b\":1};\r\n\tparams.blending = \"one_alpha\";\r\n    params.size = 1;\r\n    params.count = 100;\r\n    params.name = '';\r\n    params.bounding_radius = 2.0;\r\n    params.discrete_emission = false;\r\n    params.apply_world_matrix_on_emit = true;\r\n    params.non_collideble = false;\r\n    \r\n    for(var key in data) {\r\n        if (Object.prototype.hasOwnProperty.call(data, key)){\r\n            if (data[key] !== undefined) {\r\n                params[key] = data[key];\r\n            }\r\n        }\r\n    }\r\n    \r\n\tparams.emitter = data.emitter || new __WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__[\"a\" /* Particle_Emitter */](1);\r\n\tparams.affector = data.affector || new __WEBPACK_IMPORTED_MODULE_2__particle_affector_js__[\"a\" /* Particle_Affector */]();\r\n    \r\n    return params;\r\n}\r\n\r\nParticle_System.prototype.set_name = function (name)\r\n{\r\n    this.name = name;\r\n    this.node.name = name;\r\n}\r\n\r\nParticle_System.prototype.suicide = function ()\r\n{\r\n\tthis.node.parent.remove(this.node);\r\n    main_event_hub.emit(\"kill_me\", this);\r\n}\r\n\r\n\r\nParticle_System.prototype.create_particle_data = function (count)\r\n{\r\n    var particle_data = new Array(count);\r\n    var p;\r\n    //var matrix = this.node.worldMatrix();\r\n    for(var i =0;i < count; i++) {\r\n\t\tp = {};\r\n\t\tp.position = new THREE.Vector3(0,0,0);\r\n\t\tp.velocity = new THREE.Vector3(0,0,0);\r\n        \r\n        //p.position.copy(this.node.position);\r\n        //p.position.applyMatrix4(matrix);\r\n        //p.velocity.applyMatrix4_rotation(matrix);\r\n        \r\n\t\tp.lifetime = 0;        \r\n\t\tparticle_data[i] = p;\r\n    }\r\n    this.particle_data = particle_data;\r\n}\r\n\r\nParticle_System.prototype.create_particle_geometry = function(count)\r\n{\r\n    this.create_particle_data(count);\r\n    \r\n\tvar vertices = new Float32Array(count * 3); // position\r\n\tvar colors = new Float32Array(count * 3);\r\n\tvar params = new Float32Array(count);\r\n\t\r\n    var particle;\r\n    for (var i = 0; i < count; i++) {\r\n        particle = this.particle_data[i];\r\n\t\t//create particle\r\n\t\tvertices[i*3] = particle.position.x;\r\n\t\tvertices[i*3+1] = particle.position.y;\r\n\t\tvertices[i*3+2] = particle.position.z;\r\n\r\n\t\tparams[i] = 0.0;\r\n        \r\n        if (this.params.color_domain) {\r\n            this.params.color_domain.fill(colors, i*3);\r\n        } else {\r\n            colors[i*3] = this.params.color.r;\r\n            colors[i*3+1] = this.params.color.g;\r\n            colors[i*3+2] = this.params.color.b;\r\n       }\r\n\t}\r\n\r\n\tthis.geometry = {};\r\n\tthis.geometry.vertices = new THREE.BufferAttribute(vertices, 3).setDynamic(true);\r\n\tthis.geometry.colors = new THREE.BufferAttribute(colors, 3)\r\n\tif (this.dynamic_color) {\r\n\t\tthis.geometry.colors.setDynamic(true);\r\n\t}\r\n\tthis.geometry.params = new THREE.BufferAttribute(params, 1).setDynamic(true);\r\n\tvar geom = new THREE.BufferGeometry(); \t\r\n\tthis.geometry.buffer = geom;\t\r\n\tgeom.addAttribute('position', this.geometry.vertices);\r\n\tgeom.addAttribute('color', this.geometry.colors);\r\n\tgeom.addAttribute('params', this.geometry.params);\t\r\n\r\n    return geom;\r\n}\r\n\r\n\r\nParticle_System.prototype.discrete_emit = function (count)\r\n{\r\n    this.emit_particles(0, count);\r\n\tthis.geometry.vertices.needsUpdate = true;\r\n\tthis.geometry.params.needsUpdate = true;\r\n\tthis.geometry.colors.needsUpdate = true;\r\n}\r\n\r\n\r\nParticle_System.prototype.emit_particles = function (dt, need_emit)\r\n{\r\n\t//emit particles\r\n\tvar p;\r\n\tvar verts = this.geometry.vertices.array;\r\n\tvar params = this.geometry.params.array;\r\n\t\r\n    var old_need_emit = need_emit;\r\n    this.node.updateMatrixWorld(true);\r\n    var matrix = this.node.matrixWorld;\r\n\tfor(var i =0; i < this.particle_data.length && need_emit > 0; i++) {\r\n\t\tif (!(params[i] > 0)) {\r\n        \r\n\t\t\tp = this.particle_data[i];\r\n\t\t\tthis.emitter.emit(p, null, matrix);\r\n\t\t\tp.lifetime = this.particle_lifetime;\r\n            \r\n\t\t\tverts[i*3] = p.position.x;\r\n\t\t\tverts[i*3+1] = p.position.y;\r\n\t\t\tverts[i*3+2] = p.position.z;\r\n\t\t\tparams[i] = p.lifetime;\r\n\t\t\tneed_emit--;\r\n\t\t\t//colors[i*3] = this.params.color.r\r\n\t\t\t//colors[i*3+1] = this.params.color.g;\r\n\t\t\t//colors[i*3+2] = this.params.color.b;\r\n\t\t}\r\n\t}\r\n    //console.log(\"created new particles \", old_need_emit - need_emit);\r\n}\r\n\r\nParticle_System.prototype.update_particle_geometry = function (dt)\r\n{\r\n\tvar verts = this.geometry.vertices.array;\r\n\tvar params = this.geometry.params.array;\r\n\tvar p;\r\n\tvar vert = new THREE.Vector3(0,0,0);\r\n\tvar dummy_color = {\"r\":1, \"b\":1, \"g\":1};\r\n\tfor(var i = 0; i < this.particle_data.length; i++) {\r\n\t\r\n\t\tif (params[i] > 0) {\r\n\t\t\tp = this.particle_data[i];\r\n\t\t\t\r\n\t\t\t//integrate\r\n\t\t\tp.position.x += p.velocity.x * dt;\r\n\t\t\tp.position.y += p.velocity.y * dt;\r\n\t\t\tp.position.z += p.velocity.z * dt;\r\n\t\t\tp.lifetime -= dt;\r\n\t\t\t\r\n\t\t\tif (p.lifetime <= 0 || !this.affector.affect(dt, p, vert, dummy_color)) {\r\n\t\t\t\tp.lifetime = 0;\r\n\t\t\t}\r\n\t\t\tparams[i] = p.lifetime;\t\t\t\r\n\t\t\tverts[i*3] = p.position.x;\r\n\t\t\tverts[i*3+1] = p.position.y;\r\n\t\t\tverts[i*3+2] = p.position.z;\r\n\t\t}\r\n\t}\r\n\r\n    if (!this.params.discrete_emission) {\r\n        var need_emit = this.emitter.calc_emitted_particles(dt);\r\n        this.emit_particles(dt, need_emit);\r\n    }\r\n\t\r\n\tthis.geometry.vertices.needsUpdate = true;\r\n\tthis.geometry.params.needsUpdate = true;\r\n\tthis.geometry.colors.needsUpdate = true;\r\n}\r\n\r\n\r\n\r\n\r\nParticle_System.prototype.update = function (dt)\r\n{\r\n\tthis.update_particle_geometry(dt);\r\n}\r\n\r\n\r\nParticle_System.prototype.generate_material_name = function ()\r\n{\r\n\tvar my_name = \"MY_PARTICLE_MATERIAL\";\r\n\tif (!!this.texture) {\r\n\t\tmy_name +=  \"_WITH_TEXTURE\";\r\n\t}\r\n\tif (this.params.no_fade_color) {\r\n\t\tmy_name += \"_NO_FADE_COLOR\";\r\n\t}\r\n\treturn my_name;\r\n}\r\n\r\nParticle_System.prototype.blending_mode = \r\n{\r\n\t\"additive\": {\r\n\t\t\"blendSrc\": THREE.OneFactor,\r\n\t\t\"blendDst\": THREE.OneFactor\r\n\t},\r\n\t\"alpha\": {\r\n\t\t\"blendSrc\": THREE.SrcAlphaFactor,\r\n\t\t\"blendDst\": THREE.OneMinusSrcAlphaFactor\r\n\t},\r\n\t\"one_alpha\": {\r\n\t\t\"blendSrc\": THREE.OneFactor,\r\n\t\t\"blendDst\": THREE.OneMinusSrcAlphaFactor\r\n\t},\r\n\t\"alpha_one\": {\r\n\t\t\"blendSrc\": THREE.SrcAlphaFactor,\r\n\t\t\"blendDst\": THREE.OneFactor\r\n\t}\r\n};\r\n\r\nParticle_System.prototype.convert_blending_mode = function (blending)\r\n{\r\n    var three_blending;\r\n\tvar factors = this.blending_mode[\"one_alpha\"];\r\n    if (blending === 'no') {\r\n        three_blending = THREE.NoBlending;\r\n    } else {\r\n        three_blending = THREE.CustomBlending;    \r\n        if (this.blending_mode[blending]) {\r\n            factors = this.blending_mode[blending];\r\n        }\r\n    }\r\n    return {\"blending\": three_blending, \"factors\":factors};\r\n}\r\n\r\nParticle_System.prototype.set_texture = function (texture)\r\n{\r\n\tif (typeof texture === 'string') {\r\n        if (this.params.texture === texture) {\r\n            return;\r\n        }\r\n        this.params.texture = texture;\r\n\t\tthis.texture = __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Texture_Manager.get(texture);\r\n\t} else {\r\n        console.error(\"Oh Shit! texture in set_texture is not string! it's object or undefined!\", texture);\r\n    }\r\n\r\n    if (this.material.uniforms.sprite) {\r\n        this.material.uniforms.sprite.value = this.texture;\r\n    } else {\r\n        //this.material.uniforms.sprite = {value: texture};\r\n        this.recreate_material();\r\n        console.error(\"Oh Shit! Our shader has not texture! Need create shader with texture!\");\r\n    }\r\n}\r\n\r\n\r\nParticle_System.prototype.create_uniforms = function ()\r\n{\r\n    var uniforms = \r\n    {\r\n        \"lifetime\": {\r\n            value: this.particle_lifetime\r\n        },\r\n        \"point_size\": {\r\n            value: this.params.size\r\n        },\r\n        \"screen_size\": {\r\n            value: new THREE.Vector2(__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Viewport.width, __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Viewport.height)\r\n        }\r\n    };\r\n    if (!!this.texture) {\r\n        uniforms[\"sprite\"] = {\r\n            value: this.texture\r\n        }\r\n    };\r\n    if (!this.dynamic_color) {\r\n        uniforms[\"particle_color\"] = {value: this.params.color};\r\n    }\r\n    return uniforms;\r\n}\r\n\r\nParticle_System.prototype.calc_defines = function ()\r\n{\r\n    var defines = {};\r\n    if (this.params.pre_alpha) {\r\n        defines[\"PRE_ALPHA\"] = true;\r\n    }\r\n\tif (!!this.texture) {\r\n        defines[\"PARTICLE_TEXTURE\"] = true;\r\n    }\r\n    if (this.params.no_fade_color) {\r\n        defines[\"NO_FADE_COLOR\"] = true;\r\n    }\r\n    if (this.params.color_domain) {\r\n        defines[\"DYNAMIC_COLORS\"] = true;\r\n    }\r\n    return defines;\r\n}\r\n\r\n\r\nParticle_System.prototype.select_texture = function (texture)\r\n{\r\n\tif (typeof this.texture === 'string') {\r\n\t\tthis.texture = __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Texture_Manager.get(this.texture);\r\n        if (!this.texture) {\r\n            console.error(\"Oh, not found texture <\" + this.params.texture + \"> in create particle material! Instead get \"+this.texture);\r\n        }\r\n\t}\r\n}\r\n\r\nParticle_System.prototype.create_particle_material = function()\r\n{\r\n\t\r\n    this.select_texture(this.texture);\r\n    \r\n    var blend_obj = this.convert_blending_mode(this.params.blending);\r\n    \r\n    \r\n    var uniforms = this.create_uniforms();\r\n    var defines = this.calc_defines();\r\n    \r\n\tvar mat = new THREE.ShaderMaterial({\r\n\t\ttransparent: true,\r\n\t\tdepthWrite: this.params.depth_write,\r\n\t\tdepthTest: this.params.depth_test,\r\n        blending: blend_obj.blending,\r\n        blendSrc: blend_obj.factors.blendSrc,\r\n        blendDst: blend_obj.factors.blendDst,\r\n\t\tdefines: defines,\r\n\t\tuniforms: uniforms,\r\n\t\tvertexShader: __WEBPACK_IMPORTED_MODULE_4__particle_shaders_js__[\"a\" /* Particle_Shaders */].vertex,\r\n\t\tfragmentShader: __WEBPACK_IMPORTED_MODULE_4__particle_shaders_js__[\"a\" /* Particle_Shaders */].fragment\r\n\t});\r\n\treturn mat;\r\n}\r\n\r\nParticle_System.prototype.recreate_material = function ()\r\n{\r\n    this.node.material = this.material = this.create_particle_material();\r\n}\r\n\r\n\r\nParticle_System.prototype.set_pre_alpha = function (pre_alpha)\r\n{\r\n    if (this.params.pre_alpha !== !!pre_alpha) {\r\n        this.params.pre_alpha = pre_alpha;\r\n        this.recreate_material();\r\n    }\r\n}\r\n\r\nParticle_System.prototype.set_point_size = function (size)\r\n{\r\n    if (this.params.size != size) {\r\n        this.params.size = size;\r\n        this.node.material.uniforms[\"point_size\"].value = size;\r\n    }\r\n}\r\n\r\nParticle_System.prototype.set_blending = function (blending)\r\n{\r\n    this.params.blending = blending;\r\n    var b = this.convert_blending_mode(blending);\r\n    this.material.blending = b.blending;\r\n    this.material.blendSrc = b.factors.blendSrc;\r\n    this.material.blendDst = b.factors.blendDst;\r\n}\r\n\r\n\r\n\r\n\r\nParticle_System.prototype.toJSON = function ()\r\n{\r\n\tvar data = {};\r\n    data.uuid = this.uuid;\r\n    data.node = this.node.uuid;\r\n    if (this.name || this.node.name) {\r\n        data.name = this.name || this.node.name;\r\n    }\r\n\tdata.params = {};\r\n\tif (this.params) {\r\n\t\t_.copy_object(data.params, this.params);\r\n\t}\r\n\tdata.params.emitter = this.emitter.toJSON();\r\n\tdata.params.affector = this.affector.toJSON();\r\n\treturn data;\r\n}\r\n\r\n\r\nParticle_System.prototype.set_emitter = function (emitter)\r\n{\r\n    this.emitter = this.params.emitter = emitter;\r\n}\r\n\r\nParticle_System.prototype.set_particle_life_length = function (val)\r\n{\r\n\tif (val !== this.params.particle_lifetime) {\r\n\t\tthis.params.particle_lifetime = this.particle_lifetime = val;\r\n\t\tthis.material.uniforms['lifetime'].value = val;\r\n\t}\r\n}\r\n\r\nParticle_System.prototype.set_emission_per_second = function (val)\r\n{\r\n\tthis.emitter.emit_per_second = val;\r\n}\r\n\r\nParticle_System.prototype.set_particle_count = function (count)\r\n{\r\n\tif (count !== this.particle_data.length) {\r\n\t\tthis.params.count = count;\r\n\t\tthis.node.geometry = this.create_particle_geometry(count);\r\n\t}\r\n}\r\n\r\nParticle_System.prototype.set_color = function (color)\r\n{\r\n    this.params.color.r = color.r;\r\n    this.params.color.g = color.g;\r\n    this.params.color.b = color.b;\r\n}\r\n\r\nParticle_System.prototype.set_bounding_sphere_radius = function (radius)\r\n{\r\n    this.node.boundingSphere.radius = radius;\r\n}\r\n\r\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particle_Manager; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__particle_affector_js__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__particles_points_js__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__particles_js__ = __webpack_require__(10);\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n function Particle_Manager ()\r\n{\r\n\tthis.particles = {};\r\n    this.particles_array = [];\r\n}\r\n\r\n_.copy_object(Particle_Manager.prototype, \r\n    {\r\n    constructor: Particle_Manager,\r\n    add:  function (ps,name)\r\n    {\r\n        if (!this.particles[name]) {\r\n            this.particles[name] = ps;\r\n            this.particles_array.push(ps);\r\n        }\r\n    },\r\n    remove_particles:  function (name)\r\n    {\r\n        var ps = this.particles[name];\r\n        var i = this.particles_array.indexOf(ps);\r\n        if (i >= 0) {\r\n            this.particles_array.splice(i, 1);\r\n        }\r\n        if (ps) {\r\n            ps.suicide();\r\n            delete this.particles[name];\r\n        }\r\n    },\r\n    get_particle_names:  function ()\r\n    {\r\n        var names = [];\r\n        for(var key in this.particles) {\r\n            names.push(key);\r\n        }\r\n        return names;\r\n    },\r\n\r\n    update : function (dt)\r\n    {\r\n        for(var i = 0; i < this.particles_array.length; i++) {\r\n            this.particles_array[i].update(dt);\r\n        }\r\n    },\r\n    \r\n    create_by_params: function (params)\r\n    {\r\n        var ps = new __WEBPACK_IMPORTED_MODULE_4__particles_js__[\"a\" /* Particle_System */](params);\r\n        this.add(ps);\r\n        return ps;\r\n    },\r\n\r\n\r\n    toJSON : function ()\r\n    {\r\n        var arr = []\r\n        \r\n        var data;\r\n        var p;\r\n        for(var key in this.particles){\r\n            p = this.particles[key];\r\n            if (p.uuid) {\r\n                data = p.toJSON();\r\n                arr.push(data);\r\n            }\r\n        }\r\n\r\n        return arr;\r\n    },\r\n\r\n    emitter_fabric:  function (params)\r\n    {\r\n        if (params.emitter) {\r\n            var emitter = __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Get_Class(params.emitter.name);\r\n            if (emitter) {\r\n                emitter = new emitter();\r\n            } else {\r\n                emitter = new __WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__[\"a\" /* Particle_Emitter */]();\r\n            }\r\n            emitter.parse(params.emitter.params);\r\n            return emitter;        \r\n        } \r\n        return undefined;\r\n    },\r\n\r\n    affector_fabric:  function (params)\r\n    {\r\n        if (params.affector) {\r\n            var affector = __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Get_Class(params.affector.name);\r\n            if (affector) {\r\n                affector = new affector();\r\n            } else {\r\n                affector = new __WEBPACK_IMPORTED_MODULE_2__particle_affector_js__[\"a\" /* Particle_Affector */]();\r\n            }\r\n            affector.parse(params.affector.params);\r\n            return affector;\r\n        }\r\n        return undefined;\r\n    },\r\n\r\n    fromJSON: function (json, callback, root, name)\r\n    {\r\n        if (this.particles[name]) {\r\n            console.log(\"WARNING Particle Manager! Particle System with this name already exists\", name);\r\n        }\r\n        \r\n        try\r\n        {\r\n            var data = JSON.parse(json);\r\n        }\r\n        catch (e)\r\n        {\r\n            console.log(\"error parsing json on \", name, json);\r\n            throw e;\r\n        }\r\n        \r\n        return this.parse(data, root, name);\r\n    },\r\n\r\n\r\n    parse: function (data, root, name)\r\n    {\r\n        var emitter = this.emitter_fabric(data.params);\r\n        var affector = this.affector_fabric(data.params);\r\n        data.params.emitter = emitter;\r\n        data.params.affector = affector;\r\n        \r\n        var ps = new __WEBPACK_IMPORTED_MODULE_4__particles_js__[\"a\" /* Particle_System */](data.params);\r\n        ps.set_name(data.name);\r\n\r\n            //add to scene graph\r\n        if (data.params.parent) {\r\n            var parent = root.getObjectByName(data.params.parent);\r\n            //console.log(data.params.parent, \"parent particles\", name, root);\r\n            parent.add(ps.node);\r\n        } else {\r\n           root.add(ps.node);\r\n        }\r\n\r\n        //ugly fucking hack\r\n        //copy node properties\r\n        this.add(ps, name);    \r\n        return ps;\r\n    },\r\n\r\n    load_particles:  function (json, root)\r\n    {\r\n        var particles = json.particles;\r\n        for(var i =0; i < particles.length; i++)\r\n        {\r\n            var p = particles[i];\r\n            var ps = this.parse(p, root, p.name);\r\n            ps.node.uuid = p.node;\r\n            ps.node.name = p.name;\r\n            var obj = root.getObjectByProperty(\"uuid\", p.node);\r\n            if (obj) {\r\n                ps.node.replace_object_with_this(obj);\r\n            }\r\n        }\r\n    },\r\n\r\n    create_name:  function ()\r\n    {\r\n        var number = this.particles_array.length + 1;\r\n        var begin_name = 'Particle_System_';\r\n        var testing = true;\r\n        while (testing) {\r\n            name = begin_name + number;\r\n            if (this.particles[name] !== undefined) {\r\n                number ++;\r\n            } else {\r\n                return name;\r\n            }\r\n        }\r\n    },\r\n\r\n    create_new : function ()\r\n    {\r\n        var name = this.create_name();\r\n        \r\n        var params = {};\r\n        var ps = new __WEBPACK_IMPORTED_MODULE_4__particles_js__[\"a\" /* Particle_System */](params);\r\n        ps.set_name(name);\r\n        this.add(ps, name);\r\n        return ps;\r\n    }\r\n});\r\n\r\n\r\nif (__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].particle_manager === undefined) \r\n{\r\n    __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].particle_manager = new Particle_Manager();\r\n}\r\n\r\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Particles_Config = {\r\n\"box_size\": 10\r\n};\r\n\r\n\r\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Point_Generators; });\nvar Point_Generators = {};\r\n\r\n\r\nPoint_Generators.Random_Direction = function ()\r\n{\r\n}\r\n\r\nPoint_Generators.Random_Direction.prototype.get_direction = function (vector)\r\n{\r\n\tvector.x = Math.random(); \r\n\tvector.y = Math.random(); \r\n\tvector.z = Math.random();\r\n}\r\n\r\nPoint_Generators.Sphere = function (radius)\r\n{\r\n\tthis.radius = radius;\r\n}\r\n\r\nPoint_Generators.Sphere.prototype.get_inner_point = function (vector)\r\n{\r\n\tvar alpha = Math.random() * Math.PI * 2;\r\n\tvar beta = Math.random() * Math.PI;\r\n\tvector.x = Math.cos(alpha) * Math.sin(beta);\r\n\tvector.y = Math.cos(beta);\r\n\tvector.z = Math.sin(alpha) * Math.sin(beta);\r\n}\r\n\r\nPoint_Generators.Sphere.prototype.get_normal = function (vector)\r\n{\r\n\tvector.x = Math.random() * 2 - 1;\r\n\tvector.y = Math.random() * 2 - 1;\r\n\tvector.z = Math.random() * 2 - 1;\r\n\tvector.normalize();\r\n}\r\n\r\nPoint_Generators.Sphere.prototype.get_point = function (vector) \r\n{\r\n\tthis.get_normal(vector);\r\n\tvector.multiplyScalar(this.radius);\r\n}\r\n\r\n\r\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Application; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__base_event_hub_js__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__base_mouse_intersector_js__ = __webpack_require__(6);\n/*\r\nmain class\r\nthis has abstract virtual methods\r\nstart - which create renderer and conduct start initializations\r\nupdate - updated scene objects, animations, phisics\r\nrender - control scene rendering\r\nthis methods must rewrite on derived classes\r\nneed set \r\nPROPERTIES\r\nmain_camera - camera which point of view render whole scene and user interacts\r\ndom_screen - dom element which contain canvas and display scene\r\nrenderer - three.js renderer\r\ncanvas - is created by three.js renderer, it have to append to dom_screen children, fuck it\r\ncanvas width and height defining on creating it by renderer, fuck it\r\n\r\n\r\n\r\n*/\r\n\r\n\r\n\r\n\r\n\r\n\r\nfunction Application (config)\r\n{\r\n\r\n    this._lifecycle_event(\"before_created\");\r\n   \r\n    this._init_timer();\r\n    this._create_loop_function();\r\n    \r\n\tthis.mouse_controllers = [];\r\n    \r\n    __WEBPACK_IMPORTED_MODULE_1__base_event_hub_js__[\"a\" /* main_event_hub */].add_event_listener(\"kill_me\", function (obj) {\r\n        this.remove_animated_object(obj);\r\n    }, this);\r\n}\r\n\r\nApplication.prototype.start = function (config)\r\n{\r\n    console.log(\"start application...\");\r\n   this._set_configuration(config);\r\n}\r\n\r\nApplication.prototype._lifecycle_event = function (name, event)\r\n{\r\n    if (this[name]) {\r\n        return this[name](event);\r\n    }\r\n    return false;\r\n}\r\n\r\n\r\nApplication.prototype._init_timer = function ()\r\n{\r\n\tthis.clock = new THREE.Clock();\t\r\n\tthis.delta_time = 0;\r\n\tthis.animated_objects = [];\r\n}\r\n\r\n\r\nvar run_function = window.requestAnimationFrame ||\r\n\tfunction(callback){\r\n\t\twindow.setTimeout(callback, 1000 / 60);\r\n\t}\r\n\t\r\n\r\n\r\nApplication.prototype._create_loop_function = function ()\r\n{\r\n    var self = this;\r\n\tthis.run = function ()\r\n\t{\r\n\t\trun_function(function () \r\n\t\t{ \r\n\t\t\tself.loop();\r\n            //main_event_hub.emit(\"new_frame\");\r\n\t\t});\r\n\t}\r\n\t\r\n    //My_Lib.create_run_function(this);\r\n    \r\n    //main_even_hub.add_event_listener(\"new_frame\", this.loop, this);    \r\n}\r\n\r\n\r\nApplication.prototype.get_default_configuration = function ()\r\n{\r\n    return {\r\n        \"dom_element\": \"screen\",\r\n        \"render_params\": {\r\n            \"premultipliedAlpha\": true,\r\n            \"alpha\": true\r\n        },\r\n        \"viewport\": {\r\n            \"width\": 800,\r\n            \"height\": 600\r\n         },\r\n         \"clear_color\": 0x0000FF,\r\n        \"main_camera\": {\r\n            \"fov\": 80,\r\n            \"near\": 0.1,\r\n            \"far\": 1000,\r\n            \"aspect_ratio\": 1.3333333333333333,\r\n            \"position\": {\r\n                \"x\": 0,\r\n                \"y\": 0,\r\n                \"z\": 0\r\n            }\r\n        }\r\n    };\r\n}\r\n\r\nApplication.prototype._create_render = function (json)\r\n{\r\n    if (this.dom_screen || this.renderer) {\r\n        alert(\"Create render alert! Something strange happenes!\");\r\n    }\r\n    if (!this.dom_screen) {\r\n        this.dom_screen = document.getElementById(json.dom_element);\r\n    }\r\n    if (!this.renderer) {\r\n        this.renderer = new THREE.WebGLRenderer(json.render_params);\r\n    }\r\n    if (!!!this.dom_screen || typeof this.dom_screen === 'undefined') {\r\n        console.error(\"Some terrorous happens! dom element for screen not found! element id is \" + json.dom_element);\r\n    }\r\n    //console.log(\"found dome element \" + json.dom_element);\r\n    this.dom_screen.appendChild(this.renderer.domElement);\r\n    this.canvas = this.renderer.domElement;\r\n    \r\n    \r\n    this.renderer.setSize(json.viewport.width, json.viewport.height);\r\n    this.set_viewport(json.viewport.width, json.viewport.height);\r\n    this.renderer.setClearColor(json.clear_color);\r\n    \r\n    this._lifecycle_event(\"render_created\");\r\n}\r\n\r\nApplication.prototype._create_main_scene = function (json)\r\n{\r\n    var event = {prevent: false};\r\n    this._lifecycle_event(\"before_create_main_scene\", event);\r\n    /*\r\n    if (event.prevent) {\r\n        return;\r\n    }\r\n    */\r\n    if (!this.main_scene) {\r\n        this.main_scene = new THREE.Scene();\r\n    }\r\n    \r\n    var camera = json.main_camera;    \r\n    if (!this.main_camera) {\r\n        this.main_camera = new THREE.PerspectiveCamera(camera.fov, camera.aspect_ratio, camera.near, camera.far);\r\n        this.main_scene.add(this.main_camera);\r\n        this.main_camera.name = \"main_camera\";\r\n    } else {\r\n        this.main_camera.fov = camera.fov;\r\n        this.main_camera.near = camera.near;\r\n        this.main_camera.far = camera.far;\r\n        this.main_camera.aspect = camera.aspect_ratio;\r\n        this.main_camera.updateProjectionMatrix();\r\n    }\r\n    \r\n    this.main_camera.position.set(camera.position.x, camera.position.y, camera.position.z);\r\n}\r\n\r\nApplication.prototype.apply_configuration = function (json)\r\n{\r\n    this.configuration = json;\r\n    this._create_render(json);\r\n    this._create_main_scene(json);\r\n    this._lifecycle_event(\"created\");\r\n}\r\n\r\nApplication.prototype.load_configuration = function (url)\r\n{\r\n    var xhr = new THREE.XHRLoader();\r\n    \r\n    var self = this;\r\n    \r\n    var config = self.get_default_configuration();\r\n    \r\n    var configuration_is_applied = false;\r\n    \r\n    function onload (data) {\r\n        console.log(\"configuration loaded from url <<\" + url + \">>\");\r\n        var obj = JSON.parse(data);\r\n        //user config append to default config and may rewrite them, \r\n        //though user naven't to rewrite ALL config to change some params\r\n        _.copy_object(config, obj);\r\n        self.apply_configuration(config);\r\n        console.log(configuration_is_applied, \"onload\");        \r\n        configuration_is_applied = true;\r\n    }\r\n    function progress() {}\r\n    function error(event) {\r\n        console.error(\"Error on loading config!\", event.target.status);\r\n        console.log(\"Setting default configuration\");\r\n        console.log(configuration_is_applied, \"error\");        \r\n        configuration_is_applied = true;        \r\n        self.apply_configuration(config);\r\n    }\r\n    xhr.load(url, onload, progress, error);\r\n}\r\n\r\n\r\nApplication.prototype._set_configuration = function (config)\r\n{\r\n    var default_config = this.get_default_configuration();\r\n    \r\n    //this is url of configuration file\r\n    if (typeof config === 'string') {\r\n        console.log(\"get configuration from url >> \" + config);\r\n        this.load_configuration(config);\r\n        \r\n        //this is object filled with data\r\n    } else if (typeof config === 'object') {\r\n        console.log(\"get configuration from user object\");\r\n        _.copy_object(default_config,config);\r\n        this.apply_configuration(default_config);\r\n    //configuration not given, use default\r\n    } else {\r\n        console.log(\"_set_configuration: set default configration\");\r\n       this.apply_configuration(default_config);\r\n    }\r\n}\r\n\r\nApplication.extend = function (methods, child_func)\r\n{\r\n\r\n    var Child;\r\n    if (typeof child_func === 'undefined') {\r\n        Child = function ()\r\n        {\r\n            Application.apply(this, arguments);\r\n        }\r\n    } else {\r\n        Child = child_func;\r\n    }\r\n\r\n    //create new object and set prototype chain\r\n\tChild.prototype = Object.create(Application.prototype);\r\n    //copy methods to new object\r\n\t_.copy_object(Child.prototype, methods);\r\n    Child.prototype.constructor = Child;\r\n   \r\n    return Child;\r\n}\r\n\r\nApplication.extend_proto = function (proto, methods)\r\n{\r\n\tvar obj = Object.create(proto);\r\n\t_.copy_object(obj, methods);\r\n\tApplication.call(obj);\r\n\treturn obj;\r\n}\r\n\r\n\r\nApplication.prototype.loop = function () \r\n{\r\n\tvar delta = this.clock.getDelta();\r\n\t//fix this - add options to control min frame rate\r\n\tif (delta > 0.1) {\r\n\t\tdelta = 0.1;\r\n\t}\r\n\tthis.delta_time = delta;\r\n    this.do_update(delta);\r\n\tthis.update(delta);\r\n\tthis.render(delta);\r\n\tthis.run();\r\n    //My_Lib.run();\r\n}\r\n\r\n\r\n\r\nApplication.prototype.add_animated_object = function (obj)\r\n{\r\n\t//fix probably duplicates\r\n\tthis.animated_objects.push(obj);\r\n}\r\n\r\nApplication.prototype.remove_animated_object = function (obj)\r\n{\r\n\tfor(var i = 0; i < this.animated_objects.length; i++) {\r\n\t\tif (this.animated_objects[i] === obj) {\r\n\t\t\tthis.animated_objects.splice(i, 1);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n\r\nApplication.prototype.update_all = function (delta)\r\n{\r\n\tvar obj;\r\n\tfor(var i = 0, len = this.animated_objects.length; i < len; i++) {\r\n\t\tobj = this.animated_objects[i];\r\n\t\tif (obj[\"update\"]) {\r\n\t\t\tobj.update(delta);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nApplication.prototype.pre_update = function (delta)\r\n{\r\n\tthis.update_all(delta);\r\n    __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].particle_manager.update(delta);\r\n    //event\r\n    if (this.before_update !== undefined) {\r\n        this.before_update(delta);\r\n    }\r\n}\r\n\r\n\r\nApplication.prototype.do_update = function (dt)\r\n{\r\n    this.pre_update(dt);\r\n    this.update(dt);\r\n}\r\n\r\nApplication.prototype.update = function (delta)\r\n{\r\n}\r\n\r\n\r\nApplication.prototype.create_mouse_move_listener = function ()\r\n{\r\n\tif (this[\"mouse_move_listener\"]) {\r\n\t\treturn;\r\n\t}\r\n\tvar self = this;\r\n\tthis.mouse_move_listener = true;\r\n\tfunction mouse_move_listener(event) {\r\n\t\tvar vector = __WEBPACK_IMPORTED_MODULE_2__base_mouse_intersector_js__[\"a\" /* Mouse_Intersector */].mouse_coords_to_vector(self.dom_screen, event);\t\t\r\n\t\tself.find_mouse_over_intersections(vector);\r\n\t};\r\n\tdocument.addEventListener(\"mousemove\", mouse_move_listener);\r\n}\r\n\r\nApplication.prototype.find_mouse_over_intersections = function(vector)\r\n{\r\n\tvector.unproject(this.main_camera);\r\n\tvar ray = new THREE.Raycaster( this.main_camera.position, vector.sub( this.main_camera.position ).normalize() );\r\n\tvar obj;\r\n\tfor(var i =0, len = this.mouse_controllers.length; i < len; i++){\r\n\t\tobj = this.mouse_controllers[i];\r\n\t\tif (obj.over) {\r\n\t\t\t// create an array containing all objects in the scene with which the ray intersects\r\n\t\t\t//var intersects = ray.intersectObjects( [grid_text.root], true ); \r\n\t\t\t//console.log(fake_plane.root.children[0].geometry);\r\n\t\t\tvar intersects = ray.intersectObjects( [obj.root], true ); \r\n\t\t\tobj.callback(intersects);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nApplication.prototype.add_mouse_controller = function (root, over, click, callback)\r\n{\r\n\tvar tmp = new __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Mouse_Controller(root, over, click, callback)\r\n\tthis.mouse_controllers.push( tmp );\r\n\tif (over) {\r\n\t\tthis.create_mouse_move_listener();\r\n\t}\r\n\treturn tmp;\r\n}\r\n\r\n\r\n\r\nApplication.prototype.set_viewport = function (width, height)\r\n{\r\n\t__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Viewport.width = width;\r\n\t__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Viewport.height = height;\r\n}\r\n\r\nApplication.prototype.render = function (delta) \r\n{\r\n\tthis.renderer.setClearColor(this.configuration.clear_color);\r\n\tthis.renderer.autoClear = true;\r\n\tthis.renderer.render(this.main_scene, this.main_camera);\r\n}\r\n\r\n\r\n\r\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Base_Animation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return Euler_Animation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return Scale_Animation; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__my_lib_js__ = __webpack_require__(0);\n\r\n\r\n//length - simple length of animations\r\n//-1 - infinite\r\n//0 - stop\r\n//> 0 - length of animation, \r\n//if time > length, animation stop\r\n//need rewrite this crap to safe floating point mannere\r\n//and append more controle on animation \r\n    function Base_Animation ()\r\n    {\r\n        this.time = 0;\r\n        this.time_scale = 1.0;\r\n        this.type = \"Base_Animation\";\r\n        this.uuid = _.generateUUID();\r\n        this.length = -1;\r\n        this.stopped = false;\r\n    }\r\n    \r\n    Base_Animation.prototype.update = function (dt)\r\n    {\r\n        var scaled_dt = dt * this.time_scale;\r\n        this.time += scaled_dt;\r\n        if (this.length < 0 || this.time < this.length) {\r\n            this.calc_animation(dt);\r\n        }\r\n    }\r\n    \r\n    Base_Animation.prototype.stop = function ()\r\n    {\r\n        this.stopped = true;\r\n    }\r\n    \r\n    Base_Animation.prototype.start = function ()\r\n    {\r\n        this.stopped = false;\r\n    }\r\n    \r\n    Base_Animation.prototype.reset = function ()\r\n    {\r\n        this.time = 0;\r\n    }\r\n    \r\n    Base_Animation.prototype.calc_animation = function (dt)\r\n    {\r\n        \r\n    }\r\n    \r\n    Base_Animation.prototype.apply = function(obj)\r\n    {\r\n    }\r\n    \r\n    Base_Animation.prototype.toJSON = function (data)\r\n    {\r\n        var data = {};\r\n        data.uuid = this.uuid;\r\n        data.type = this.type;\r\n        if (this.name !== '') {\r\n            data.name = this.name;\r\n        }\r\n        data.time_scale = this.time_scale === undefined ? 1.0 : this.time_scale;\r\n        data.length = this.length;\r\n        return data;\r\n    }\r\n    \r\n    Base_Animation.prototype.parse = function (param)\r\n    {\r\n        this.type = param.type;\r\n        this.uuid = param.uuid;\r\n        this.name = param.name ? param.name : '';\r\n        this.time_scale = (param.time_scale === undefined) ? 1.0 : param.time_scale;\r\n        this.length = param.length === undefined ? -1 : param.length;\r\n    }\r\n    \r\n\r\n    \r\n    \r\n        \r\nfunction Euler_Animation (x, y, z)\r\n{\r\n    Base_Animation.call(this);\r\n    this.type = \"Euler_Animation\";\r\n\tthis.xspeed = x;\r\n\tthis.yspeed = y;\r\n\tthis.zspeed = z;\r\n    this.x = 0;\r\n    this.y = 0;\r\n    this.z = 0;\r\n    this.name = '';\r\n}\r\n\r\nEuler_Animation.prototype = Object.create(Base_Animation.prototype);\r\n\r\n\r\nEuler_Animation.prototype.constructor = Euler_Animation;\r\n\r\nEuler_Animation.prototype.calc_animation = function (dt)\r\n{\r\n    //console.log(this.xspeed,this.yspeed, this.zpeed, dt, this.time_scale);\r\n    dt *= this.time_scale;\r\n\tthis.x += this.xspeed * dt;\r\n\tthis.y += this.yspeed * dt;\r\n\tthis.z += this.zspeed * dt;\r\n}\r\n    \r\nEuler_Animation.prototype.apply = function (obj)\r\n{\r\n    obj.rotation.set(this.x,this.y, this.z);\r\n}\r\n\r\nEuler_Animation.prototype.toJSON = function (json)\r\n{\r\n   var data = Base_Animation.prototype.toJSON.call(this);\r\n   data.xspeed = this.xspeed;\r\n   data.yspeed = this.yspeed;\r\n   data.zspeed = this.zspeed;\r\n   return data;\r\n}\r\n\r\nEuler_Animation.prototype.parse = function (param)\r\n{\r\n    Base_Animation.prototype.parse.call(this, param);\r\n    this.xspeed = param.xspeed;\r\n    this.yspeed = param.yspeed;\r\n    this.zspeed = param.zspeed;\r\n    this.x = this.y = this.z = 0;    \r\n}\r\n\r\n\r\nfunction Scale_Animation(x, y, z)\r\n{\r\n    Base_Animation.call(this);\r\n    //speed of scale\r\n    this.xscale = x;\r\n    this.yscale = y;\r\n    this.zscale = z;\r\n    this.x = 1.0;\r\n    this.y = 1.0;\r\n    this.z = 1.0;\r\n}\r\n\r\nScale_Animation.prototype = Object.create(Base_Animation.prototype);\r\n\r\n_.copy_object(Scale_Animation.prototype, {\r\n    constructor: Scale_Animation,\r\n    calc_animation: function (dt) \r\n    {\r\n        dt = dt * this.time_scale;\r\n        this.x += this.xscale * dt;\r\n        this.y += this.yscale * dt;\r\n        this.z += this.zscale * dt;\r\n    },\r\n    apply:function (obj) {\r\n        obj.scale.set(this.x, this.y, this.z);\r\n    },\r\n    reset: function () {\r\n        if (this.first) {\r\n        }\r\n        this.x = 1.0;\r\n        this.y = 1.0;\r\n        this.z = 1.0;\r\n        this.time = 0;\r\n    }\r\n});\r\n\r\n\r\n__WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Base_Animation\", Base_Animation);\r\n__WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Euler_Animation\", Euler_Animation);\r\n__WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Scale_Animation\", Scale_Animation);\r\n\r\n\r\n\r\n\n\n/***/ }),\n/* 15 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Loading_Manager; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__my_lib_js__ = __webpack_require__(0);\n\r\n\r\n//events: \r\n//item_loaded\r\n//onerror\r\n//onprogress\r\n//finished\r\nfunction Chain_Loader()\r\n{\r\n}\r\n\r\nChain_Loader.prototype = {\r\n\tconstructor: Chain_Loader,\r\n\tstart: function (list) \r\n\t{\r\n\t\tthis.list = list;\r\n\t\tthis.index = 0;\r\n\t\tthis.load(this.list[0]);\r\n\t\tthis.stop_by_error = false;\r\n\t},\r\n\t\r\n\tnext: function(resource)\r\n\t{\r\n\t\tif (this.item_loaded && resource) {\r\n\t\t\tthis.item_loaded(resource,this.list[this.index]);\r\n\t\t}\r\n\t\tthis.index++;\r\n\t\tif (this.index < this.list.length) {\r\n\t\t\tthis.load(this.list[this.index]);\r\n\t\t} else {\r\n\t\t\tif (this.finished) {\r\n\t\t\t\tthis.finished();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\tdo_error: function (error)\r\n\t{\r\n\t\tif (this.onerror) {\r\n\t\t\tthis.onerror(error);\r\n\t\t} else {\r\n\t\t\tconsole.error(\"Chain Loader Error!\", error);\r\n\t\t}\r\n\t\tif (!this.stop_by_error) {\r\n\t\t\tthis.next();\r\n\t\t}\r\n\t},\r\n\t\r\n\tdo_progress: function ()\r\n\t{\r\n\t\tif (this.onprogress) {\r\n\t\t\tthis.onprogress.apply(this, arguments);\r\n\t\t}\r\n\t},\r\n\t\t\r\n\tload: function (item)\r\n\t{\r\n\t\tvar self = this;\r\n\t\tif (this.load_func) {\r\n\t\t\tthis.load_func(item, \r\n\t\t\tfunction (item) { self.next.apply(self, arguments); },\r\n\t\t\tfunction (item) { self.do_error.apply(self, arguments); },\r\n\t\t\tfunction (item) { self.do_progress.apply(self, arguments); });\r\n\t\t}\r\n\t}\r\n};\r\n\r\n\r\nfunction test_chain_loader() \r\n{\r\n\tvar cl = new Chain_Loader();\r\n\tcl.item_loaded = function (item) {console.log(\"load item \", item);}\r\n\tcl.finished = function (item) {console.log(\"loader manager - job done\");}\r\n\tcl.load_func = function (item, next, error, progress) { \r\n\t\tif (item) {\r\n\t\t\tnext(item);\r\n\t\t} else {\r\n\t\t\terror(item);\r\n\t\t}\r\n\t}\r\n\tcl.start([\"first\", \"second\", null, \"tree\"]);\r\n}\r\n//test_chain_loader();\r\n\r\n\r\n\r\n\r\nfunction Loading_Manager ()\r\n{\r\n\tthis.resources = {};\r\n\tthis.texture_loader = new THREE.TextureLoader();\r\n}\r\n\r\nLoading_Manager.prototype = {\r\n\tconstructor: Loading_Manager,\r\n\tget: function (name)\r\n\t{\r\n\t\treturn this.resources[name];\r\n\t},\r\n\t\r\n\tget_async: function (name, callback)\r\n\t{\r\n\t\t//already loaded?\r\n\t\tvar texture = this.get(name);\r\n\t\tif (texture) {\r\n\t\t\tif (callback) {\r\n\t\t\t\tcallback(texture);\r\n\t\t\t}\r\n\t\t\treturn texture;\r\n\t\t}\r\n\r\n\t\t//if not load this async\r\n\t\tvar self = this;\r\n\t\ttexture = this.texture_loader.load(name, function (texture)\r\n\t\t{\r\n\t\t\tif (callback) {\r\n\t\t\t\tcallback(texture);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.resources[name] = texture;\t\r\n\t\treturn texture;\r\n\t},\r\n\t\r\n\r\n\tload_list: function (resource_list, on_load, load_func, on_progress)\r\n\t{\r\n\t\tvar self = this;\r\n\t\t\r\n\t\tvar cl = new Chain_Loader();\r\n\t\tvar self = this;\r\n\t\tcl.onerror = function (error) {\r\n\t\t\tconsole.error(\"ERROR loading texture\", error, cl.list[cl.index]);\t\r\n\t\t}\r\n\t\tcl.item_loaded = function (resource, name) {\r\n\t\t\tself.resources[name] = resource;\r\n\t\t\tif (self.on_resource_loaded) {\r\n\t\t\t\tself.on_resource_loaded(resource);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcl.on_progress = function () {\r\n\t\t\tif (on_progress) {\r\n\t\t\t\ton_progress();\r\n\t\t\t}\r\n\t\t}\r\n\t\tcl.load_func = function () {\r\n\t\t\tload_func.apply(this, arguments);\r\n\t\t}\r\n\t\tcl.finished = function ()\r\n\t\t{\r\n\t\t\tif (on_load) {\r\n\t\t\t\ton_load();\r\n\t\t\t}\r\n\t\t}\r\n\t\tcl.start(resource_list);\r\n\t\t\r\n\t},\r\n\r\n\tload_list_textures: function (resource_list, on_load)\r\n\t{\r\n\t\tvar self = this;\r\n\t\tthis.load_list(resource_list, on_load, function (url, next, error, progress ) \r\n\t\t{\r\n\t\t\tvar texture = self.texture_loader.load(url, next, progress, error);\r\n\t\t});\r\n\t},\r\n\r\n\tload_list_json: function (resource_list, on_load, progress)\r\n\t{\r\n\t\tvar self = this;\r\n\t\tvar loader = new THREE.XHRLoader();\t\r\n\t\tthis.load_list(resource_list, on_load, function (url, next, error, progress) \r\n\t\t{\r\n\t\t\tvar texture = loader.load(url, next, progress, error);\r\n\t\t}, progress);\r\n\t},\r\n\t\r\n\tfree: function ()\r\n\t{\r\n\t\tthis.resources = {};\r\n\t}\r\n};\r\n\r\n\r\n__WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].Texture_Manager = new Loading_Manager();\t\r\n\r\n\n\n/***/ }),\n/* 16 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Package_Manager; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__my_lib_js__ = __webpack_require__(0);\n//TODO: remove this ugly crap and replace something reasonable\r\n\r\n\r\n\r\n//this ugly class loading texture list in json format, parse it, and loading textures\r\n//then it call event data_loaded, when give texture list in json format\r\n\r\nfunction Package_Manager()\r\n{\r\n    this.state = {};\r\n}\r\n\r\n//load json file with descriptions of package: texture list, particles list, scene objects list\r\nPackage_Manager.prototype.load = function (url, defaults)\r\n{\r\n    this.defaults = defaults;\r\n    var self = this;\r\n    this.state = {\r\n        \"type\": \"start\"\r\n    };\r\n    \r\n    var self = this;\r\n    function onload (data) {\r\n        self.state[\"type\"] = \"done\";\r\n        self.state[\"data\"] = data;\r\n        \r\n        self.parse_package_description(data);        \r\n    }    \r\n    function error(event) {\r\n        self.state[\"type\"] = \"error\";\r\n        self.state[\"error\"] = event;\r\n        console.error(\"ERror! Failed loading resources with url \"+url, event.target);        \r\n        if (self.error){\r\n            self.error(event.target);\r\n        }\r\n        self.pack = self.defaults\r\n        self.load_resources(self.defaults);\r\n\r\n    }\r\n    function progress()\r\n    {\r\n    }\r\n    var xhr = new THREE.XHRLoader();\r\n    xhr.load(url, onload, progress, error);\r\n}\r\n\r\n//parse loaded json file \r\nPackage_Manager.prototype.parse_package_description = function (data)\r\n{\r\n    console.log(\"packaged description loaded, begin parsing...\");\r\n  try {\r\n        var pack = JSON.parse(data);\r\n        this.pack = pack;\r\n        if (this.loaded) {\r\n            this.loaded(pack);\r\n        }\r\n        \r\n   } \r\n   catch(e) {\r\n        console.error(\"error parsing resources \", e);\r\n        if (this.error){\r\n            this.error(event);\r\n        }\r\n        return;        \r\n   }\r\n   this.load_resources(pack);\r\n}\r\n\r\n\r\nPackage_Manager.prototype.load_resources = function (pack)\r\n{\r\n    var self = this;\r\n    //load textures\r\n   console.log(\"Package Manager: begin loading textures...\");    \r\n    __WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].Texture_Manager.load_list_textures(pack.textures, function (){\r\n        //load json descriptions files\r\n                if (self.data_loaded) {\r\n                    self.data_loaded(pack);\r\n                }\r\n    })\r\n}\r\n\r\n\r\n\n\n/***/ }),\n/* 17 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Scene_Serializer; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__my_lib_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__particles_particles_manager_js__ = __webpack_require__(11);\n\r\n\r\n\r\nfunction Scene_Serializer(root)\r\n{\r\n    this.animation_library = {};\r\n}\r\n\r\nScene_Serializer.prototype.toJSON = function (root)\r\n{\r\n    this.json = root.toJSON();\r\n    console.log(\"my lib particle manager\", __WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].particle_manager);\r\n    this.json[\"particles\"] = __WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].particle_manager.toJSON();\r\n    var anims = root.collect_animations(root);\r\n    if (anims.count > 0) {\r\n        this.json[\"myanimations\"] = anims;\r\n    }\r\n    \r\n    return this.json;\r\n}\r\n\r\n\r\n\r\nScene_Serializer.prototype.create_animations = function (animations) {\r\n    for(var key in animations) {\r\n        if ( this.animation_library[key] === undefined && Object.prototype.hasOwnProperty.call(animations, key)) {\r\n            var data = animations[key];\r\n            //console.log(\"create animations \", data.uuid);            \r\n            var anim =  __WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].Abstract_Fabric(data);\r\n            if (anim) {\r\n                this.animation_library[key] = anim;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\nScene_Serializer.prototype.bind_animations = function (animdata)\r\n{\r\n    if (!animdata) return;\r\n    \r\n    var bindings = animdata.bindings;\r\n    \r\n    //console.log(\"bind animation\");\r\n    var self = this;\r\n    function copy_animations(obj, bind)\r\n    {\r\n        for(var i = 0; i < bind.animations.length; i++){\r\n            var anim_uuid = bind.animations[i];\r\n            obj.add_animation( self.animation_library[anim_uuid] );\r\n        }\r\n    }\r\n    \r\n     for(var i =0; i < bindings.length; i++) {\r\n        var bind = bindings[i];\r\n        var uuid = bind.uuid;\r\n        var obj = this.root.getObjectByProperty(\"uuid\", uuid);\r\n        if (obj) {\r\n            //console.log(\"binding \" + uuid + \" object to animation \"+uuid);\r\n            copy_animations(obj, bind);\r\n        }\r\n    }\r\n}\r\n\r\n\r\nScene_Serializer.prototype.load_from_json = function (url)\r\n{\r\n    var self = this;\r\n    function onload(json)\r\n    {\r\n        try {\r\n            var data = JSON.parse(json);\r\n        }\r\n        catch(e) {\r\n            console.error(\"Failed to parse scene \", e);\r\n            throw e;\r\n        }\r\n        if (data === undefined) {\r\n            console.error(\"Something fucking happened, failed to load scene \", url);\r\n            return;\r\n        }\r\n        self.load(data);\r\n    }\r\n    function progress()\r\n    {\r\n    }\r\n    function error(e)\r\n    {\r\n        console.error(e.target);\r\n        throw e;\r\n    }\r\n    var xhr = new THREE.XHRLoader();\r\n    xhr.load(url, onload, progress, error);\r\n}\r\n\r\nScene_Serializer.prototype.load = function (json)\r\n{\r\n    this.animation_library = {};\r\n    var o = new THREE.ObjectLoader();\r\n    if (json !== undefined) {\r\n        this.json = json;\r\n    }\r\n    var root = o.parse(this.json, function () {console.log(\"onload\")});\r\n    this.root = root;    \r\n\r\n    __WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].particle_manager.load_particles(this.json, root);\r\n    \r\n    this.create_animations(this.json.myanimations.animations);\r\n    this.bind_animations(this.json.myanimations);\r\n    this.main_camera = root.getObjectByName(\"main_camera\");\r\n    \r\n    if (this.scene_loaded) {\r\n        this.scene_loaded(root);\r\n    }\r\n    return root;\r\n}\r\n\r\n\n\n/***/ }),\n/* 18 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Mixin; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_mouse_camera_controller_js__ = __webpack_require__(3);\n\r\n\r\nfunction Mixin()\r\n{\r\n\r\n    //need for unproject object and dragging\r\n    THREE.PerspectiveCamera.prototype.get_forward_plane_by_object = function (obj)\r\n    {\r\n        var z = new THREE.Vector3();\r\n        z.setFromMatrixColumn( this.matrixWorld, 2 );\r\n        var dist = obj.position.dot(z);             \r\n        var plane= new THREE.Plane(z.negate(), dist);\r\n        return plane;\r\n    }\r\n\r\n    \r\n    THREE.PerspectiveCamera.prototype.get_ray_from_screen_coordinates = function (canvas, x,y)\r\n    {\r\n        var mc = new __WEBPACK_IMPORTED_MODULE_0__base_mouse_camera_controller_js__[\"a\" /* Mouse_Camera_Controller */](canvas, this);\r\n        var ray = mc.get_ray_from_camera_in_screen_coordinates(x,y);\r\n        return ray;\r\n    }\r\n\r\n    \r\n}\r\n\r\nMixin();\r\n\n\n/***/ }),\n/* 19 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Mix_It; });\nfunction Mix_It()\r\n{\r\n\r\n\r\n\r\n\t//FIX\r\n\tTHREE.Vector3.prototype.applyMatrix4_rotation = function ( m ) \r\n\t{\r\n\t\t// input: THREE.Matrix4 affine matrix\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z;\r\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z;\r\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\r\n\r\n\t\treturn this;\r\n \t}\r\n\r\nvar Object3D_Animation_Mixin = {\r\n    \r\n    add_animation: function (anim)\r\n    {\r\n        if (!this.animations) {\r\n            this.animations = [];\r\n        }\r\n        if (this.animations.indexOf(anim) < 0) {\r\n            this.animations.push(anim);\r\n        }\r\n    },\r\n    \r\n    remove_animation: function (anim)\r\n    {\r\n        if (this.animations) {\r\n            var i = this.animations.indexOf(anim);\r\n            if (i > -1) {\r\n                this.animations.splice(i, 1);\r\n            }\r\n        }\r\n    },\r\n    \r\n    update:  function (dt)\r\n    {\r\n        //console.log(\"object update\", dt);\r\n        if (this.animations !== undefined) {\r\n            for(var i =0; i < this.animations.length; i++) {\r\n                var anim = this.animations[i];\r\n                anim.update(dt);\r\n                //console.log(this.rotation);\r\n                anim.apply(this);\r\n                //console.log(this.rotation);\r\n            }\r\n        }\r\n    \r\n        for(var i = 0; i < this.children.length; i++) {\r\n            var obj = this.children[i];\r\n            if (obj.update) {\r\n                obj.update(dt);\r\n            }\r\n        }\r\n    },\r\n    \r\n    \r\n};\r\n_.copy_object(THREE.Object3D.prototype, Object3D_Animation_Mixin);\r\n\r\n\r\nTHREE.Object3D.prototype.old_toJson = THREE.Object3D.toJSON;\r\n\r\nvar Object3D_Serialization_Mixin = \r\n{\r\n    standard_serialization: function (meta) \r\n    {\r\n\t\t// standard Object3D serialization\r\n\t\tvar object = {};\r\n\r\n\t\tobject.uuid = this.uuid;\r\n\t\tobject.type = this.type;\r\n\t\tif ( this.name !== '' ) object.name = this.name;\r\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) object.userData = this.userData;\r\n\t\tif ( this.castShadow === true ) object.castShadow = true;\r\n\t\tif ( this.receiveShadow === true ) object.receiveShadow = true;\r\n\t\tif ( this.visible === false ) object.visible = false;\r\n\r\n\t\tobject.matrix = this.matrix.toArray();\r\n        \r\n\r\n        if (this.type !== \"particles_points\")\r\n        {\r\n            if (this.geometry !== undefined) {\r\n                object.geometry = this.geometry.uuid;\r\n            }\r\n            if ( this.material !== undefined ) {\r\n                object.material = this.material.uuid;\r\n            }\r\n            \r\n            if ( this.material !== undefined  &&  meta.materials[ this.material.uuid ] === undefined ) {\r\n                    meta.materials[ this.material.uuid ] = this.material.toJSON( meta);\r\n            }\r\n\r\n            if ( this.geometry !== undefined && meta.geometries[ this.geometry.uuid ] === undefined ) {\r\n                    meta.geometries[ this.geometry.uuid ] = this.geometry.toJSON( meta );\r\n            }\r\n        }\r\n        \r\n        if (this.animations) {\r\n            object.animations = [];\r\n            for(var i =0; i < this.animations.length; i++) {\r\n                object.animations.push ( this.animations[i].uuid );\r\n            }\r\n        }\r\n        \r\n\t\tif ( this.children.length > 0 ) {\r\n\t\t\tobject.children = [];\r\n\t\t\tfor ( var i = 0; i < this.children.length; i ++ ) \r\n            {\r\n                var child = this.children[ i ];\r\n\t\t\t\t//object.children.push( child.standard_serialization( meta ) );\r\n                object.children.push( child.toJSON( meta ) );\r\n\t\t\t}\r\n\t\t}\r\n        return object;\r\n    },\r\n    \r\n    collect_materials: function (meta) \r\n    {\r\n\t\tif ( this.material !== undefined  &&  meta.materials[ this.material.uuid ] === undefined ) {\r\n                meta.materials[ this.material.uuid ] = this.material.toJSON( meta);\r\n\t\t}\r\n        \r\n\t\tfor ( var i = 0; i < this.children.length; i ++ ) {\r\n\t\t\tthis.children[ i ].collect_materials(meta);\r\n\t\t}\r\n    },\r\n    \r\n    collect_geometry: function (meta)\r\n    {\r\n\t\tif ( this.geometry !== undefined && meta.geometries[ this.geometry.uuid ] === undefined ) {\r\n\t\t\t\tmeta.geometries[ this.geometry.uuid ] = this.geometry.toJSON( meta );\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < this.children.length; i ++ ) {\r\n\t\t\tthis.children[ i ].collect_geometry(meta);\r\n\t\t}\r\n    },\r\n    \r\n\ttoJSON1: function ( meta ) {\r\n    \r\n\t\t// extract data from the cache hash\r\n\t\t// remove metadata on each item\r\n\t\t// and return as array\r\n\t\tfunction extractFromCache( cache, t ) {\r\n\t\t\tvar values = [];\r\n\t\t\tfor ( var key in cache ) {\r\n\t\t\t\tvar data = cache[ key ];\r\n\t\t\t\tdelete data.metadata;\r\n\t\t\t\tvalues.push( data );\r\n\t\t\t}\r\n\t\t\treturn values;\r\n\t\t}\r\n    \r\n\r\n        this.updateMatrixWorld(true);\r\n        \r\n\t\t// meta is '' when called from JSON.stringify\r\n\t\tvar isRootObject = ( meta === undefined || meta === '' );\r\n\r\n\t\tvar output = {};\r\n\r\n\t\tif ( isRootObject ) {\r\n\r\n            meta = {\r\n\t\t\t\tgeometries: {},\r\n\t\t\t\tmaterials: {},\r\n\t\t\t\ttextures: {},\r\n\t\t\t\timages: {}\r\n\t\t\t};\r\n            \r\n            \r\n            //this.collect_materials(meta);\r\n            //this.collect_geometry(meta);\r\n            var object = this.standard_serialization(meta);\r\n            \r\n            \r\n\t\t\toutput.metadata = {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'Object',\r\n\t\t\t\tgenerator: 'Object3D.toJSON'\r\n\t\t\t};\r\n\r\n\t\t\tvar geometries = extractFromCache( meta.geometries, \"geoim\" );\r\n\t\t\tvar materials = extractFromCache( meta.materials, \"materials\" );\r\n\t\t\tvar textures = extractFromCache( meta.textures, \"textures\" );\r\n\t\t\tvar images = extractFromCache( meta.images, \"images\" );\r\n\r\n\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\r\n\t\t\tif ( materials.length > 0 ) output.materials = materials;\r\n\t\t\tif ( textures.length > 0 ) output.textures = textures;\r\n\t\t\tif ( images.length > 0 ) output.images = images;\r\n\r\n            var anims = this.collect_animations(this);\r\n            if (anims.count > 0) {\r\n                output[\"myanimations\"] = anims;\r\n            }\r\n           \r\n            output.object = object;\r\n\t\t} else {\r\n            output.object = this.standard_serialization(meta);\r\n            output.type = this.type;\r\n            if (output.object === undefined) {\r\n                console.log(\"i am undefined\", this);\r\n            }\r\n        }\r\n\r\n\t\treturn output;\r\n\r\n\r\n\t},\r\n    \r\n    collect_animations: function (scene)\r\n    {\r\n        var data = {\r\n            animations : {},\r\n            bindings : [],\r\n            count: 0\r\n        };\r\n        \r\n        function collect_animations_recursive(root)\r\n        {\r\n            if (root.animations) {\r\n                for(var i =0; i < root.animations.length; i++) {\r\n                    var anim = root.animations[i];\r\n                    if (data.animations[ anim.uuid ] === undefined) {\r\n                        data.animations[ anim.uuid] = anim.toJSON() ;\r\n                        data.count++;\r\n                    }\r\n                }\r\n                \r\n                var bind = {};\r\n                bind.uuid = root.uuid\r\n                bind.animations = [];\r\n                for(var i =0; i < root.animations.length; i++) {\r\n                    bind.animations.push( root.animations[i].uuid);\r\n                }\r\n                data.bindings.push(bind);\r\n            }\r\n            \r\n            if (root.children) {\r\n                for(var i = 0; i < root.children.length; i++) {\r\n                    collect_animations_recursive( root.children[i] );\r\n                }\r\n            }\r\n        }\r\n        collect_animations_recursive(scene);\r\n        return data;\r\n    },\r\n    \r\n \r\n};\r\n\r\n\r\n  _.copy_object(THREE.Object3D.prototype, Object3D_Serialization_Mixin);\r\n  \r\nTHREE.Object3D.prototype.dm_mark = 'yes,this object has been marked by black magic, owned by me, dark matters'; \r\n\r\n//replace source with this\r\nTHREE.Object3D.prototype.replace_object_with_this = function ( source ) {\r\n\r\n    this.uuid = source.uuid;\r\n    this.name = source.name;\r\n\r\n    this.up.copy( source.up );\r\n    this.position.copy( source.position );\r\n    this.quaternion.copy( source.quaternion );\r\n    this.scale.copy( source.scale );\r\n\r\n    this.matrix.copy( source.matrix );\r\n    this.matrixWorld.copy( source.matrixWorld );\r\n\r\n    this.matrixAutoUpdate = source.matrixAutoUpdate;\r\n    this.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\r\n\r\n    this.visible = source.visible;\r\n\r\n    this.castShadow = source.castShadow;\r\n    this.receiveShadow = source.receiveShadow;\r\n\r\n    this.frustumCulled = source.frustumCulled;\r\n    this.renderOrder = source.renderOrder;\r\n\r\n    this.userData = JSON.parse( JSON.stringify( source.userData ) );\r\n\r\n    //copy array of children, not clone\r\n    for ( var i = 0; i < source.children.length; i ++ ) {\r\n        this.add( source.children[ i ] );\r\n    }\r\n    source.parent.add(this);\r\n    source.parent.remove(source);\r\n    \r\n    this.animations = source.animations;\r\n}\r\n\r\n\r\n}\r\n\r\nMix_It();\r\n\r\n\n\n/***/ }),\n/* 20 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Custom_Affector; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__particle_affector_js__ = __webpack_require__(1);\n\r\n\r\n\r\nfunction Custom_Affector()\r\n{\r\n\t__WEBPACK_IMPORTED_MODULE_1__particle_affector_js__[\"a\" /* Particle_Affector */].apply(this, arguments);\r\n    this.custom_func = function dummy () {return true;};\r\n}\r\n\r\n\r\nCustom_Affector.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_1__particle_affector_js__[\"a\" /* Particle_Affector */].prototype);\r\n\r\n_.copy_object(Custom_Affector.prototype, \r\n    {\r\n    constructor: Custom_Affector,\r\n   \taffect: function (dt, pdata, vert)\r\n\t{\r\n        return this.custom_func(dt, p, vert);\r\n\t},\r\n    test_func: function () {\r\n        var p = {\r\n            position: {x: 0, y: 0, z: 0},\r\n            velocity: {x: 0, y: 0, z: 0}\r\n        };\r\n        var color = {r: 0, g: 0, b: 0};\r\n        this.custom_func(p, color);\r\n    },\r\n    set_affect_function: function (source) {    \r\n        if (typeof source === 'function') {\r\n            this.custom_func = source;\r\n        } else if (typeof source  === 'string') {\r\n            try {\r\n                this.custom_func = new Function ('dt,p,vert', source);\r\n                this.test_func();\r\n            }\r\n            catch (e) {\r\n                alert(e);\r\n                this.custom_func = undefined;\r\n            }\r\n            this.source_code = source;\r\n        }\r\n    },\r\n    \r\n\ttoJSON: function ()\r\n\t{\r\n        var data = {\r\n            name: \"Custom_Affector\"\r\n        };\r\n\t\tdata.params = __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Particle_Affector.prototype.toJSON.call(this, this);\r\n\t\tparams[\"source_code\"] = this.source_code;\r\n\t\treturn data;\r\n\t},\r\n\tparse: function (json)\r\n\t{\r\n\t\t__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Particle_Affector.prototype.parse(this, json);\r\n\t\tthis.set_affect_func(json.source_code);\r\n\t}\r\n\r\n});\r\n\r\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Custom_Affector\", Custom_Affector);\r\n\r\n\n\n/***/ }),\n/* 21 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Custom_Emitter; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__ = __webpack_require__(2);\n\r\n\r\n\r\n\r\nfunction Custom_Emitter()\r\n{\r\n\t__WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__[\"a\" /* Particle_Emitter */].apply(this, arguments);\r\n}\r\n\r\n\r\nCustom_Emitter.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype);\r\n\r\nvar methods = {\r\n    emit: function (p, color) {\r\n        if (this.custom_func) {\r\n            this.custom_func(p, color);\r\n        }\r\n    },\r\n    test_func: function () {\r\n        var p = {\r\n            position: {x: 0, y: 0, z: 0},\r\n            velocity: {x: 0, y: 0, z: 0}\r\n        };\r\n        var color = {r: 0, g: 0, b: 0};\r\n        this.custom_func(p, color);\r\n    },\r\n    set_emit_function: function (source) {\r\n        if (typeof source === 'function') {\r\n            this.custom_func = source;\r\n        } else if (typeof source  === 'string') {\r\n            try {\r\n                this.custom_func = new Function ('p', 'color', source);\r\n                this.test_func();\r\n            }\r\n            catch (e) {\r\n                alert(e);\r\n                this.custom_func = undefined;\r\n            }\r\n            this.source_code = source;\r\n        }\r\n    },\r\n    toJSON: function () {\r\n        var data = {};\r\n        data.name = \"Custom_Emitter\";\r\n        data.params = __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Particle_Emitter.prototype.toJSON.call(this, this);\r\n        if (this.source_code) {\r\n            data.params.source_code = this.source_code;\r\n        }\r\n        return data;\r\n    },\r\n    parse: function (data) {\r\n        __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Particle_Emitter.prototype.parse.call(this, data);        \r\n        this.set_emit_function (data.source_code);\r\n    },\r\n    constructor: Custom_Emitter,\r\n};\r\n\r\n_.copy_object(Custom_Emitter.prototype, methods);\r\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Custom_Emitter\", Custom_Emitter);\r\n\r\n\r\nfunction test()\r\n{\r\n    var t = new Custom_Emitter();\r\n    var source = 'p.position.z = -100; p.velocity.y = 100;';\r\n    t.set_emit_function(source);\r\n    var p = {\r\n        velocity: {x: 0, y: 0, z: 0},\r\n        position: {x: 0, y: 0, z: 0}\r\n    };\r\n    t.custom_func(p);\r\n    console.log(p);\r\n    var json = t.toJSON();\r\n    console.log(json);\r\n    \r\n    t = new Custom_Emitter();\r\n    t.parse(json.params);\r\n    //console.log(t.custom_func);    \r\n}\r\n\r\n//test();\r\n\r\n/*\r\nCustom_Emitter.prototype = Object.create(My_Lib.Particle_Emitter.prototype);\r\nCustom_Emitter.prototype.constructor = Cone_Emitter;\r\nMy_Lib.Register_Class(\"Custom_Emitter\", Cone_Emitter);\r\n*/\r\n\r\n\n\n/***/ }),\n/* 22 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particle_Forces; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n\r\n\r\nvar Particle_Forces = {};\r\n\r\n//base class\r\nParticle_Forces.Force = function ()\r\n{\r\n}\r\n\r\n\r\n_.copy_object(Particle_Forces.Force.prototype,{\r\n\t\tcalc: function (dt, particle, acceleration) \r\n\t\t{\r\n\t\t},\r\n\t\ttoJSON: function (child) \r\n\t\t{\r\n\t\t\treturn {};\r\n\t\t},\r\n\t\tparse: function (json) \r\n\t\t{\r\n\t\t},\r\n});\r\n\r\n//constant force\r\nParticle_Forces.Constant_Force = function (force)\r\n{\r\n\tif (typeof force !== 'undefined') {\r\n\t\tthis.force = force;\r\n\t} else {\r\n\t\tthis.force = {x:0, y:0, z:0};\r\n\t}\r\n}\r\n\r\nParticle_Forces.Constant_Force.prototype = Object.create(Particle_Forces.Force.prototype);\r\n_.copy_object(Particle_Forces.Constant_Force.prototype, {\r\n\tconstructor: Particle_Forces.Constant_Force,\r\n\tcalc: function (dt, p, acceleration) \r\n\t{\r\n\t\tacceleration.x += this.force.x;\r\n\t\tacceleration.y += this.force.y;\r\n\t\tacceleration.z += this.force.z;\r\n\t},\r\n\ttoJSON: function (child)\r\n\t{\r\n\t\tvar data = {};\r\n\t\tdata.name = \"Constant_Force\";\r\n\t\tdata.force = _.create_clone_object(this.force);\r\n\t\treturn data;\r\n\t},\r\n\tparse: function (json)\r\n\t{\t\r\n\t\tif (json.force) {\r\n\t\t\t_.copy_object(this.force, json.force);\r\n\t\t}\r\n\t}\r\n});\r\n\r\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Constant_Force\", Particle_Forces.Constant_Force);\r\n\r\n\n\n/***/ }),\n/* 23 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Cone_Emitter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return Star_Dust_Emitter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return Sphere_Emitter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"d\", function() { return Star_Dust_Affector; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__point_generators_js__ = __webpack_require__(12);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__particle_affector_js__ = __webpack_require__(1);\n\r\n\r\n\r\n\r\n\r\nfunction  Cone_Emitter()\r\n{\r\n\t__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].apply(this, arguments);\r\n\tthis.generator = new __WEBPACK_IMPORTED_MODULE_1__point_generators_js__[\"a\" /* Point_Generators */].Random_Direction();\r\n\tthis.origin = new THREE.Vector3(1, 1, 0);\r\n\tthis.velocity = new THREE.Vector3(0, 1, 0);\r\n\tthis.dispersion = {\"min\": 5, \"max\": 10};\r\n\tthis.dispersion.delta = 5;\r\n\tthis.speed = {min: 5, max: 10, delta:5};\r\n\tthis.color = new THREE.Color(1, 1, 1);\r\n}\r\n\r\nCone_Emitter.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype);\r\nCone_Emitter.prototype.constructor = Cone_Emitter;\r\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Cone_Emitter\", Cone_Emitter);\r\n\r\nCone_Emitter.prototype.toJSON = function ()\r\n{\r\n\tvar data = {};\r\n\tdata.name = \"Cone_Emitter\";\r\n\tdata.params = __WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype.toJSON.call(this, this);\r\n\t_.clone_field_list_one_level_recursion(this, data.params, \r\n\t[\"origin\", \r\n\t\"velocity\", \r\n\t\"dispersion\",\r\n\t\"speed\"]);\r\n\t\r\n\treturn data;\r\n}\r\n\r\nCone_Emitter.prototype.parse = function (data)\r\n{\r\n\t__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype.parse.call(this, data);\r\n\tthis.origin.copy(data.origin);\r\n\tthis.velocity.copy(data.velocity);\r\n\tthis.set_dispersion(data.dispersion.min, data.dispersion.max);\r\n\tthis.set_speed(data.speed.min, data.speed.max);\r\n}\r\n\r\nCone_Emitter.prototype.set_speed = function (min, max)\r\n{\r\n\tthis.speed.min = min;\r\n\tthis.speed.max = max;\r\n\tthis.speed.delta = max - min;\r\n}\r\n\r\n\r\nCone_Emitter.prototype.set_dispersion = function (min, max)\r\n{\r\n\tthis.dispersion.min = min;\r\n\tthis.dispersion.max = max;\r\n\tthis.dispersion.delta = max - min;\r\n}\r\n\r\n\r\n\r\n\r\nCone_Emitter.prototype.emit = function (p, color, matrix)\r\n{\r\n\tp.position.copy(this.origin);\r\n\t\r\n\tthis.generator.get_direction(p.velocity);\r\n\tp.velocity.multiplyScalar(Math.random()*this.dispersion.delta + this.dispersion.min);\t\r\n\tp.velocity.add(this.velocity).normalize();\r\n\t\r\n    if (matrix) {\r\n        p.position.applyMatrix4(matrix);\r\n        p.velocity.applyMatrix4_rotation(matrix);\r\n    }\r\n        \r\n\tp.velocity.multiplyScalar(Math.random()*this.speed.delta + this.speed.min);\t\r\n\t\r\n    \r\n\tif (color) {\r\n\t\tthis.emit_color(color);\r\n\t}\r\n    \r\n}\r\n\r\nCone_Emitter.prototype.emit_color = function (color) \r\n{\r\n\tcolor.copy(this.color);\r\n}\r\n\r\nfunction Sphere_Emitter(radius, speed)\r\n{\r\n\t__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].call(this);\r\n\tthis.radius = radius || 1;\r\n    this.speed = speed || 1;\r\n\tthis.generator = new __WEBPACK_IMPORTED_MODULE_1__point_generators_js__[\"a\" /* Point_Generators */].Sphere(radius);\r\n    this.from_center = true;\r\n    Object.defineProperty(this, 'radius', {\r\n        configurable: true,\r\n        enumerable: true,\r\n        set: function (value) { radius = value; generator.radius = value;}\r\n    });\r\n}\r\n\r\nSphere_Emitter.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype);\r\n\r\n_.copy_object(Sphere_Emitter.prototype, {\r\n    constructor: Sphere_Emitter,\r\n    emit: function (p, color, matrix)\r\n    {\r\n        if (this.from_center) {\r\n            p.position.set(0,0,0);\r\n        } else {\r\n            this.generator.get_point(p.position);\r\n        }\r\n        this.generator.get_normal(p.velocity);\r\n        if (matrix) {\r\n            p.position.applyMatrix4(matrix);\r\n            p.velocity.applyMatrix4_rotation(matrix);\r\n        }\r\n        p.velocity.multiplyScalar(this.speed);\r\n    },\r\n    toJSON: function (json) {\r\n\t\tvar params = __WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype.toJSON.call(this, this);\r\n        params.radius = this.radius;\r\n        params.speed = this.speed;\r\n        //params.generator.radius = this.radius;\r\n    },\r\n    parse: function (json) {\r\n\t\t__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype.parse.call(this, json);\r\n        this.radius = json.radius;\r\n        this.speed = json.speed;\r\n    }\r\n});\r\n\r\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Sphere_Emitter\", Sphere_Emitter);\r\n\r\n\r\nfunction Star_Dust_Emitter ()\r\n{\r\n\t__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].apply(this, arguments);\r\n\tthis.start_position = new THREE.Vector3(0, 0, 0);\r\n\tthis.end_position = new THREE.Vector3(1, 1, 1);\r\n\tthis.delta = new THREE.Vector3(1, 1, 1);\t\r\n\tthis.velocity = new THREE.Vector3(0, 0, 1);\r\n}\r\n\r\nStar_Dust_Emitter.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype);\r\nStar_Dust_Emitter.prototype.constructor = Star_Dust_Emitter;\r\n_.copy_object( Star_Dust_Emitter.prototype,{\r\n\tset_velocity: function (x,y, z) \r\n\t{\r\n\t\tthis.velocity.set(x, y, z);\r\n\t},\r\n\tset_position_range : function (start, end)\r\n\t{\r\n\t\tthis.start_position.copy(start);\r\n\t\tthis.end_position.copy(end);\r\n\t\tthis.delta.set(end.x - start.x, end.y-start.y, end.z-start.z);\r\n\t\t\r\n\t},\r\n\tget_position: function (vector)\r\n\t{\r\n\t\tvector.x = Math.random() * this.delta.x + this.start_position.x;\r\n\t\tvector.y = Math.random() * this.delta.y + this.start_position.y;\r\n\t\tvector.z = Math.random() * this.delta.z + this.start_position.z;\r\n\t},\r\n\tget_velocity: function (vector)\r\n\t{\r\n\t\tvector.x = this.velocity.x;\r\n\t\tvector.y = this.velocity.y;\r\n\t\tvector.z = this.velocity.z;\r\n\t},\r\n\temit: function (p)\r\n\t{\r\n\t\tthis.get_position(p.position);\r\n\t\tif (this.parent) {\r\n\t\t\tthis.parent.localToWorld(p.position);\r\n\t\t}\r\n\t\tthis.get_velocity(p.velocity);\r\n\t},\r\n\ttoJSON: function ()\r\n\t{\r\n\t\tvar params = __WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype.toJSON.call(this, this);\r\n\t\t_.clone_field_list_one_level_recursion(this, params, [\"velocity\", \r\n\t\t\"start_position\",\r\n\t\t\"end_position\"])\r\n\t\tvar data = {\r\n\t\t\t\"name\": \"Star_Dust_Emitter\",\r\n\t\t\t\"params\": params,\r\n\t\t};\r\n\t\treturn data;\r\n\t},\r\n\tparse: function (json)\r\n\t{\r\n\t\t__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype.parse.call(this, json);\r\n\t\tthis.set_position_range(json.start_position, json.end_position);\r\n\t\tthis.velocity.copy(json.velocity);\r\n\t}\r\n\t\r\n});\r\n\r\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Star_Dust_Emitter\", Star_Dust_Emitter);\r\n\r\n\r\nfunction Star_Dust_Affector (end)\r\n{\r\n\tthis.end = end || 0;\r\n}\r\n\r\n\r\nStar_Dust_Affector.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_3__particle_affector_js__[\"a\" /* Particle_Affector */].prototype);\r\nStar_Dust_Affector.prototype.constructor = Star_Dust_Affector;\r\n\r\n_.copy_object(Star_Dust_Affector.prototype,{\r\n\taffect: function (dt, pdata, vert)\r\n\t{\r\n\t\tif (pdata.position.z > this.end) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\ttoJSON: function ()\r\n\t{\r\n\t\tvar params = __WEBPACK_IMPORTED_MODULE_3__particle_affector_js__[\"a\" /* Particle_Affector */].prototype.toJSON.call(this, this);\r\n\t\tparams[\"end\"] = this.end;\r\n\t\tvar data = {\r\n\t\t\t\"name\": \"Star_Dust_Affector\",\r\n\t\t\t\"params\": params,\r\n\r\n\t\t};\r\n\t\treturn data;\r\n\t},\r\n\tparse: function (json)\r\n\t{\r\n\t\t__WEBPACK_IMPORTED_MODULE_3__particle_affector_js__[\"a\" /* Particle_Affector */].prototype.parse(this, json);\r\n\t\tthis.end = json.end;\r\n\t}\r\n});\r\n\r\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Star_Dust_Affector\", Star_Dust_Affector);\r\n\r\n\n\n/***/ }),\n/* 24 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_event_hub_js__ = __webpack_require__(5);\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"main_event_hub\", function() { return __WEBPACK_IMPORTED_MODULE_0__base_event_hub_js__[\"a\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Event_Hub\", function() { return __WEBPACK_IMPORTED_MODULE_0__base_event_hub_js__[\"b\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__base_my_lib_js__ = __webpack_require__(0);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"My_Lib\", function() { return __WEBPACK_IMPORTED_MODULE_1__base_my_lib_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__base_animations_js__ = __webpack_require__(14);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Base_Animation\", function() { return __WEBPACK_IMPORTED_MODULE_2__base_animations_js__[\"a\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Euler_Animation\", function() { return __WEBPACK_IMPORTED_MODULE_2__base_animations_js__[\"b\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Scale_Animation\", function() { return __WEBPACK_IMPORTED_MODULE_2__base_animations_js__[\"c\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__base_mouse_intersector_js__ = __webpack_require__(6);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Mouse_Intersector\", function() { return __WEBPACK_IMPORTED_MODULE_3__base_mouse_intersector_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__base_mouse_camera_controller_js__ = __webpack_require__(3);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Mouse_Camera_Controller\", function() { return __WEBPACK_IMPORTED_MODULE_4__base_mouse_camera_controller_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__base_loading_manager_js__ = __webpack_require__(15);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Loading_Manager\", function() { return __WEBPACK_IMPORTED_MODULE_5__base_loading_manager_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__base_package_manager_js__ = __webpack_require__(16);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Package_Manager\", function() { return __WEBPACK_IMPORTED_MODULE_6__base_package_manager_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__particles_particles_points_js__ = __webpack_require__(4);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Particles_Points\", function() { return __WEBPACK_IMPORTED_MODULE_7__particles_particles_points_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__particles_particle_emitter_js__ = __webpack_require__(2);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Particle_Emitter\", function() { return __WEBPACK_IMPORTED_MODULE_8__particles_particle_emitter_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__particles_forces_js__ = __webpack_require__(22);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Particle_Forces\", function() { return __WEBPACK_IMPORTED_MODULE_9__particles_forces_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__particles_particle_affector_js__ = __webpack_require__(1);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Particle_Affector\", function() { return __WEBPACK_IMPORTED_MODULE_10__particles_particle_affector_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__particles_point_generators_js__ = __webpack_require__(12);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Point_Generators\", function() { return __WEBPACK_IMPORTED_MODULE_11__particles_point_generators_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__particles_custom_emitter_js__ = __webpack_require__(21);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Custom_Emitter\", function() { return __WEBPACK_IMPORTED_MODULE_12__particles_custom_emitter_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__particles_custom_affector_js__ = __webpack_require__(20);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Custom_Affector\", function() { return __WEBPACK_IMPORTED_MODULE_13__particles_custom_affector_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__particles_test_emitters_js__ = __webpack_require__(23);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Cone_Emitter\", function() { return __WEBPACK_IMPORTED_MODULE_14__particles_test_emitters_js__[\"a\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Star_Dust_Emitter\", function() { return __WEBPACK_IMPORTED_MODULE_14__particles_test_emitters_js__[\"b\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Sphere_Emitter\", function() { return __WEBPACK_IMPORTED_MODULE_14__particles_test_emitters_js__[\"c\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Star_Dust_Affector\", function() { return __WEBPACK_IMPORTED_MODULE_14__particles_test_emitters_js__[\"d\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__particles_particle_shaders_js__ = __webpack_require__(9);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Particle_Shaders\", function() { return __WEBPACK_IMPORTED_MODULE_15__particles_particle_shaders_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__particles_particles_js__ = __webpack_require__(10);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Particle_System\", function() { return __WEBPACK_IMPORTED_MODULE_16__particles_particles_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__particles_particles_manager_js__ = __webpack_require__(11);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Particle_Manager\", function() { return __WEBPACK_IMPORTED_MODULE_17__particles_particles_manager_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__base_scene_serializer_js__ = __webpack_require__(17);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Scene_Serializer\", function() { return __WEBPACK_IMPORTED_MODULE_18__base_scene_serializer_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19__mixins_threejs_mixins_js__ = __webpack_require__(19);\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Mix_It\", function() { return __WEBPACK_IMPORTED_MODULE_19__mixins_threejs_mixins_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20__mixins_camera_mixin_js__ = __webpack_require__(18);\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Mixin\", function() { return __WEBPACK_IMPORTED_MODULE_20__mixins_camera_mixin_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21__app_application_js__ = __webpack_require__(13);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Application\", function() { return __WEBPACK_IMPORTED_MODULE_21__app_application_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22__particles_color_domain_js__ = __webpack_require__(8);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Color_Domain\", function() { return __WEBPACK_IMPORTED_MODULE_22__particles_color_domain_js__[\"a\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Table_Color\", function() { return __WEBPACK_IMPORTED_MODULE_22__particles_color_domain_js__[\"b\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23__base_simple_collider_js__ = __webpack_require__(7);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"Simple_Collider\", function() { return __WEBPACK_IMPORTED_MODULE_23__base_simple_collider_js__[\"a\"]; });\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// engine.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 24);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 55cbc58a5748dca1990a","/*\r\n*/\r\n\r\n\r\nvar My_Lib = {};\r\n\r\nMy_Lib.Viewport = {};\r\n\r\n\r\nMy_Lib.Object_Animation = function (object, animation)\r\n{\r\n\tthis.object = object;\r\n\tthis.animation = animation;\r\n}\r\n\r\nMy_Lib.Object_Animation.prototype.update = function (dt)\r\n{\r\n\tthis.animation(this.object, dt);\r\n}\r\n\r\nMy_Lib.create_text_image = function (width, height, text, npot, background) \r\n{\r\n\t// create a canvas element\r\n\tvar canvas = document.createElement('canvas');\r\n\tcanvas.width = width;\r\n\tcanvas.height = height;\r\n\tvar context = canvas.getContext('2d');\r\n\tif (background) \r\n\t{\r\n\t\tcontext.fillStyle = background;\r\n\t\tcontext.fillRect(0, 0, canvas.width, canvas.height);\r\n\t}\r\n\tcontext.font = \"Bold 40px Arial\";\r\n\tcontext.fillStyle = \"rgba(0,255,0,0.95)\";\r\n    context.fillText('Hello, world!', 0, 50);\r\n    \r\n\t// canvas contents will be used for a texture\r\n\tvar texture = new THREE.Texture(canvas) \r\n\tif (npot) {\r\n\t\ttexture.wrapS = texture.wrapT = THREE.TextureWrapping.ClampToEdgeWrapping;\r\n\t\ttexture.minFilter = THREE.LinearFilter;\r\n\t}\r\n\ttexture.needsUpdate = true; \t\r\n\treturn texture;\r\n}\r\n\r\n\r\nMy_Lib.Create_Quad = function (width, height, vertex_shader, fragment_shader)\r\n{\r\n\t//plane created turn away from camera\r\n\tvar plane = new THREE.PlaneBufferGeometry( width, height);\r\n\t\r\n\tvar material = new THREE.ShaderMaterial( {\r\n\t\tvertexShader: vertex_shader,\r\n\t\tfragmentShader: fragment_shader\r\n\t} ); \r\n\r\n\tvar quad = new THREE.Mesh( plane, material );\r\n\tquad.rotation.y = Math.PI;\r\n\treturn quad;\r\n}\r\n\r\n\r\nMy_Lib.Render_Target = function (width, height)\r\n{\r\n\tthis.target = new THREE.WebGLRenderTarget( \r\n\twidth, \r\n\theight, \r\n\t{ \r\n\t\tminFilter: THREE.LinearFilter, \r\n\t\tmagFilter: THREE.NearestFilter, \r\n\t\tformat: THREE.RGBFormat \r\n\t} ); \r\n\t\r\n\tthis.camera = new THREE.PerspectiveCamera(80, width/height, 0.1, 1000);\r\n}\r\n\r\nMy_Lib.Render_Target.prototype.render = function (scene, renderer)\r\n{\r\n\trenderer.render( scene, \r\n\t\tthis.camera, \r\n\t\tthis.target, \r\n\t\ttrue  //forceClear\r\n\t\t);\r\n}\r\n\r\n\r\nMy_Lib.create_overlay_camera = function (width, height)\r\n{\r\n\tvar camera =  new THREE.OrthographicCamera( \r\n\t\twidth / - 2, \r\n\t\twidth / 2, \r\n\t\theight / 2, \r\n\t\theight /- 2, -10000, 10000 );\r\n\treturn camera;\r\n}\r\n\r\nMy_Lib.Overlay = function (width, height)\r\n{\r\n\tthis.camera = My_Lib.create_overlay_camera(width, height);\r\n}\r\n\r\nMy_Lib.Overlay.prototype.render = function (renderer)\r\n{\r\n\tif (!this.scene) {\r\n\t\treturn;\r\n\t}\r\n\t\r\n\trenderer.autoClear = false;\r\n\trenderer.render(this.scene, this.camera);\r\n\trenderer.autoClear = true;\r\n}\r\n\r\n\r\nMy_Lib.Mouse_Controller = function (root, over, click, callback)\r\n{\r\n\tthis.root = root;\r\n\tthis.over = over;\r\n\tthis.click = !!click;\r\n\tthis.callback = callback;\r\n}\r\n\r\n\r\n\r\n/*\r\nugly hack\r\n*/\r\n\r\nMy_Lib.event_hub = new Event_Hub();\r\n\r\nfunction Event_Hub() {\r\n    this.events = {};\r\n}\r\n\r\n\r\n\r\nEvent_Hub.prototype.add_event_listener = function (name, func, obj)\r\n{\r\n    if (!this.events[name]) {\r\n        this.events[name] = [];\r\n    }\r\n    this.events[name].push( {name: name, func: func, obj: obj} );\r\n}\r\n\r\nEvent_Hub.prototype.on  = Event_Hub.prototype.add_event_listener;\r\n\r\nEvent_Hub.prototype.emit = function(name, obj)\r\n{\r\n    var listeners = this.events[name];\r\n    if (listeners) {\r\n        for(var i = 0; i < listeners.length; i++) {\r\n            var t = listeners[i];\r\n            t.func.call(t.obj, obj);            \r\n        }\r\n    }\r\n}\r\n\r\n\r\nvar run_function = //window.requestAnimationFrame;\r\n\tfunction(callback){\r\n\t\twindow.setTimeout(callback, 1000 / 60);\r\n\t}\r\n\r\n\r\nMy_Lib.create_run_function = function (app) \r\n{\r\n    My_Lib.run = function () { run_function( function () { app.loop(); }); }\r\n}\r\n\r\n\r\n\r\n\r\nMy_Lib.Euler_Controller = function (obj, x, y, z)\r\n{\r\n\tthis.obj = obj;\r\n\tthis.xspeed = x * Math.PI / 180;;\r\n\tthis.yspeed = y * Math.PI / 180;;\r\n\tthis.zspeed = z * Math.PI / 180;;\r\n}\r\n\r\nMy_Lib.Euler_Controller.prototype.update = function (dt)\r\n{\r\n\tthis.obj.rotation.x += this.xspeed * dt;\r\n\tthis.obj.rotation.y += this.yspeed * dt;\r\n\tthis.obj.rotation.z += this.zspeed * dt;\r\n}\r\n\r\n//Class Library\r\nMy_Lib.Registered_Classes = {};\r\n\r\nMy_Lib.Register_Class = function (name, func)\r\n{\r\n\tif (My_Lib.Registered_Classes[name]){\r\n\t\tconsole.log(\"Register Class ERROR! Class with this name already exists!\", name);\r\n\t}\r\n\tMy_Lib.Registered_Classes[name] = func;\r\n}\r\n\r\nMy_Lib.Get_Class = function (name)\r\n{\r\n\treturn My_Lib.Registered_Classes[name];\r\n}\r\n\r\n\r\nMy_Lib.create_class = function(parent, child, props, name)\r\n{\r\n    if (parent) {\r\n        child.prototype = Object.create(parent.prototype);\r\n    } \r\n    _.copy_object(child.prototype, props);\r\n    child.prototype.contructor = child;                \r\n    My_Lib.Register_Class(child, name);\r\n}\r\n\r\nMy_Lib.Abstract_Fabric = function (data)\r\n{\r\n    var constructor = My_Lib.Get_Class(data.type);\r\n    if (constructor) {\r\n        var object = new constructor();\r\n        object.parse(data);\r\n        return object;\r\n    }\r\n    return undefined;\r\n}\r\n\r\nMy_Lib.Print_Classes = function ()\r\n{\r\n    for(var key in this.Registered_Classes) {\r\n        console.log(\"class registered :\", key, this.Registered_Classes[key]);\r\n    }\r\n}\r\n\r\n\r\nexport { My_Lib };\r\n\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/base/my_lib.js\n// module id = 0\n// module chunks = 0","import {My_Lib} from '../base/my_lib.js';\r\n\r\n//base class for particle affector\r\nfunction Particle_Affector()\r\n{\r\n    this.id = _.generateUUID();\r\n}\r\n\r\n\r\nParticle_Affector.prototype.affect = function (dt, pdata, vert, color)\r\n{\r\n\treturn true;\r\n}\r\n\r\nParticle_Affector.prototype.toJSON = function (child)\r\n{\r\n\tif (child) {\r\n\t\treturn {};\r\n\t}\r\n\tvar data = {\r\n        id: this.id,\r\n\t\t\"name\": \"Particle_Affector\",\r\n\t\tparams : {}\r\n\t};\r\n    if (child) {\r\n        return params;\r\n    }\r\n\treturn data;\r\n}\r\n\r\nParticle_Affector.prototype.parse = function (json)\r\n{\r\n}\r\n\r\nMy_Lib.Register_Class(\"Particle_Affector\", Particle_Affector);\r\n\r\nfunction Force_Affector()\r\n{\r\n    Particle_Affector.call(this);\r\n\tthis.forces = new Array();\r\n}\r\n\r\nForce_Affector.prototype = Object.create(Particle_Affector.prototype);\r\n\r\n_.copy_object(Force_Affector.prototype, {\r\n\tconstructor: Force_Affector,\r\n\tadd_force: function (force)\r\n\t{\r\n\t\tthis.forces.push(force);\r\n\t},\r\n\tapply_forces: function (dt, particle, vert, color)\r\n\t{\r\n\t\tvar acceleration = {x:0, y:0, z:0};\r\n\t\tfor(var i = 0; i < this.forces.length; i++) {\r\n\t\t\tthis.forces[i].calc(dt, particle, acceleration);\r\n\t\t}\r\n\t\t//integrate\r\n\t\tparticle.velocity.x += acceleration.x * dt;\r\n\t\tparticle.velocity.y += acceleration.y * dt;\r\n\t\tparticle.velocity.z += acceleration.z * dt;\r\n\t},\r\n\taffect: function (dt, particle, vert, color)\r\n\t{\r\n\t\tthis.apply_forces(dt, particle, vert, color);\r\n\t\treturn true;\r\n\t},\r\n\ttoJSON: function (child)\r\n\t{\r\n\t\tvar data = {};\r\n\t\tdata.name = \"Force_Affector\";\t\t\r\n        data.uuid = this.uuid;\r\n\t\tdata.params = Particle_Affector.prototype.toJSON.call(this, this);\r\n\t\tif (this.forces.length > 0) {\r\n\t\t\tdata.params.forces = new Array();\r\n\t\t\tfor(var i = 0; i < this.forces.length; i++) {\r\n\t\t\t\tdata.params.forces.push( this.forces[i].toJSON() );\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn data;\r\n\t},\r\n\tparse: function (json)\r\n\t{\r\n\t\tvar f, item;\r\n\t\tif (json.forces) {\r\n\t\t\t\t\r\n\t\t\tfor(var i =0; i < json.forces.length; i++) {\r\n\t\t\t\titem = json.forces[i];\r\n\t\t\t\tf = My_Lib.Get_Class(item.name);\r\n\t\t\t\tif (f) {\r\n\t\t\t\t\tf = new f();\r\n\t\t\t\t\tf.parse(item);\r\n\t\t\t\t\tthis.add_force(f);\r\n\t\t\t\t} \r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\nMy_Lib.Register_Class(\"Force_Affector\", Force_Affector);\r\n\r\nexport { Particle_Affector, Force_Affector };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/particles/particle_affector.js\n// module id = 1\n// module chunks = 0","import {My_Lib} from '../base/my_lib.js';\r\n\r\n//Base class for Particle Emitters\r\nfunction Particle_Emitter(emit_per_second)\r\n{\r\n    this.uuid = _.generateUUID();\r\n    this.name = '';\r\n\tthis.emit_delta = 0;\r\n\tthis.emit_count = 0;\r\n\tthis.emit_per_second = emit_per_second || 5;\r\n\t//linear interpolation = min + random * (max-min)\t\r\n\tthis.lifetime = {\"min\": 0, \"max\":2.0};\r\n}\r\n\r\nParticle_Emitter.prototype.emit_life = function ()\r\n{\r\n\treturn this.lifetime.min + Math.random() * (this.lifetime.max - this.lifetime.min);\r\n}\r\n\r\nParticle_Emitter.prototype.calc_emitted_particles = function (dt)\r\n{\r\n\t//count particles need emit\r\n\tthis.emit_delta += this.emit_per_second*dt;\r\n\tvar need_emit = Math.floor(this.emit_delta);\r\n\tif (need_emit > 0) {\r\n\t\tthis.emit_delta -= need_emit;\r\n\t\t//this.emit_count += need_emit;\r\n\t\t//need_emit = this.emit_count;\r\n\t}\r\n\treturn need_emit;\r\n}\r\n\r\n\r\nParticle_Emitter.prototype.emit = function (p, c, matrix)\r\n{\r\n    p.position.set(0, 0, 0);\r\n    p.velocity.set(0, 1, 0);\r\n    \r\n    if (matrix) {\r\n        p.position.applyMatrix4(matrix);\r\n        p.velocity.applyMatrix4_rotation(matrix);\r\n    }\r\n}\r\n\r\n\r\nParticle_Emitter.prototype.toJSON = function (child)\r\n{\r\n\tvar params = {\r\n        \"uuid\": this.uuid,\r\n\t\t\"emit_per_second\": this.emit_per_second,\r\n\t\t\"lifetime\": {\r\n\t\t\t\"min\": this.lifetime.min,\r\n\t\t\t\"max\": this.lifetime.max\r\n\t\t},\r\n\t};\r\n    if (this.name) {\r\n        params.name = this.name;\r\n    }\r\n\tif (child) {\r\n\t\treturn params;\r\n\t}\r\n\tvar data = {};\r\n\tdata.name = \"Particle_Emitter\";\r\n\tdata.params = params;\t\r\n\treturn data;\r\n}\r\n\r\nParticle_Emitter.prototype.parse = function (data)\r\n{\r\n\tthis.emit_per_second = data.emit_per_second;\r\n    this.name = data.name;\r\n    this.uuid = data.uuid || _.generateUUID();\r\n\t_.copy_object(this.lifetime, data.lifetime);\r\n}\r\n\r\nMy_Lib.Register_Class(\"Particle_Emitter\", Particle_Emitter);\r\n\r\nexport { Particle_Emitter };\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/particles/particle_emitter.js\n// module id = 2\n// module chunks = 0","//Unfortunately, canvas properties can change permanenty. \r\n//Because, you need do refresh_canvas on each call!\r\n//each time you need recacl BoundingRect and clientRect of the fucking canvas\r\n//also, camera may be not that camera, who render scene. it may be other camera\r\n//because you need refresh camera on eash call\r\n//i could done this normal function, but this object may do different job\r\n//this is single-time object\r\n//it easy economyfy number of arguments on calling functions\r\n\r\n//not, this class doesn't store reference to canvas, \r\n//this store only information about canvas size and position \r\n//i.e. BoundingClientRect and clientWidth,clientHeight\r\n//yes, this class store reference to camera\r\n\r\n//probably, it may be mixin to camera\r\n\r\n\r\nfunction Mouse_Camera_Controller(canvas, camera)\r\n{\r\n    if (canvas === undefined) {\r\n        console.error(\"Mouse_Camera_Controller. Propable premordial creating object. canvas is undefined. Do nothing\");\r\n    } else {\r\n        this.set_canvas_info(canvas);\r\n    }\r\n    this.camera = camera;\r\n}\r\n\r\n_.copy_object(Mouse_Camera_Controller.prototype,{\r\n    constructor : Mouse_Camera_Controller,\r\n    set_canvas_info: function (canvas)\r\n    {\r\n        var offset = canvas.getBoundingClientRect();\r\n        this.offset = \r\n        {\r\n            left: offset.left,\r\n            top : offset.top\r\n        };\r\n        this.width = canvas.clientWidth;\r\n        this.height = canvas.clientHeight;\r\n    },\r\n    refresh_canvas: function (new_canvas)\r\n    {\r\n        this.set_canvas_info(new_canvas);\r\n    }\r\n    ,\r\n    get_normalized_screen_coordinates: function (x,y)\r\n    {\r\n        //step 1 : normalized\r\n        x = (x - this.offset.left) / this.width;\r\n        y = (y - this.offset.top) / this.height;\r\n        //step 2 : from unsigned to signed, translate origin from top left corner to center \r\n        var x = x * 2.0 - 1.0;\r\n        var y = -(y * 2.0 - 1.0);\r\n        var vector = new THREE.Vector3( x, y, 1 );\r\n        return vector;        \r\n    },\r\n    \r\n    //do some what prevent method, only give mouse event instead x,y coordiantes\r\n    get_normalize_mouse_position: function (event) \r\n    {\r\n        return this.get_normalized_screen_coordinates(event.clientX, event.clientY);\r\n    },\r\n    \r\n    //return new unproject vector, not change given\r\n    //used THREE.Vector3.unproject method\r\n    //including apply inver camera matrix\r\n    //on my view, that wrong, because method do it big then promise\r\n    //unproject must do only unproject, not else thing\r\n    //because my need new method, who will do only unproject \r\n    unproject: function(vector)\r\n    {\r\n        var r = new THREE.Vector3();\r\n        r.copy(vector);\r\n        r.unproject(this.camera);\r\n        //this aready done \r\n        //r.applyMatrix4(camera.matrixWorldInverse);    \r\n        return r;\r\n    },\r\n    \r\n    \r\n    //get ray with origin in camera position and direction, \r\n    //pointed to far away where unproject screen point are\r\n    get_ray_from_camera_in_screen_coordinates: function (x,y) \r\n    {\r\n        var vector = this.get_normalized_screen_coordinates(x,y);\r\n        vector = this.unproject(vector);\r\n        var ray = new THREE.Ray( this.camera.position, vector.sub( this.camera.position ).normalize() );\r\n        return ray;\r\n    },\r\n    \r\n    //do same what prevent method, only give mouse event for convience\r\n    //see it as overriding function in C++\r\n    get_ray_from_camera_in_mouse_position: function (event)\r\n    {\r\n        return this.get_ray_from_camera_in_screen_coordinates(event.x, event.y);\r\n    },\r\n\r\n\r\n});\r\n\r\n\r\nexport { Mouse_Camera_Controller };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/base/mouse_camera_controller.js\n// module id = 3\n// module chunks = 0","    \r\nfunction Particles_Points (geometry, material)\r\n{\r\n    THREE.Points.call(this, geometry, material);\r\n    this.type = 'particles_points';\r\n    \r\n    this.boundingSphere = new THREE.Sphere();\r\n    this.boundingSphere.radius = 10.0;\r\n}\r\n\r\nParticles_Points.prototype = Object.create( THREE.Points.prototype )\r\n\r\nParticles_Points.prototype.constructor = Particles_Points;\r\n\r\nParticles_Points.prototype.getBoundingSphere = function()\r\n{\r\n    return this.boundingSphere;\r\n}\r\n\r\nParticles_Points.prototype.toJSON = function (meta)\r\n{\r\n    var mat = this.material;\r\n    var geom = this.geometry;\r\n    this.material = undefined;\r\n    this.geometry = undefined;\r\n    var object =  THREE.Object3D.prototype.toJSON.call(this, meta);\r\n    this.material = mat;\r\n    this.geometry = geom;\r\n    return object;\r\n}\r\n\r\n//WTF?\r\nParticles_Points.prototype.raycast = function (raycaster, intersects)\r\n{\r\n    var sphere = new THREE.Sphere()\r\n    sphere.copy( this.boundingSphere );\r\n    sphere.applyMatrix4( this.matrixWorld ); \r\n    var r = raycaster.ray.intersectsSphere( sphere );\r\n    if ( r === false ) return;\r\n    console.log(\"INTERSECTION1\", this.name, sphere);\r\n    return;\r\n    \r\n    var shit  = new THREE.Vector3();\r\n    shit.copy(this.position);\r\n    var tr = new THREE.Ray( new THREE.Vector3(0, 0, 20), shit);\r\n    console.log(\"test \", tr.intersectsSphere(sphere), sphere);\r\n    console.log(\"hit sphere \"  + this.name, sphere, raycaster.ray);\r\n    return raycaster.ray.intersectsSphere( sphere );\r\n    \r\n    \r\n    console.log(\"hit sphere \" + this.type, \"shpere is \", sphere, \"ray is \", r);\r\n    if (r) {\r\n            var tmp = new THREE.Vector3(this.position);\r\n            tmp.sub(r);\r\n   \t\t\tintersects.push( {\r\n\t\t\t\tdistance: Math.sqrt( tmp.dot(tmp) ),\r\n\t\t\t\tpoint: this.position,\r\n\t\t\t\tobject: this\r\n\t\t\t} ); \r\n    }\r\n}\r\n\r\n\r\nexport {Particles_Points};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/particles/particles_points.js\n// module id = 4\n// module chunks = 0","function Event_Hub() {\r\n    this.events = {};\r\n}\r\n\r\n\r\n\r\nEvent_Hub.prototype.add_event_listener = function (name, func, obj)\r\n{\r\n    if (!this.events[name]) {\r\n        this.events[name] = [];\r\n    }\r\n    this.events[name].push( {name: name, func: func, obj: obj} );\r\n}\r\n\r\nEvent_Hub.prototype.on  = Event_Hub.prototype.add_event_listener;\r\n\r\nEvent_Hub.prototype.emit = function(name, obj)\r\n{\r\n    var listeners = this.events[name];\r\n    if (listeners) {\r\n        for(var i = 0; i < listeners.length; i++) {\r\n            var t = listeners[i];\r\n            t.func.call(t.obj, obj);            \r\n        }\r\n    }\r\n}\r\n\r\nvar main_event_hub = new Event_Hub();\r\n\r\nexport {main_event_hub, Event_Hub};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/base/event_hub.js\n// module id = 5\n// module chunks = 0","var Mouse_Intersector = {};\r\n\r\nimport {Simple_Collider} from \"./simple_collider.js\";\r\nimport {Mouse_Camera_Controller} from './mouse_camera_controller.js';\r\n\r\n\r\nMouse_Intersector.get_normalized_screen_coords = function (canvas, x, y)\r\n{\r\n\tvar offset = canvas.getBoundingClientRect();\r\n\tvar width = canvas.clientWidth;\r\n\tvar height = canvas.clientHeight;\r\n    //normalize coordinates\r\n    var x = (x - offset.left) / width;\r\n    var y = (y - offset.top) / height;\r\n\tvar x = x * 2 - 1;\r\n\tvar y = -(y * 2 - 1);\r\n\tvar vector = new THREE.Vector3( x, y, 1 );\r\n\treturn vector;\r\n}\r\n\r\nMouse_Intersector.mouse_coords_to_vector = function (canvas, event) \r\n{\r\n    return this.get_normalized_screen_coords(canvas, event.clientX, event.clientY);\r\n}\r\n\r\n\r\nMouse_Intersector.unproject = function(vector, camera)\r\n{\r\n    var r = new THREE.Vector3();\r\n    r.copy(vector);\r\n\tr.unproject(camera);\r\n    //this done yet\r\n    //r.applyMatrix4(camera.matrixWorldInverse);    \r\n    return r;\r\n}\r\n\r\nMouse_Intersector.mouse_coords_to_ray = function (canvas, event, camera) \r\n{\r\n    var vector = this.mouse_coords_to_vector(canvas, event);\r\n    vector = this.unproject(vector, camera);\r\n\tvar ray = new THREE.Ray( camera.position, vector.sub( camera.position ).normalize() );\r\n\treturn ray;\r\n}\r\n\r\n\r\n\r\nMouse_Intersector.find_intersection_with_mouse_vector = function(vector, camera, scene)\r\n{\r\n\tvector.unproject(camera);\r\n\tvar ray = new THREE.Raycaster( camera.position, vector.sub( camera.position ).normalize() );\r\n\t// create an array containing all objects in the scene with which the ray intersects\r\n\t//var intersects = ray.intersectObjects( [grid_text.root], true ); \r\n\t//console.log(fake_plane.root.children[0].geometry);\r\n\tvar intersects = ray.intersectObjects( [scene], true ); \r\n\treturn intersects;\r\n}\r\n\r\n\r\nMouse_Intersector.find_intersected_object = function (scene, ray)\r\n{\r\n\r\n    var collider = new Simple_Collider(scene);\r\n    var intersects = collider.check_ray(ray);\r\n    return intersects;\r\n}\r\n\r\n\r\nexport { Mouse_Intersector };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/base/mouse_intersector.js\n// module id = 6\n// module chunks = 0","function Simple_Collider(root, params)\r\n{\r\n    this.root = root;\r\n    if (params === undefined) {\r\n        params = {};\r\n    }\r\n    this.params = \r\n    {\r\n        recursive: params.recursive === undefined ? true : params.recursive,\r\n        check_invisible: params.check_invisible === undefined ? true : params.check_invisible \r\n    };\r\n    this.intersected_objects = [];\r\n    this._tested_sphere = new THREE.Sphere();    \r\n}\r\n\r\nSimple_Collider.prototype.prepare_check = function (ray)\r\n{\r\n    this.intersected_objects = [];\r\n    this.intersected_map = {};\r\n    this._fakecaster = {ray: ray};    \r\n}\r\n\r\nSimple_Collider.prototype.check_ray = function (ray)\r\n{\r\n    this.prepare_check(ray);\r\n    \r\n    this.find_intersection_with_bounding_sphere( this.root); \r\n    \r\n    return this.intersected_objects;\r\n}\r\n\r\nSimple_Collider.prototype.add_intersected = function (obj)\r\n{\r\n    if (!this.intersected_map[obj.uuid]) {\r\n        this.intersected_map[obj.uuid] = obj;\r\n        this.intersected_objects.push(obj);\r\n    }\r\n}\r\n\r\nSimple_Collider.prototype.check_object_bounding_sphere = function(obj)\r\n{\r\n    //get bounding sphere\r\n    if (obj.getBoundingSphere) {\r\n        this._tested_sphere.copy( obj.getBoundingSphere() );\r\n    } else if (obj.geometry)  {\r\n        //fuck this shit, why don't exists method getBoundingSphere, which encapsulates this?\r\n        if ( obj.geometry.boundingSphere === null ) obj.geometry.computeBoundingSphere();\r\n         //copy sphere from object geometry and transform it with object. matrixWorld\r\n        this._tested_sphere.copy( obj.geometry.boundingSphere );\r\n        //console.log(\"get bounding sphere\", this._tested_sphere);\r\n    } else {\r\n        return false;\r\n    }\r\n\r\n    //test bounding spere\r\n    obj.updateMatrixWorld(true);        \r\n    this._tested_sphere.applyMatrix4( obj.matrixWorld );\r\n    //find intersection\r\n    var inter = this._fakecaster.ray.intersectsSphere( this._tested_sphere );\r\n    //console.log(\"inter with sphere, level\", level, inter, sphere.center, raycaster.ray);\r\n    //add to intersected list, if success\r\n    if (inter) {\r\n        this.intersected_objects.push(obj);\r\n        return true;\r\n    } else {\r\n        return false;\r\n    }\r\n}\r\n\r\n\r\nSimple_Collider.prototype.find_intersection_with_bounding_sphere = function(object, top ) {\r\n\r\n    if ( !object.non_collideble && (object.visible || this.params.check_invisible)) {\r\n        this.check_object_bounding_sphere(object);\r\n    }\r\n    if ( !this.params.recursive) return;\r\n    \r\n    \r\n    //test children\r\n    var children = object.children;\r\n    for ( var i = 0; i < children.length; i ++ ) {\r\n        var child = children[i];\r\n        this.find_intersection_with_bounding_sphere( child );\r\n    }\r\n}\r\n\r\n\r\n\r\nexport {Simple_Collider};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/base/simple_collider.js\n// module id = 7\n// module chunks = 0","import {My_Lib} from '../base/my_lib.js';\r\n\r\nfunction Color_Domain(r,g,b)\r\n{\r\n    this.color = new THREE.Color(r,g,b);\r\n    this.uuid = _.generateUUID();\r\n    this.name = '';\r\n    this.type = \"Color_Domain\";\r\n}\r\n\r\n_.copy_object(Color_Domain.prototype, {\r\n    toJSON: function (child)\r\n    {\r\n        var data = {};\r\n        data.uuid = this.uuid;\r\n        if (this.name !== '') {\r\n            data.name = this.name;\r\n        }\r\n        data.type = this.type;\r\n        data.color = {r: this.color.r, g: this.color.g, b: this.color.b};\r\n        return ;\r\n    },\r\n    parse: function (json)\r\n    {\r\n        this.uuid = json.uuid;\r\n        if (json.name !== undefined) {\r\n            this.name = json.name;\r\n        }\r\n        if (json.color !== undefined) {\r\n            this.color.set(json.color.r, json.color.g, json.color.b);\r\n        }\r\n    },\r\n    emit: function (color)\r\n    {\r\n        color.r = this.color.r;\r\n        color.g = this.color.g;\r\n        color.b = this.color.b;\r\n    },\r\n    fill: function (color, offset) \r\n    {\r\n        color[offset+0] = this.color.r;\r\n        color[offset+1] = this.color.g;\r\n        color[offset+2] = this.color.b;\r\n    }\r\n});\r\n\r\nMy_Lib.Register_Class('Color_Domain', Color_Domain);\r\n\r\nfunction Table_Color(table)\r\n{\r\n    if (table !== undefined) {\r\n        this.copy_table(table);        \r\n    } else {\r\n        this.default_table();\r\n    }\r\n}\r\n\r\nTable_Color.prototype = Object.create(Color_Domain);\r\n\r\n_.copy_object(Table_Color.prototype, {\r\n    constructor: Table_Color,\r\n    copy_table: function (table)\r\n    {\r\n        this.table = new Array(table.length);\r\n        for(var i = 0; i < table.length; i++) {\r\n            this.table = new THREE.Color(table[i]);\r\n        }\r\n    },\r\n    emit: function (color)\r\n    {\r\n        var index = Math.ceil(Math.random() * this.table.length) % this.table.length;\r\n        var src = this.table[index];\r\n        color.r = src.r;\r\n        color.g = src.g;\r\n        color.b = src.b;\r\n    },\r\n    fill: function (color, offset) \r\n    {\r\n        var index = Math.ceil(Math.random() * this.table.length) % this.table.length;\r\n        var src = this.table[index];\r\n        color[offset] = src.r;\r\n        color[offset+1] = src.g;\r\n        color[offset+2] = src.b;\r\n    },\r\n    default_table: function ()\r\n    {\r\n        this.table = new Array(8);\r\n        this.table[0] = new THREE.Color(1, 0, 0);\r\n        this.table[1] = new THREE.Color(0, 1, 0);\r\n        this.table[2] = new THREE.Color(0, 0, 1);\r\n        this.table[3] = new THREE.Color(1, 0, 1);\r\n        this.table[4] = new THREE.Color(1, 1, 0);\r\n        this.table[5] = new THREE.Color(1, 0.4, 0.4);\r\n        this.table[6] = new THREE.Color(0.5, 0.7, 0.98);\r\n        this.table[7] = new THREE.Color(0.9, 0.4, 0.4);\r\n    },\r\n    get: function ()\r\n    {\r\n        var r = {r: 0, g: 0, b: 0};\r\n        this.emit(r);\r\n        return r;\r\n    }\r\n});\r\n\r\nMy_Lib.Register_Class(\"Table_Color\", Table_Color);\r\n\r\nexport {Color_Domain, Table_Color};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/particles/color_domain.js\n// module id = 8\n// module chunks = 0","var Particle_Shaders = {};\r\n\r\n(function () \r\n{\r\n\r\n//particle attributes:\r\n//position\r\n//color\r\n//left, size\r\nvar vertex_shader = [\r\n//'attribute vec4 position;',\r\n'attribute vec4 color;',\r\n'attribute float params;',\r\n'varying vec4 vcolor;',\r\n'uniform float lifetime;',\r\n'uniform float point_size;',\r\n'uniform vec2 screen_size;',\r\n'#ifndef DYNAMIC_COLORS',\r\n    'uniform vec3 particle_color;',\r\n'#endif',\r\n'void main () {',\r\n\t'gl_Position = projectionMatrix * viewMatrix * vec4( position, 1.0 );',\r\n'#ifdef DYNAMIC_COLORS',\r\n\t'vcolor.rgb = color.rgb;',\r\n'#else',\r\n    'vcolor.rgb = particle_color.rgb;',\r\n'#endif',\r\n'#ifdef NO_FADE_COLOR',\r\n\t'vcolor.a = 1.0;',\r\n'#else',\r\n\t//params contains life length which decreased by time\r\n\t'float tmp = params / lifetime;',\r\n\t'tmp = min(tmp, 1.0);',\t\r\n\t'vcolor.a = tmp;',\r\n'#endif',\r\n\t'float t =  screen_size.y* projectionMatrix[1][1] / gl_Position.w;',\r\n\t't = t * point_size;',\r\n\t'if (params > 0.0) {',\r\n\t\t'gl_PointSize = t;',\r\n\t'}',\r\n\t'else {',\r\n\t\t//'vcolor.a = 0.0;',\r\n\t\t'gl_PointSize = 0.0;',\r\n        'gl_Position.z = -1000.0;',\r\n\t'}',\r\n'}'\r\n];\r\n\r\nvar fragment_shader = [\r\n\t'varying vec4 vcolor;',\r\n\t'#ifdef PARTICLE_TEXTURE',\r\n\t\t'uniform sampler2D sprite;',\r\n\t'#endif',\r\n\t'void main() {',\r\n\t'#ifdef PARTICLE_TEXTURE',\r\n\t\t'vec4 tex = texture2D( sprite, gl_PointCoord );',\r\n\t\t'vec3 fragment_color = tex.rgb;',\r\n\t\t'fragment_color.rgb *= vcolor.rgb;',\r\n\t\t'float alpha = tex.a;',\t\r\n\t'#else',\r\n\t\t'vec3 fragment_color = vcolor.rgb;',\r\n\t\t'float alpha = 1.0;',\r\n\t'#endif',\r\n\t'#ifdef PRE_ALPHA',\r\n\t\t'fragment_color.rgb *= alpha;',\r\n\t'#endif',\r\n\t'#ifndef NO_FADE_COLOR',\r\n\t\t'float fragment_alpha = alpha * vcolor.a;',\r\n\t'#else',\r\n\t\t'float fragment_alpha = alpha;',\r\n\t'#endif',\r\n\t\t'gl_FragColor = vec4(fragment_color.rgb, fragment_alpha);',\r\n\t'}',\r\n];\r\n\r\nParticle_Shaders.vertex = vertex_shader.join( '\\n' );\r\nParticle_Shaders.fragment = fragment_shader.join( '\\n' );\r\n})();\r\n\r\nexport {Particle_Shaders};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/particles/particle_shaders.js\n// module id = 9\n// module chunks = 0","import {My_Lib} from '../base/my_lib.js';\r\nimport {Particle_Emitter} from './particle_emitter.js';\r\nimport {Particle_Affector} from './particle_affector.js';\r\nimport {Particles_Points} from './particles_points.js';\r\nimport {Particle_Shaders} from './particle_shaders.js';\r\nimport {Color_Domain} from './color_domain.js';\r\n\r\n\r\nfunction Particle_System(data)\r\n{\r\n    this.uuid = _.generateUUID();    \r\n    \r\n    this.params = this.config_params(data);\r\n\r\n  \r\n\tthis.emitter = this.params.emitter;\r\n\tthis.affector = this.params.affector;    \r\n    this.particle_lifetime = this.params.particle_lifetime;\r\n    this.texture = this.params.texture;\r\n\t\r\n\tthis.dynamic_color = false;\r\n\r\n\tvar count = this.params.count;\r\n\t\r\n\tthis.material = this.create_particle_material();\r\n\tthis.node = new Particles_Points(this.create_particle_geometry(count), this.material);\r\n    this.node.name = this.name;\r\n    this.node.boundingSphere.radius = this.params.bounding_radius;\r\n    this.node.non_collideble = this.params.non_collideble;\r\n    \r\n}\r\n\r\n\r\nParticle_System.prototype.config_params = function (data)\r\n{\r\n    var params = \r\n    {\r\n    };\r\n    //default\r\n    params.particle_lifetime = 3.0;\r\n    params.no_fade_color = false;\r\n    params.pre_alpha = true;\r\n    params.depth_test = true;\r\n    params.depth_write = false;\r\n    params.color  = {\"r\":1, \"g\":1, \"b\":1};\r\n\tparams.blending = \"one_alpha\";\r\n    params.size = 1;\r\n    params.count = 100;\r\n    params.name = '';\r\n    params.bounding_radius = 2.0;\r\n    params.discrete_emission = false;\r\n    params.apply_world_matrix_on_emit = true;\r\n    params.non_collideble = false;\r\n    \r\n    for(var key in data) {\r\n        if (Object.prototype.hasOwnProperty.call(data, key)){\r\n            if (data[key] !== undefined) {\r\n                params[key] = data[key];\r\n            }\r\n        }\r\n    }\r\n    \r\n\tparams.emitter = data.emitter || new Particle_Emitter(1);\r\n\tparams.affector = data.affector || new Particle_Affector();\r\n    \r\n    return params;\r\n}\r\n\r\nParticle_System.prototype.set_name = function (name)\r\n{\r\n    this.name = name;\r\n    this.node.name = name;\r\n}\r\n\r\nParticle_System.prototype.suicide = function ()\r\n{\r\n\tthis.node.parent.remove(this.node);\r\n    main_event_hub.emit(\"kill_me\", this);\r\n}\r\n\r\n\r\nParticle_System.prototype.create_particle_data = function (count)\r\n{\r\n    var particle_data = new Array(count);\r\n    var p;\r\n    //var matrix = this.node.worldMatrix();\r\n    for(var i =0;i < count; i++) {\r\n\t\tp = {};\r\n\t\tp.position = new THREE.Vector3(0,0,0);\r\n\t\tp.velocity = new THREE.Vector3(0,0,0);\r\n        \r\n        //p.position.copy(this.node.position);\r\n        //p.position.applyMatrix4(matrix);\r\n        //p.velocity.applyMatrix4_rotation(matrix);\r\n        \r\n\t\tp.lifetime = 0;        \r\n\t\tparticle_data[i] = p;\r\n    }\r\n    this.particle_data = particle_data;\r\n}\r\n\r\nParticle_System.prototype.create_particle_geometry = function(count)\r\n{\r\n    this.create_particle_data(count);\r\n    \r\n\tvar vertices = new Float32Array(count * 3); // position\r\n\tvar colors = new Float32Array(count * 3);\r\n\tvar params = new Float32Array(count);\r\n\t\r\n    var particle;\r\n    for (var i = 0; i < count; i++) {\r\n        particle = this.particle_data[i];\r\n\t\t//create particle\r\n\t\tvertices[i*3] = particle.position.x;\r\n\t\tvertices[i*3+1] = particle.position.y;\r\n\t\tvertices[i*3+2] = particle.position.z;\r\n\r\n\t\tparams[i] = 0.0;\r\n        \r\n        if (this.params.color_domain) {\r\n            this.params.color_domain.fill(colors, i*3);\r\n        } else {\r\n            colors[i*3] = this.params.color.r;\r\n            colors[i*3+1] = this.params.color.g;\r\n            colors[i*3+2] = this.params.color.b;\r\n       }\r\n\t}\r\n\r\n\tthis.geometry = {};\r\n\tthis.geometry.vertices = new THREE.BufferAttribute(vertices, 3).setDynamic(true);\r\n\tthis.geometry.colors = new THREE.BufferAttribute(colors, 3)\r\n\tif (this.dynamic_color) {\r\n\t\tthis.geometry.colors.setDynamic(true);\r\n\t}\r\n\tthis.geometry.params = new THREE.BufferAttribute(params, 1).setDynamic(true);\r\n\tvar geom = new THREE.BufferGeometry(); \t\r\n\tthis.geometry.buffer = geom;\t\r\n\tgeom.addAttribute('position', this.geometry.vertices);\r\n\tgeom.addAttribute('color', this.geometry.colors);\r\n\tgeom.addAttribute('params', this.geometry.params);\t\r\n\r\n    return geom;\r\n}\r\n\r\n\r\nParticle_System.prototype.discrete_emit = function (count)\r\n{\r\n    this.emit_particles(0, count);\r\n\tthis.geometry.vertices.needsUpdate = true;\r\n\tthis.geometry.params.needsUpdate = true;\r\n\tthis.geometry.colors.needsUpdate = true;\r\n}\r\n\r\n\r\nParticle_System.prototype.emit_particles = function (dt, need_emit)\r\n{\r\n\t//emit particles\r\n\tvar p;\r\n\tvar verts = this.geometry.vertices.array;\r\n\tvar params = this.geometry.params.array;\r\n\t\r\n    var old_need_emit = need_emit;\r\n    this.node.updateMatrixWorld(true);\r\n    var matrix = this.node.matrixWorld;\r\n\tfor(var i =0; i < this.particle_data.length && need_emit > 0; i++) {\r\n\t\tif (!(params[i] > 0)) {\r\n        \r\n\t\t\tp = this.particle_data[i];\r\n\t\t\tthis.emitter.emit(p, null, matrix);\r\n\t\t\tp.lifetime = this.particle_lifetime;\r\n            \r\n\t\t\tverts[i*3] = p.position.x;\r\n\t\t\tverts[i*3+1] = p.position.y;\r\n\t\t\tverts[i*3+2] = p.position.z;\r\n\t\t\tparams[i] = p.lifetime;\r\n\t\t\tneed_emit--;\r\n\t\t\t//colors[i*3] = this.params.color.r\r\n\t\t\t//colors[i*3+1] = this.params.color.g;\r\n\t\t\t//colors[i*3+2] = this.params.color.b;\r\n\t\t}\r\n\t}\r\n    //console.log(\"created new particles \", old_need_emit - need_emit);\r\n}\r\n\r\nParticle_System.prototype.update_particle_geometry = function (dt)\r\n{\r\n\tvar verts = this.geometry.vertices.array;\r\n\tvar params = this.geometry.params.array;\r\n\tvar p;\r\n\tvar vert = new THREE.Vector3(0,0,0);\r\n\tvar dummy_color = {\"r\":1, \"b\":1, \"g\":1};\r\n\tfor(var i = 0; i < this.particle_data.length; i++) {\r\n\t\r\n\t\tif (params[i] > 0) {\r\n\t\t\tp = this.particle_data[i];\r\n\t\t\t\r\n\t\t\t//integrate\r\n\t\t\tp.position.x += p.velocity.x * dt;\r\n\t\t\tp.position.y += p.velocity.y * dt;\r\n\t\t\tp.position.z += p.velocity.z * dt;\r\n\t\t\tp.lifetime -= dt;\r\n\t\t\t\r\n\t\t\tif (p.lifetime <= 0 || !this.affector.affect(dt, p, vert, dummy_color)) {\r\n\t\t\t\tp.lifetime = 0;\r\n\t\t\t}\r\n\t\t\tparams[i] = p.lifetime;\t\t\t\r\n\t\t\tverts[i*3] = p.position.x;\r\n\t\t\tverts[i*3+1] = p.position.y;\r\n\t\t\tverts[i*3+2] = p.position.z;\r\n\t\t}\r\n\t}\r\n\r\n    if (!this.params.discrete_emission) {\r\n        var need_emit = this.emitter.calc_emitted_particles(dt);\r\n        this.emit_particles(dt, need_emit);\r\n    }\r\n\t\r\n\tthis.geometry.vertices.needsUpdate = true;\r\n\tthis.geometry.params.needsUpdate = true;\r\n\tthis.geometry.colors.needsUpdate = true;\r\n}\r\n\r\n\r\n\r\n\r\nParticle_System.prototype.update = function (dt)\r\n{\r\n\tthis.update_particle_geometry(dt);\r\n}\r\n\r\n\r\nParticle_System.prototype.generate_material_name = function ()\r\n{\r\n\tvar my_name = \"MY_PARTICLE_MATERIAL\";\r\n\tif (!!this.texture) {\r\n\t\tmy_name +=  \"_WITH_TEXTURE\";\r\n\t}\r\n\tif (this.params.no_fade_color) {\r\n\t\tmy_name += \"_NO_FADE_COLOR\";\r\n\t}\r\n\treturn my_name;\r\n}\r\n\r\nParticle_System.prototype.blending_mode = \r\n{\r\n\t\"additive\": {\r\n\t\t\"blendSrc\": THREE.OneFactor,\r\n\t\t\"blendDst\": THREE.OneFactor\r\n\t},\r\n\t\"alpha\": {\r\n\t\t\"blendSrc\": THREE.SrcAlphaFactor,\r\n\t\t\"blendDst\": THREE.OneMinusSrcAlphaFactor\r\n\t},\r\n\t\"one_alpha\": {\r\n\t\t\"blendSrc\": THREE.OneFactor,\r\n\t\t\"blendDst\": THREE.OneMinusSrcAlphaFactor\r\n\t},\r\n\t\"alpha_one\": {\r\n\t\t\"blendSrc\": THREE.SrcAlphaFactor,\r\n\t\t\"blendDst\": THREE.OneFactor\r\n\t}\r\n};\r\n\r\nParticle_System.prototype.convert_blending_mode = function (blending)\r\n{\r\n    var three_blending;\r\n\tvar factors = this.blending_mode[\"one_alpha\"];\r\n    if (blending === 'no') {\r\n        three_blending = THREE.NoBlending;\r\n    } else {\r\n        three_blending = THREE.CustomBlending;    \r\n        if (this.blending_mode[blending]) {\r\n            factors = this.blending_mode[blending];\r\n        }\r\n    }\r\n    return {\"blending\": three_blending, \"factors\":factors};\r\n}\r\n\r\nParticle_System.prototype.set_texture = function (texture)\r\n{\r\n\tif (typeof texture === 'string') {\r\n        if (this.params.texture === texture) {\r\n            return;\r\n        }\r\n        this.params.texture = texture;\r\n\t\tthis.texture = My_Lib.Texture_Manager.get(texture);\r\n\t} else {\r\n        console.error(\"Oh Shit! texture in set_texture is not string! it's object or undefined!\", texture);\r\n    }\r\n\r\n    if (this.material.uniforms.sprite) {\r\n        this.material.uniforms.sprite.value = this.texture;\r\n    } else {\r\n        //this.material.uniforms.sprite = {value: texture};\r\n        this.recreate_material();\r\n        console.error(\"Oh Shit! Our shader has not texture! Need create shader with texture!\");\r\n    }\r\n}\r\n\r\n\r\nParticle_System.prototype.create_uniforms = function ()\r\n{\r\n    var uniforms = \r\n    {\r\n        \"lifetime\": {\r\n            value: this.particle_lifetime\r\n        },\r\n        \"point_size\": {\r\n            value: this.params.size\r\n        },\r\n        \"screen_size\": {\r\n            value: new THREE.Vector2(My_Lib.Viewport.width, My_Lib.Viewport.height)\r\n        }\r\n    };\r\n    if (!!this.texture) {\r\n        uniforms[\"sprite\"] = {\r\n            value: this.texture\r\n        }\r\n    };\r\n    if (!this.dynamic_color) {\r\n        uniforms[\"particle_color\"] = {value: this.params.color};\r\n    }\r\n    return uniforms;\r\n}\r\n\r\nParticle_System.prototype.calc_defines = function ()\r\n{\r\n    var defines = {};\r\n    if (this.params.pre_alpha) {\r\n        defines[\"PRE_ALPHA\"] = true;\r\n    }\r\n\tif (!!this.texture) {\r\n        defines[\"PARTICLE_TEXTURE\"] = true;\r\n    }\r\n    if (this.params.no_fade_color) {\r\n        defines[\"NO_FADE_COLOR\"] = true;\r\n    }\r\n    if (this.params.color_domain) {\r\n        defines[\"DYNAMIC_COLORS\"] = true;\r\n    }\r\n    return defines;\r\n}\r\n\r\n\r\nParticle_System.prototype.select_texture = function (texture)\r\n{\r\n\tif (typeof this.texture === 'string') {\r\n\t\tthis.texture = My_Lib.Texture_Manager.get(this.texture);\r\n        if (!this.texture) {\r\n            console.error(\"Oh, not found texture <\" + this.params.texture + \"> in create particle material! Instead get \"+this.texture);\r\n        }\r\n\t}\r\n}\r\n\r\nParticle_System.prototype.create_particle_material = function()\r\n{\r\n\t\r\n    this.select_texture(this.texture);\r\n    \r\n    var blend_obj = this.convert_blending_mode(this.params.blending);\r\n    \r\n    \r\n    var uniforms = this.create_uniforms();\r\n    var defines = this.calc_defines();\r\n    \r\n\tvar mat = new THREE.ShaderMaterial({\r\n\t\ttransparent: true,\r\n\t\tdepthWrite: this.params.depth_write,\r\n\t\tdepthTest: this.params.depth_test,\r\n        blending: blend_obj.blending,\r\n        blendSrc: blend_obj.factors.blendSrc,\r\n        blendDst: blend_obj.factors.blendDst,\r\n\t\tdefines: defines,\r\n\t\tuniforms: uniforms,\r\n\t\tvertexShader: Particle_Shaders.vertex,\r\n\t\tfragmentShader: Particle_Shaders.fragment\r\n\t});\r\n\treturn mat;\r\n}\r\n\r\nParticle_System.prototype.recreate_material = function ()\r\n{\r\n    this.node.material = this.material = this.create_particle_material();\r\n}\r\n\r\n\r\nParticle_System.prototype.set_pre_alpha = function (pre_alpha)\r\n{\r\n    if (this.params.pre_alpha !== !!pre_alpha) {\r\n        this.params.pre_alpha = pre_alpha;\r\n        this.recreate_material();\r\n    }\r\n}\r\n\r\nParticle_System.prototype.set_point_size = function (size)\r\n{\r\n    if (this.params.size != size) {\r\n        this.params.size = size;\r\n        this.node.material.uniforms[\"point_size\"].value = size;\r\n    }\r\n}\r\n\r\nParticle_System.prototype.set_blending = function (blending)\r\n{\r\n    this.params.blending = blending;\r\n    var b = this.convert_blending_mode(blending);\r\n    this.material.blending = b.blending;\r\n    this.material.blendSrc = b.factors.blendSrc;\r\n    this.material.blendDst = b.factors.blendDst;\r\n}\r\n\r\n\r\n\r\n\r\nParticle_System.prototype.toJSON = function ()\r\n{\r\n\tvar data = {};\r\n    data.uuid = this.uuid;\r\n    data.node = this.node.uuid;\r\n    if (this.name || this.node.name) {\r\n        data.name = this.name || this.node.name;\r\n    }\r\n\tdata.params = {};\r\n\tif (this.params) {\r\n\t\t_.copy_object(data.params, this.params);\r\n\t}\r\n\tdata.params.emitter = this.emitter.toJSON();\r\n\tdata.params.affector = this.affector.toJSON();\r\n\treturn data;\r\n}\r\n\r\n\r\nParticle_System.prototype.set_emitter = function (emitter)\r\n{\r\n    this.emitter = this.params.emitter = emitter;\r\n}\r\n\r\nParticle_System.prototype.set_particle_life_length = function (val)\r\n{\r\n\tif (val !== this.params.particle_lifetime) {\r\n\t\tthis.params.particle_lifetime = this.particle_lifetime = val;\r\n\t\tthis.material.uniforms['lifetime'].value = val;\r\n\t}\r\n}\r\n\r\nParticle_System.prototype.set_emission_per_second = function (val)\r\n{\r\n\tthis.emitter.emit_per_second = val;\r\n}\r\n\r\nParticle_System.prototype.set_particle_count = function (count)\r\n{\r\n\tif (count !== this.particle_data.length) {\r\n\t\tthis.params.count = count;\r\n\t\tthis.node.geometry = this.create_particle_geometry(count);\r\n\t}\r\n}\r\n\r\nParticle_System.prototype.set_color = function (color)\r\n{\r\n    this.params.color.r = color.r;\r\n    this.params.color.g = color.g;\r\n    this.params.color.b = color.b;\r\n}\r\n\r\nParticle_System.prototype.set_bounding_sphere_radius = function (radius)\r\n{\r\n    this.node.boundingSphere.radius = radius;\r\n}\r\n\r\nexport {Particle_System};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/particles/particles.js\n// module id = 10\n// module chunks = 0","import {My_Lib} from '../base/my_lib.js';\r\nimport {Particle_Emitter} from './particle_emitter.js';\r\nimport {Particle_Affector} from './particle_affector.js';\r\nimport {Particles_Points} from './particles_points.js';\r\nimport {Particle_System} from './particles.js';\r\n\r\n\r\n function Particle_Manager ()\r\n{\r\n\tthis.particles = {};\r\n    this.particles_array = [];\r\n}\r\n\r\n_.copy_object(Particle_Manager.prototype, \r\n    {\r\n    constructor: Particle_Manager,\r\n    add:  function (ps,name)\r\n    {\r\n        if (!this.particles[name]) {\r\n            this.particles[name] = ps;\r\n            this.particles_array.push(ps);\r\n        }\r\n    },\r\n    remove_particles:  function (name)\r\n    {\r\n        var ps = this.particles[name];\r\n        var i = this.particles_array.indexOf(ps);\r\n        if (i >= 0) {\r\n            this.particles_array.splice(i, 1);\r\n        }\r\n        if (ps) {\r\n            ps.suicide();\r\n            delete this.particles[name];\r\n        }\r\n    },\r\n    get_particle_names:  function ()\r\n    {\r\n        var names = [];\r\n        for(var key in this.particles) {\r\n            names.push(key);\r\n        }\r\n        return names;\r\n    },\r\n\r\n    update : function (dt)\r\n    {\r\n        for(var i = 0; i < this.particles_array.length; i++) {\r\n            this.particles_array[i].update(dt);\r\n        }\r\n    },\r\n    \r\n    create_by_params: function (params)\r\n    {\r\n        var ps = new Particle_System(params);\r\n        this.add(ps);\r\n        return ps;\r\n    },\r\n\r\n\r\n    toJSON : function ()\r\n    {\r\n        var arr = []\r\n        \r\n        var data;\r\n        var p;\r\n        for(var key in this.particles){\r\n            p = this.particles[key];\r\n            if (p.uuid) {\r\n                data = p.toJSON();\r\n                arr.push(data);\r\n            }\r\n        }\r\n\r\n        return arr;\r\n    },\r\n\r\n    emitter_fabric:  function (params)\r\n    {\r\n        if (params.emitter) {\r\n            var emitter = My_Lib.Get_Class(params.emitter.name);\r\n            if (emitter) {\r\n                emitter = new emitter();\r\n            } else {\r\n                emitter = new Particle_Emitter();\r\n            }\r\n            emitter.parse(params.emitter.params);\r\n            return emitter;        \r\n        } \r\n        return undefined;\r\n    },\r\n\r\n    affector_fabric:  function (params)\r\n    {\r\n        if (params.affector) {\r\n            var affector = My_Lib.Get_Class(params.affector.name);\r\n            if (affector) {\r\n                affector = new affector();\r\n            } else {\r\n                affector = new Particle_Affector();\r\n            }\r\n            affector.parse(params.affector.params);\r\n            return affector;\r\n        }\r\n        return undefined;\r\n    },\r\n\r\n    fromJSON: function (json, callback, root, name)\r\n    {\r\n        if (this.particles[name]) {\r\n            console.log(\"WARNING Particle Manager! Particle System with this name already exists\", name);\r\n        }\r\n        \r\n        try\r\n        {\r\n            var data = JSON.parse(json);\r\n        }\r\n        catch (e)\r\n        {\r\n            console.log(\"error parsing json on \", name, json);\r\n            throw e;\r\n        }\r\n        \r\n        return this.parse(data, root, name);\r\n    },\r\n\r\n\r\n    parse: function (data, root, name)\r\n    {\r\n        var emitter = this.emitter_fabric(data.params);\r\n        var affector = this.affector_fabric(data.params);\r\n        data.params.emitter = emitter;\r\n        data.params.affector = affector;\r\n        \r\n        var ps = new Particle_System(data.params);\r\n        ps.set_name(data.name);\r\n\r\n            //add to scene graph\r\n        if (data.params.parent) {\r\n            var parent = root.getObjectByName(data.params.parent);\r\n            //console.log(data.params.parent, \"parent particles\", name, root);\r\n            parent.add(ps.node);\r\n        } else {\r\n           root.add(ps.node);\r\n        }\r\n\r\n        //ugly fucking hack\r\n        //copy node properties\r\n        this.add(ps, name);    \r\n        return ps;\r\n    },\r\n\r\n    load_particles:  function (json, root)\r\n    {\r\n        var particles = json.particles;\r\n        for(var i =0; i < particles.length; i++)\r\n        {\r\n            var p = particles[i];\r\n            var ps = this.parse(p, root, p.name);\r\n            ps.node.uuid = p.node;\r\n            ps.node.name = p.name;\r\n            var obj = root.getObjectByProperty(\"uuid\", p.node);\r\n            if (obj) {\r\n                ps.node.replace_object_with_this(obj);\r\n            }\r\n        }\r\n    },\r\n\r\n    create_name:  function ()\r\n    {\r\n        var number = this.particles_array.length + 1;\r\n        var begin_name = 'Particle_System_';\r\n        var testing = true;\r\n        while (testing) {\r\n            name = begin_name + number;\r\n            if (this.particles[name] !== undefined) {\r\n                number ++;\r\n            } else {\r\n                return name;\r\n            }\r\n        }\r\n    },\r\n\r\n    create_new : function ()\r\n    {\r\n        var name = this.create_name();\r\n        \r\n        var params = {};\r\n        var ps = new Particle_System(params);\r\n        ps.set_name(name);\r\n        this.add(ps, name);\r\n        return ps;\r\n    }\r\n});\r\n\r\n\r\nif (My_Lib.particle_manager === undefined) \r\n{\r\n    My_Lib.particle_manager = new Particle_Manager();\r\n}\r\n\r\nMy_Lib.Particles_Config = {\r\n\"box_size\": 10\r\n};\r\n\r\n\r\nexport {Particle_Manager};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/particles/particles_manager.js\n// module id = 11\n// module chunks = 0","var Point_Generators = {};\r\n\r\n\r\nPoint_Generators.Random_Direction = function ()\r\n{\r\n}\r\n\r\nPoint_Generators.Random_Direction.prototype.get_direction = function (vector)\r\n{\r\n\tvector.x = Math.random(); \r\n\tvector.y = Math.random(); \r\n\tvector.z = Math.random();\r\n}\r\n\r\nPoint_Generators.Sphere = function (radius)\r\n{\r\n\tthis.radius = radius;\r\n}\r\n\r\nPoint_Generators.Sphere.prototype.get_inner_point = function (vector)\r\n{\r\n\tvar alpha = Math.random() * Math.PI * 2;\r\n\tvar beta = Math.random() * Math.PI;\r\n\tvector.x = Math.cos(alpha) * Math.sin(beta);\r\n\tvector.y = Math.cos(beta);\r\n\tvector.z = Math.sin(alpha) * Math.sin(beta);\r\n}\r\n\r\nPoint_Generators.Sphere.prototype.get_normal = function (vector)\r\n{\r\n\tvector.x = Math.random() * 2 - 1;\r\n\tvector.y = Math.random() * 2 - 1;\r\n\tvector.z = Math.random() * 2 - 1;\r\n\tvector.normalize();\r\n}\r\n\r\nPoint_Generators.Sphere.prototype.get_point = function (vector) \r\n{\r\n\tthis.get_normal(vector);\r\n\tvector.multiplyScalar(this.radius);\r\n}\r\n\r\n\r\nexport {Point_Generators};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/particles/point_generators.js\n// module id = 12\n// module chunks = 0","/*\r\nmain class\r\nthis has abstract virtual methods\r\nstart - which create renderer and conduct start initializations\r\nupdate - updated scene objects, animations, phisics\r\nrender - control scene rendering\r\nthis methods must rewrite on derived classes\r\nneed set \r\nPROPERTIES\r\nmain_camera - camera which point of view render whole scene and user interacts\r\ndom_screen - dom element which contain canvas and display scene\r\nrenderer - three.js renderer\r\ncanvas - is created by three.js renderer, it have to append to dom_screen children, fuck it\r\ncanvas width and height defining on creating it by renderer, fuck it\r\n\r\n\r\n\r\n*/\r\n\r\nimport {My_Lib} from '../base/my_lib.js';\r\nimport {main_event_hub, Event_Hub} from '../base/event_hub.js';\r\nimport {Mouse_Intersector} from '../base/mouse_intersector.js';\r\n\r\n\r\nfunction Application (config)\r\n{\r\n\r\n    this._lifecycle_event(\"before_created\");\r\n   \r\n    this._init_timer();\r\n    this._create_loop_function();\r\n    \r\n\tthis.mouse_controllers = [];\r\n    \r\n    main_event_hub.add_event_listener(\"kill_me\", function (obj) {\r\n        this.remove_animated_object(obj);\r\n    }, this);\r\n}\r\n\r\nApplication.prototype.start = function (config)\r\n{\r\n    console.log(\"start application...\");\r\n   this._set_configuration(config);\r\n}\r\n\r\nApplication.prototype._lifecycle_event = function (name, event)\r\n{\r\n    if (this[name]) {\r\n        return this[name](event);\r\n    }\r\n    return false;\r\n}\r\n\r\n\r\nApplication.prototype._init_timer = function ()\r\n{\r\n\tthis.clock = new THREE.Clock();\t\r\n\tthis.delta_time = 0;\r\n\tthis.animated_objects = [];\r\n}\r\n\r\n\r\nvar run_function = window.requestAnimationFrame ||\r\n\tfunction(callback){\r\n\t\twindow.setTimeout(callback, 1000 / 60);\r\n\t}\r\n\t\r\n\r\n\r\nApplication.prototype._create_loop_function = function ()\r\n{\r\n    var self = this;\r\n\tthis.run = function ()\r\n\t{\r\n\t\trun_function(function () \r\n\t\t{ \r\n\t\t\tself.loop();\r\n            //main_event_hub.emit(\"new_frame\");\r\n\t\t});\r\n\t}\r\n\t\r\n    //My_Lib.create_run_function(this);\r\n    \r\n    //main_even_hub.add_event_listener(\"new_frame\", this.loop, this);    \r\n}\r\n\r\n\r\nApplication.prototype.get_default_configuration = function ()\r\n{\r\n    return {\r\n        \"dom_element\": \"screen\",\r\n        \"render_params\": {\r\n            \"premultipliedAlpha\": true,\r\n            \"alpha\": true\r\n        },\r\n        \"viewport\": {\r\n            \"width\": 800,\r\n            \"height\": 600\r\n         },\r\n         \"clear_color\": 0x0000FF,\r\n        \"main_camera\": {\r\n            \"fov\": 80,\r\n            \"near\": 0.1,\r\n            \"far\": 1000,\r\n            \"aspect_ratio\": 1.3333333333333333,\r\n            \"position\": {\r\n                \"x\": 0,\r\n                \"y\": 0,\r\n                \"z\": 0\r\n            }\r\n        }\r\n    };\r\n}\r\n\r\nApplication.prototype._create_render = function (json)\r\n{\r\n    if (this.dom_screen || this.renderer) {\r\n        alert(\"Create render alert! Something strange happenes!\");\r\n    }\r\n    if (!this.dom_screen) {\r\n        this.dom_screen = document.getElementById(json.dom_element);\r\n    }\r\n    if (!this.renderer) {\r\n        this.renderer = new THREE.WebGLRenderer(json.render_params);\r\n    }\r\n    if (!!!this.dom_screen || typeof this.dom_screen === 'undefined') {\r\n        console.error(\"Some terrorous happens! dom element for screen not found! element id is \" + json.dom_element);\r\n    }\r\n    //console.log(\"found dome element \" + json.dom_element);\r\n    this.dom_screen.appendChild(this.renderer.domElement);\r\n    this.canvas = this.renderer.domElement;\r\n    \r\n    \r\n    this.renderer.setSize(json.viewport.width, json.viewport.height);\r\n    this.set_viewport(json.viewport.width, json.viewport.height);\r\n    this.renderer.setClearColor(json.clear_color);\r\n    \r\n    this._lifecycle_event(\"render_created\");\r\n}\r\n\r\nApplication.prototype._create_main_scene = function (json)\r\n{\r\n    var event = {prevent: false};\r\n    this._lifecycle_event(\"before_create_main_scene\", event);\r\n    /*\r\n    if (event.prevent) {\r\n        return;\r\n    }\r\n    */\r\n    if (!this.main_scene) {\r\n        this.main_scene = new THREE.Scene();\r\n    }\r\n    \r\n    var camera = json.main_camera;    \r\n    if (!this.main_camera) {\r\n        this.main_camera = new THREE.PerspectiveCamera(camera.fov, camera.aspect_ratio, camera.near, camera.far);\r\n        this.main_scene.add(this.main_camera);\r\n        this.main_camera.name = \"main_camera\";\r\n    } else {\r\n        this.main_camera.fov = camera.fov;\r\n        this.main_camera.near = camera.near;\r\n        this.main_camera.far = camera.far;\r\n        this.main_camera.aspect = camera.aspect_ratio;\r\n        this.main_camera.updateProjectionMatrix();\r\n    }\r\n    \r\n    this.main_camera.position.set(camera.position.x, camera.position.y, camera.position.z);\r\n}\r\n\r\nApplication.prototype.apply_configuration = function (json)\r\n{\r\n    this.configuration = json;\r\n    this._create_render(json);\r\n    this._create_main_scene(json);\r\n    this._lifecycle_event(\"created\");\r\n}\r\n\r\nApplication.prototype.load_configuration = function (url)\r\n{\r\n    var xhr = new THREE.XHRLoader();\r\n    \r\n    var self = this;\r\n    \r\n    var config = self.get_default_configuration();\r\n    \r\n    var configuration_is_applied = false;\r\n    \r\n    function onload (data) {\r\n        console.log(\"configuration loaded from url <<\" + url + \">>\");\r\n        var obj = JSON.parse(data);\r\n        //user config append to default config and may rewrite them, \r\n        //though user naven't to rewrite ALL config to change some params\r\n        _.copy_object(config, obj);\r\n        self.apply_configuration(config);\r\n        console.log(configuration_is_applied, \"onload\");        \r\n        configuration_is_applied = true;\r\n    }\r\n    function progress() {}\r\n    function error(event) {\r\n        console.error(\"Error on loading config!\", event.target.status);\r\n        console.log(\"Setting default configuration\");\r\n        console.log(configuration_is_applied, \"error\");        \r\n        configuration_is_applied = true;        \r\n        self.apply_configuration(config);\r\n    }\r\n    xhr.load(url, onload, progress, error);\r\n}\r\n\r\n\r\nApplication.prototype._set_configuration = function (config)\r\n{\r\n    var default_config = this.get_default_configuration();\r\n    \r\n    //this is url of configuration file\r\n    if (typeof config === 'string') {\r\n        console.log(\"get configuration from url >> \" + config);\r\n        this.load_configuration(config);\r\n        \r\n        //this is object filled with data\r\n    } else if (typeof config === 'object') {\r\n        console.log(\"get configuration from user object\");\r\n        _.copy_object(default_config,config);\r\n        this.apply_configuration(default_config);\r\n    //configuration not given, use default\r\n    } else {\r\n        console.log(\"_set_configuration: set default configration\");\r\n       this.apply_configuration(default_config);\r\n    }\r\n}\r\n\r\nApplication.extend = function (methods, child_func)\r\n{\r\n\r\n    var Child;\r\n    if (typeof child_func === 'undefined') {\r\n        Child = function ()\r\n        {\r\n            Application.apply(this, arguments);\r\n        }\r\n    } else {\r\n        Child = child_func;\r\n    }\r\n\r\n    //create new object and set prototype chain\r\n\tChild.prototype = Object.create(Application.prototype);\r\n    //copy methods to new object\r\n\t_.copy_object(Child.prototype, methods);\r\n    Child.prototype.constructor = Child;\r\n   \r\n    return Child;\r\n}\r\n\r\nApplication.extend_proto = function (proto, methods)\r\n{\r\n\tvar obj = Object.create(proto);\r\n\t_.copy_object(obj, methods);\r\n\tApplication.call(obj);\r\n\treturn obj;\r\n}\r\n\r\n\r\nApplication.prototype.loop = function () \r\n{\r\n\tvar delta = this.clock.getDelta();\r\n\t//fix this - add options to control min frame rate\r\n\tif (delta > 0.1) {\r\n\t\tdelta = 0.1;\r\n\t}\r\n\tthis.delta_time = delta;\r\n    this.do_update(delta);\r\n\tthis.update(delta);\r\n\tthis.render(delta);\r\n\tthis.run();\r\n    //My_Lib.run();\r\n}\r\n\r\n\r\n\r\nApplication.prototype.add_animated_object = function (obj)\r\n{\r\n\t//fix probably duplicates\r\n\tthis.animated_objects.push(obj);\r\n}\r\n\r\nApplication.prototype.remove_animated_object = function (obj)\r\n{\r\n\tfor(var i = 0; i < this.animated_objects.length; i++) {\r\n\t\tif (this.animated_objects[i] === obj) {\r\n\t\t\tthis.animated_objects.splice(i, 1);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n\r\nApplication.prototype.update_all = function (delta)\r\n{\r\n\tvar obj;\r\n\tfor(var i = 0, len = this.animated_objects.length; i < len; i++) {\r\n\t\tobj = this.animated_objects[i];\r\n\t\tif (obj[\"update\"]) {\r\n\t\t\tobj.update(delta);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nApplication.prototype.pre_update = function (delta)\r\n{\r\n\tthis.update_all(delta);\r\n    My_Lib.particle_manager.update(delta);\r\n    //event\r\n    if (this.before_update !== undefined) {\r\n        this.before_update(delta);\r\n    }\r\n}\r\n\r\n\r\nApplication.prototype.do_update = function (dt)\r\n{\r\n    this.pre_update(dt);\r\n    this.update(dt);\r\n}\r\n\r\nApplication.prototype.update = function (delta)\r\n{\r\n}\r\n\r\n\r\nApplication.prototype.create_mouse_move_listener = function ()\r\n{\r\n\tif (this[\"mouse_move_listener\"]) {\r\n\t\treturn;\r\n\t}\r\n\tvar self = this;\r\n\tthis.mouse_move_listener = true;\r\n\tfunction mouse_move_listener(event) {\r\n\t\tvar vector = Mouse_Intersector.mouse_coords_to_vector(self.dom_screen, event);\t\t\r\n\t\tself.find_mouse_over_intersections(vector);\r\n\t};\r\n\tdocument.addEventListener(\"mousemove\", mouse_move_listener);\r\n}\r\n\r\nApplication.prototype.find_mouse_over_intersections = function(vector)\r\n{\r\n\tvector.unproject(this.main_camera);\r\n\tvar ray = new THREE.Raycaster( this.main_camera.position, vector.sub( this.main_camera.position ).normalize() );\r\n\tvar obj;\r\n\tfor(var i =0, len = this.mouse_controllers.length; i < len; i++){\r\n\t\tobj = this.mouse_controllers[i];\r\n\t\tif (obj.over) {\r\n\t\t\t// create an array containing all objects in the scene with which the ray intersects\r\n\t\t\t//var intersects = ray.intersectObjects( [grid_text.root], true ); \r\n\t\t\t//console.log(fake_plane.root.children[0].geometry);\r\n\t\t\tvar intersects = ray.intersectObjects( [obj.root], true ); \r\n\t\t\tobj.callback(intersects);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nApplication.prototype.add_mouse_controller = function (root, over, click, callback)\r\n{\r\n\tvar tmp = new My_Lib.Mouse_Controller(root, over, click, callback)\r\n\tthis.mouse_controllers.push( tmp );\r\n\tif (over) {\r\n\t\tthis.create_mouse_move_listener();\r\n\t}\r\n\treturn tmp;\r\n}\r\n\r\n\r\n\r\nApplication.prototype.set_viewport = function (width, height)\r\n{\r\n\tMy_Lib.Viewport.width = width;\r\n\tMy_Lib.Viewport.height = height;\r\n}\r\n\r\nApplication.prototype.render = function (delta) \r\n{\r\n\tthis.renderer.setClearColor(this.configuration.clear_color);\r\n\tthis.renderer.autoClear = true;\r\n\tthis.renderer.render(this.main_scene, this.main_camera);\r\n}\r\n\r\n\r\n\r\nexport {Application};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app/application.js\n// module id = 13\n// module chunks = 0","import {My_Lib} from './my_lib.js';\r\n\r\n//length - simple length of animations\r\n//-1 - infinite\r\n//0 - stop\r\n//> 0 - length of animation, \r\n//if time > length, animation stop\r\n//need rewrite this crap to safe floating point mannere\r\n//and append more controle on animation \r\n    function Base_Animation ()\r\n    {\r\n        this.time = 0;\r\n        this.time_scale = 1.0;\r\n        this.type = \"Base_Animation\";\r\n        this.uuid = _.generateUUID();\r\n        this.length = -1;\r\n        this.stopped = false;\r\n    }\r\n    \r\n    Base_Animation.prototype.update = function (dt)\r\n    {\r\n        var scaled_dt = dt * this.time_scale;\r\n        this.time += scaled_dt;\r\n        if (this.length < 0 || this.time < this.length) {\r\n            this.calc_animation(dt);\r\n        }\r\n    }\r\n    \r\n    Base_Animation.prototype.stop = function ()\r\n    {\r\n        this.stopped = true;\r\n    }\r\n    \r\n    Base_Animation.prototype.start = function ()\r\n    {\r\n        this.stopped = false;\r\n    }\r\n    \r\n    Base_Animation.prototype.reset = function ()\r\n    {\r\n        this.time = 0;\r\n    }\r\n    \r\n    Base_Animation.prototype.calc_animation = function (dt)\r\n    {\r\n        \r\n    }\r\n    \r\n    Base_Animation.prototype.apply = function(obj)\r\n    {\r\n    }\r\n    \r\n    Base_Animation.prototype.toJSON = function (data)\r\n    {\r\n        var data = {};\r\n        data.uuid = this.uuid;\r\n        data.type = this.type;\r\n        if (this.name !== '') {\r\n            data.name = this.name;\r\n        }\r\n        data.time_scale = this.time_scale === undefined ? 1.0 : this.time_scale;\r\n        data.length = this.length;\r\n        return data;\r\n    }\r\n    \r\n    Base_Animation.prototype.parse = function (param)\r\n    {\r\n        this.type = param.type;\r\n        this.uuid = param.uuid;\r\n        this.name = param.name ? param.name : '';\r\n        this.time_scale = (param.time_scale === undefined) ? 1.0 : param.time_scale;\r\n        this.length = param.length === undefined ? -1 : param.length;\r\n    }\r\n    \r\n\r\n    \r\n    \r\n        \r\nfunction Euler_Animation (x, y, z)\r\n{\r\n    Base_Animation.call(this);\r\n    this.type = \"Euler_Animation\";\r\n\tthis.xspeed = x;\r\n\tthis.yspeed = y;\r\n\tthis.zspeed = z;\r\n    this.x = 0;\r\n    this.y = 0;\r\n    this.z = 0;\r\n    this.name = '';\r\n}\r\n\r\nEuler_Animation.prototype = Object.create(Base_Animation.prototype);\r\n\r\n\r\nEuler_Animation.prototype.constructor = Euler_Animation;\r\n\r\nEuler_Animation.prototype.calc_animation = function (dt)\r\n{\r\n    //console.log(this.xspeed,this.yspeed, this.zpeed, dt, this.time_scale);\r\n    dt *= this.time_scale;\r\n\tthis.x += this.xspeed * dt;\r\n\tthis.y += this.yspeed * dt;\r\n\tthis.z += this.zspeed * dt;\r\n}\r\n    \r\nEuler_Animation.prototype.apply = function (obj)\r\n{\r\n    obj.rotation.set(this.x,this.y, this.z);\r\n}\r\n\r\nEuler_Animation.prototype.toJSON = function (json)\r\n{\r\n   var data = Base_Animation.prototype.toJSON.call(this);\r\n   data.xspeed = this.xspeed;\r\n   data.yspeed = this.yspeed;\r\n   data.zspeed = this.zspeed;\r\n   return data;\r\n}\r\n\r\nEuler_Animation.prototype.parse = function (param)\r\n{\r\n    Base_Animation.prototype.parse.call(this, param);\r\n    this.xspeed = param.xspeed;\r\n    this.yspeed = param.yspeed;\r\n    this.zspeed = param.zspeed;\r\n    this.x = this.y = this.z = 0;    \r\n}\r\n\r\n\r\nfunction Scale_Animation(x, y, z)\r\n{\r\n    Base_Animation.call(this);\r\n    //speed of scale\r\n    this.xscale = x;\r\n    this.yscale = y;\r\n    this.zscale = z;\r\n    this.x = 1.0;\r\n    this.y = 1.0;\r\n    this.z = 1.0;\r\n}\r\n\r\nScale_Animation.prototype = Object.create(Base_Animation.prototype);\r\n\r\n_.copy_object(Scale_Animation.prototype, {\r\n    constructor: Scale_Animation,\r\n    calc_animation: function (dt) \r\n    {\r\n        dt = dt * this.time_scale;\r\n        this.x += this.xscale * dt;\r\n        this.y += this.yscale * dt;\r\n        this.z += this.zscale * dt;\r\n    },\r\n    apply:function (obj) {\r\n        obj.scale.set(this.x, this.y, this.z);\r\n    },\r\n    reset: function () {\r\n        if (this.first) {\r\n        }\r\n        this.x = 1.0;\r\n        this.y = 1.0;\r\n        this.z = 1.0;\r\n        this.time = 0;\r\n    }\r\n});\r\n\r\n\r\nMy_Lib.Register_Class(\"Base_Animation\", Base_Animation);\r\nMy_Lib.Register_Class(\"Euler_Animation\", Euler_Animation);\r\nMy_Lib.Register_Class(\"Scale_Animation\", Scale_Animation);\r\n\r\n\r\nexport { Base_Animation, Euler_Animation, Scale_Animation };\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/base/animations.js\n// module id = 14\n// module chunks = 0","import {My_Lib} from './my_lib.js';\r\n\r\n//events: \r\n//item_loaded\r\n//onerror\r\n//onprogress\r\n//finished\r\nfunction Chain_Loader()\r\n{\r\n}\r\n\r\nChain_Loader.prototype = {\r\n\tconstructor: Chain_Loader,\r\n\tstart: function (list) \r\n\t{\r\n\t\tthis.list = list;\r\n\t\tthis.index = 0;\r\n\t\tthis.load(this.list[0]);\r\n\t\tthis.stop_by_error = false;\r\n\t},\r\n\t\r\n\tnext: function(resource)\r\n\t{\r\n\t\tif (this.item_loaded && resource) {\r\n\t\t\tthis.item_loaded(resource,this.list[this.index]);\r\n\t\t}\r\n\t\tthis.index++;\r\n\t\tif (this.index < this.list.length) {\r\n\t\t\tthis.load(this.list[this.index]);\r\n\t\t} else {\r\n\t\t\tif (this.finished) {\r\n\t\t\t\tthis.finished();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\tdo_error: function (error)\r\n\t{\r\n\t\tif (this.onerror) {\r\n\t\t\tthis.onerror(error);\r\n\t\t} else {\r\n\t\t\tconsole.error(\"Chain Loader Error!\", error);\r\n\t\t}\r\n\t\tif (!this.stop_by_error) {\r\n\t\t\tthis.next();\r\n\t\t}\r\n\t},\r\n\t\r\n\tdo_progress: function ()\r\n\t{\r\n\t\tif (this.onprogress) {\r\n\t\t\tthis.onprogress.apply(this, arguments);\r\n\t\t}\r\n\t},\r\n\t\t\r\n\tload: function (item)\r\n\t{\r\n\t\tvar self = this;\r\n\t\tif (this.load_func) {\r\n\t\t\tthis.load_func(item, \r\n\t\t\tfunction (item) { self.next.apply(self, arguments); },\r\n\t\t\tfunction (item) { self.do_error.apply(self, arguments); },\r\n\t\t\tfunction (item) { self.do_progress.apply(self, arguments); });\r\n\t\t}\r\n\t}\r\n};\r\n\r\n\r\nfunction test_chain_loader() \r\n{\r\n\tvar cl = new Chain_Loader();\r\n\tcl.item_loaded = function (item) {console.log(\"load item \", item);}\r\n\tcl.finished = function (item) {console.log(\"loader manager - job done\");}\r\n\tcl.load_func = function (item, next, error, progress) { \r\n\t\tif (item) {\r\n\t\t\tnext(item);\r\n\t\t} else {\r\n\t\t\terror(item);\r\n\t\t}\r\n\t}\r\n\tcl.start([\"first\", \"second\", null, \"tree\"]);\r\n}\r\n//test_chain_loader();\r\n\r\n\r\n\r\n\r\nfunction Loading_Manager ()\r\n{\r\n\tthis.resources = {};\r\n\tthis.texture_loader = new THREE.TextureLoader();\r\n}\r\n\r\nLoading_Manager.prototype = {\r\n\tconstructor: Loading_Manager,\r\n\tget: function (name)\r\n\t{\r\n\t\treturn this.resources[name];\r\n\t},\r\n\t\r\n\tget_async: function (name, callback)\r\n\t{\r\n\t\t//already loaded?\r\n\t\tvar texture = this.get(name);\r\n\t\tif (texture) {\r\n\t\t\tif (callback) {\r\n\t\t\t\tcallback(texture);\r\n\t\t\t}\r\n\t\t\treturn texture;\r\n\t\t}\r\n\r\n\t\t//if not load this async\r\n\t\tvar self = this;\r\n\t\ttexture = this.texture_loader.load(name, function (texture)\r\n\t\t{\r\n\t\t\tif (callback) {\r\n\t\t\t\tcallback(texture);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.resources[name] = texture;\t\r\n\t\treturn texture;\r\n\t},\r\n\t\r\n\r\n\tload_list: function (resource_list, on_load, load_func, on_progress)\r\n\t{\r\n\t\tvar self = this;\r\n\t\t\r\n\t\tvar cl = new Chain_Loader();\r\n\t\tvar self = this;\r\n\t\tcl.onerror = function (error) {\r\n\t\t\tconsole.error(\"ERROR loading texture\", error, cl.list[cl.index]);\t\r\n\t\t}\r\n\t\tcl.item_loaded = function (resource, name) {\r\n\t\t\tself.resources[name] = resource;\r\n\t\t\tif (self.on_resource_loaded) {\r\n\t\t\t\tself.on_resource_loaded(resource);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcl.on_progress = function () {\r\n\t\t\tif (on_progress) {\r\n\t\t\t\ton_progress();\r\n\t\t\t}\r\n\t\t}\r\n\t\tcl.load_func = function () {\r\n\t\t\tload_func.apply(this, arguments);\r\n\t\t}\r\n\t\tcl.finished = function ()\r\n\t\t{\r\n\t\t\tif (on_load) {\r\n\t\t\t\ton_load();\r\n\t\t\t}\r\n\t\t}\r\n\t\tcl.start(resource_list);\r\n\t\t\r\n\t},\r\n\r\n\tload_list_textures: function (resource_list, on_load)\r\n\t{\r\n\t\tvar self = this;\r\n\t\tthis.load_list(resource_list, on_load, function (url, next, error, progress ) \r\n\t\t{\r\n\t\t\tvar texture = self.texture_loader.load(url, next, progress, error);\r\n\t\t});\r\n\t},\r\n\r\n\tload_list_json: function (resource_list, on_load, progress)\r\n\t{\r\n\t\tvar self = this;\r\n\t\tvar loader = new THREE.XHRLoader();\t\r\n\t\tthis.load_list(resource_list, on_load, function (url, next, error, progress) \r\n\t\t{\r\n\t\t\tvar texture = loader.load(url, next, progress, error);\r\n\t\t}, progress);\r\n\t},\r\n\t\r\n\tfree: function ()\r\n\t{\r\n\t\tthis.resources = {};\r\n\t}\r\n};\r\n\r\n\r\nMy_Lib.Texture_Manager = new Loading_Manager();\t\r\n\r\nexport { Loading_Manager };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/base/loading_manager.js\n// module id = 15\n// module chunks = 0","//TODO: remove this ugly crap and replace something reasonable\r\n\r\nimport {My_Lib} from './my_lib.js';\r\n\r\n//this ugly class loading texture list in json format, parse it, and loading textures\r\n//then it call event data_loaded, when give texture list in json format\r\n\r\nfunction Package_Manager()\r\n{\r\n    this.state = {};\r\n}\r\n\r\n//load json file with descriptions of package: texture list, particles list, scene objects list\r\nPackage_Manager.prototype.load = function (url, defaults)\r\n{\r\n    this.defaults = defaults;\r\n    var self = this;\r\n    this.state = {\r\n        \"type\": \"start\"\r\n    };\r\n    \r\n    var self = this;\r\n    function onload (data) {\r\n        self.state[\"type\"] = \"done\";\r\n        self.state[\"data\"] = data;\r\n        \r\n        self.parse_package_description(data);        \r\n    }    \r\n    function error(event) {\r\n        self.state[\"type\"] = \"error\";\r\n        self.state[\"error\"] = event;\r\n        console.error(\"ERror! Failed loading resources with url \"+url, event.target);        \r\n        if (self.error){\r\n            self.error(event.target);\r\n        }\r\n        self.pack = self.defaults\r\n        self.load_resources(self.defaults);\r\n\r\n    }\r\n    function progress()\r\n    {\r\n    }\r\n    var xhr = new THREE.XHRLoader();\r\n    xhr.load(url, onload, progress, error);\r\n}\r\n\r\n//parse loaded json file \r\nPackage_Manager.prototype.parse_package_description = function (data)\r\n{\r\n    console.log(\"packaged description loaded, begin parsing...\");\r\n  try {\r\n        var pack = JSON.parse(data);\r\n        this.pack = pack;\r\n        if (this.loaded) {\r\n            this.loaded(pack);\r\n        }\r\n        \r\n   } \r\n   catch(e) {\r\n        console.error(\"error parsing resources \", e);\r\n        if (this.error){\r\n            this.error(event);\r\n        }\r\n        return;        \r\n   }\r\n   this.load_resources(pack);\r\n}\r\n\r\n\r\nPackage_Manager.prototype.load_resources = function (pack)\r\n{\r\n    var self = this;\r\n    //load textures\r\n   console.log(\"Package Manager: begin loading textures...\");    \r\n    My_Lib.Texture_Manager.load_list_textures(pack.textures, function (){\r\n        //load json descriptions files\r\n                if (self.data_loaded) {\r\n                    self.data_loaded(pack);\r\n                }\r\n    })\r\n}\r\n\r\n\r\nexport { Package_Manager };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/base/package_manager.js\n// module id = 16\n// module chunks = 0","import {My_Lib} from './my_lib.js';\r\nimport {Particle_Manager} from '../particles/particles_manager.js'\r\n\r\nfunction Scene_Serializer(root)\r\n{\r\n    this.animation_library = {};\r\n}\r\n\r\nScene_Serializer.prototype.toJSON = function (root)\r\n{\r\n    this.json = root.toJSON();\r\n    console.log(\"my lib particle manager\", My_Lib.particle_manager);\r\n    this.json[\"particles\"] = My_Lib.particle_manager.toJSON();\r\n    var anims = root.collect_animations(root);\r\n    if (anims.count > 0) {\r\n        this.json[\"myanimations\"] = anims;\r\n    }\r\n    \r\n    return this.json;\r\n}\r\n\r\n\r\n\r\nScene_Serializer.prototype.create_animations = function (animations) {\r\n    for(var key in animations) {\r\n        if ( this.animation_library[key] === undefined && Object.prototype.hasOwnProperty.call(animations, key)) {\r\n            var data = animations[key];\r\n            //console.log(\"create animations \", data.uuid);            \r\n            var anim =  My_Lib.Abstract_Fabric(data);\r\n            if (anim) {\r\n                this.animation_library[key] = anim;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\nScene_Serializer.prototype.bind_animations = function (animdata)\r\n{\r\n    if (!animdata) return;\r\n    \r\n    var bindings = animdata.bindings;\r\n    \r\n    //console.log(\"bind animation\");\r\n    var self = this;\r\n    function copy_animations(obj, bind)\r\n    {\r\n        for(var i = 0; i < bind.animations.length; i++){\r\n            var anim_uuid = bind.animations[i];\r\n            obj.add_animation( self.animation_library[anim_uuid] );\r\n        }\r\n    }\r\n    \r\n     for(var i =0; i < bindings.length; i++) {\r\n        var bind = bindings[i];\r\n        var uuid = bind.uuid;\r\n        var obj = this.root.getObjectByProperty(\"uuid\", uuid);\r\n        if (obj) {\r\n            //console.log(\"binding \" + uuid + \" object to animation \"+uuid);\r\n            copy_animations(obj, bind);\r\n        }\r\n    }\r\n}\r\n\r\n\r\nScene_Serializer.prototype.load_from_json = function (url)\r\n{\r\n    var self = this;\r\n    function onload(json)\r\n    {\r\n        try {\r\n            var data = JSON.parse(json);\r\n        }\r\n        catch(e) {\r\n            console.error(\"Failed to parse scene \", e);\r\n            throw e;\r\n        }\r\n        if (data === undefined) {\r\n            console.error(\"Something fucking happened, failed to load scene \", url);\r\n            return;\r\n        }\r\n        self.load(data);\r\n    }\r\n    function progress()\r\n    {\r\n    }\r\n    function error(e)\r\n    {\r\n        console.error(e.target);\r\n        throw e;\r\n    }\r\n    var xhr = new THREE.XHRLoader();\r\n    xhr.load(url, onload, progress, error);\r\n}\r\n\r\nScene_Serializer.prototype.load = function (json)\r\n{\r\n    this.animation_library = {};\r\n    var o = new THREE.ObjectLoader();\r\n    if (json !== undefined) {\r\n        this.json = json;\r\n    }\r\n    var root = o.parse(this.json, function () {console.log(\"onload\")});\r\n    this.root = root;    \r\n\r\n    My_Lib.particle_manager.load_particles(this.json, root);\r\n    \r\n    this.create_animations(this.json.myanimations.animations);\r\n    this.bind_animations(this.json.myanimations);\r\n    this.main_camera = root.getObjectByName(\"main_camera\");\r\n    \r\n    if (this.scene_loaded) {\r\n        this.scene_loaded(root);\r\n    }\r\n    return root;\r\n}\r\n\r\nexport { Scene_Serializer };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/base/scene_serializer.js\n// module id = 17\n// module chunks = 0","import {Mouse_Camera_Controller} from '../base/mouse_camera_controller.js';\r\n\r\nfunction Mixin()\r\n{\r\n\r\n    //need for unproject object and dragging\r\n    THREE.PerspectiveCamera.prototype.get_forward_plane_by_object = function (obj)\r\n    {\r\n        var z = new THREE.Vector3();\r\n        z.setFromMatrixColumn( this.matrixWorld, 2 );\r\n        var dist = obj.position.dot(z);             \r\n        var plane= new THREE.Plane(z.negate(), dist);\r\n        return plane;\r\n    }\r\n\r\n    \r\n    THREE.PerspectiveCamera.prototype.get_ray_from_screen_coordinates = function (canvas, x,y)\r\n    {\r\n        var mc = new Mouse_Camera_Controller(canvas, this);\r\n        var ray = mc.get_ray_from_camera_in_screen_coordinates(x,y);\r\n        return ray;\r\n    }\r\n\r\n    \r\n}\r\n\r\nMixin();\r\nexport {Mixin};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/mixins/camera_mixin.js\n// module id = 18\n// module chunks = 0","function Mix_It()\r\n{\r\n\r\n\r\n\r\n\t//FIX\r\n\tTHREE.Vector3.prototype.applyMatrix4_rotation = function ( m ) \r\n\t{\r\n\t\t// input: THREE.Matrix4 affine matrix\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z;\r\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z;\r\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\r\n\r\n\t\treturn this;\r\n \t}\r\n\r\nvar Object3D_Animation_Mixin = {\r\n    \r\n    add_animation: function (anim)\r\n    {\r\n        if (!this.animations) {\r\n            this.animations = [];\r\n        }\r\n        if (this.animations.indexOf(anim) < 0) {\r\n            this.animations.push(anim);\r\n        }\r\n    },\r\n    \r\n    remove_animation: function (anim)\r\n    {\r\n        if (this.animations) {\r\n            var i = this.animations.indexOf(anim);\r\n            if (i > -1) {\r\n                this.animations.splice(i, 1);\r\n            }\r\n        }\r\n    },\r\n    \r\n    update:  function (dt)\r\n    {\r\n        //console.log(\"object update\", dt);\r\n        if (this.animations !== undefined) {\r\n            for(var i =0; i < this.animations.length; i++) {\r\n                var anim = this.animations[i];\r\n                anim.update(dt);\r\n                //console.log(this.rotation);\r\n                anim.apply(this);\r\n                //console.log(this.rotation);\r\n            }\r\n        }\r\n    \r\n        for(var i = 0; i < this.children.length; i++) {\r\n            var obj = this.children[i];\r\n            if (obj.update) {\r\n                obj.update(dt);\r\n            }\r\n        }\r\n    },\r\n    \r\n    \r\n};\r\n_.copy_object(THREE.Object3D.prototype, Object3D_Animation_Mixin);\r\n\r\n\r\nTHREE.Object3D.prototype.old_toJson = THREE.Object3D.toJSON;\r\n\r\nvar Object3D_Serialization_Mixin = \r\n{\r\n    standard_serialization: function (meta) \r\n    {\r\n\t\t// standard Object3D serialization\r\n\t\tvar object = {};\r\n\r\n\t\tobject.uuid = this.uuid;\r\n\t\tobject.type = this.type;\r\n\t\tif ( this.name !== '' ) object.name = this.name;\r\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) object.userData = this.userData;\r\n\t\tif ( this.castShadow === true ) object.castShadow = true;\r\n\t\tif ( this.receiveShadow === true ) object.receiveShadow = true;\r\n\t\tif ( this.visible === false ) object.visible = false;\r\n\r\n\t\tobject.matrix = this.matrix.toArray();\r\n        \r\n\r\n        if (this.type !== \"particles_points\")\r\n        {\r\n            if (this.geometry !== undefined) {\r\n                object.geometry = this.geometry.uuid;\r\n            }\r\n            if ( this.material !== undefined ) {\r\n                object.material = this.material.uuid;\r\n            }\r\n            \r\n            if ( this.material !== undefined  &&  meta.materials[ this.material.uuid ] === undefined ) {\r\n                    meta.materials[ this.material.uuid ] = this.material.toJSON( meta);\r\n            }\r\n\r\n            if ( this.geometry !== undefined && meta.geometries[ this.geometry.uuid ] === undefined ) {\r\n                    meta.geometries[ this.geometry.uuid ] = this.geometry.toJSON( meta );\r\n            }\r\n        }\r\n        \r\n        if (this.animations) {\r\n            object.animations = [];\r\n            for(var i =0; i < this.animations.length; i++) {\r\n                object.animations.push ( this.animations[i].uuid );\r\n            }\r\n        }\r\n        \r\n\t\tif ( this.children.length > 0 ) {\r\n\t\t\tobject.children = [];\r\n\t\t\tfor ( var i = 0; i < this.children.length; i ++ ) \r\n            {\r\n                var child = this.children[ i ];\r\n\t\t\t\t//object.children.push( child.standard_serialization( meta ) );\r\n                object.children.push( child.toJSON( meta ) );\r\n\t\t\t}\r\n\t\t}\r\n        return object;\r\n    },\r\n    \r\n    collect_materials: function (meta) \r\n    {\r\n\t\tif ( this.material !== undefined  &&  meta.materials[ this.material.uuid ] === undefined ) {\r\n                meta.materials[ this.material.uuid ] = this.material.toJSON( meta);\r\n\t\t}\r\n        \r\n\t\tfor ( var i = 0; i < this.children.length; i ++ ) {\r\n\t\t\tthis.children[ i ].collect_materials(meta);\r\n\t\t}\r\n    },\r\n    \r\n    collect_geometry: function (meta)\r\n    {\r\n\t\tif ( this.geometry !== undefined && meta.geometries[ this.geometry.uuid ] === undefined ) {\r\n\t\t\t\tmeta.geometries[ this.geometry.uuid ] = this.geometry.toJSON( meta );\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < this.children.length; i ++ ) {\r\n\t\t\tthis.children[ i ].collect_geometry(meta);\r\n\t\t}\r\n    },\r\n    \r\n\ttoJSON1: function ( meta ) {\r\n    \r\n\t\t// extract data from the cache hash\r\n\t\t// remove metadata on each item\r\n\t\t// and return as array\r\n\t\tfunction extractFromCache( cache, t ) {\r\n\t\t\tvar values = [];\r\n\t\t\tfor ( var key in cache ) {\r\n\t\t\t\tvar data = cache[ key ];\r\n\t\t\t\tdelete data.metadata;\r\n\t\t\t\tvalues.push( data );\r\n\t\t\t}\r\n\t\t\treturn values;\r\n\t\t}\r\n    \r\n\r\n        this.updateMatrixWorld(true);\r\n        \r\n\t\t// meta is '' when called from JSON.stringify\r\n\t\tvar isRootObject = ( meta === undefined || meta === '' );\r\n\r\n\t\tvar output = {};\r\n\r\n\t\tif ( isRootObject ) {\r\n\r\n            meta = {\r\n\t\t\t\tgeometries: {},\r\n\t\t\t\tmaterials: {},\r\n\t\t\t\ttextures: {},\r\n\t\t\t\timages: {}\r\n\t\t\t};\r\n            \r\n            \r\n            //this.collect_materials(meta);\r\n            //this.collect_geometry(meta);\r\n            var object = this.standard_serialization(meta);\r\n            \r\n            \r\n\t\t\toutput.metadata = {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'Object',\r\n\t\t\t\tgenerator: 'Object3D.toJSON'\r\n\t\t\t};\r\n\r\n\t\t\tvar geometries = extractFromCache( meta.geometries, \"geoim\" );\r\n\t\t\tvar materials = extractFromCache( meta.materials, \"materials\" );\r\n\t\t\tvar textures = extractFromCache( meta.textures, \"textures\" );\r\n\t\t\tvar images = extractFromCache( meta.images, \"images\" );\r\n\r\n\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\r\n\t\t\tif ( materials.length > 0 ) output.materials = materials;\r\n\t\t\tif ( textures.length > 0 ) output.textures = textures;\r\n\t\t\tif ( images.length > 0 ) output.images = images;\r\n\r\n            var anims = this.collect_animations(this);\r\n            if (anims.count > 0) {\r\n                output[\"myanimations\"] = anims;\r\n            }\r\n           \r\n            output.object = object;\r\n\t\t} else {\r\n            output.object = this.standard_serialization(meta);\r\n            output.type = this.type;\r\n            if (output.object === undefined) {\r\n                console.log(\"i am undefined\", this);\r\n            }\r\n        }\r\n\r\n\t\treturn output;\r\n\r\n\r\n\t},\r\n    \r\n    collect_animations: function (scene)\r\n    {\r\n        var data = {\r\n            animations : {},\r\n            bindings : [],\r\n            count: 0\r\n        };\r\n        \r\n        function collect_animations_recursive(root)\r\n        {\r\n            if (root.animations) {\r\n                for(var i =0; i < root.animations.length; i++) {\r\n                    var anim = root.animations[i];\r\n                    if (data.animations[ anim.uuid ] === undefined) {\r\n                        data.animations[ anim.uuid] = anim.toJSON() ;\r\n                        data.count++;\r\n                    }\r\n                }\r\n                \r\n                var bind = {};\r\n                bind.uuid = root.uuid\r\n                bind.animations = [];\r\n                for(var i =0; i < root.animations.length; i++) {\r\n                    bind.animations.push( root.animations[i].uuid);\r\n                }\r\n                data.bindings.push(bind);\r\n            }\r\n            \r\n            if (root.children) {\r\n                for(var i = 0; i < root.children.length; i++) {\r\n                    collect_animations_recursive( root.children[i] );\r\n                }\r\n            }\r\n        }\r\n        collect_animations_recursive(scene);\r\n        return data;\r\n    },\r\n    \r\n \r\n};\r\n\r\n\r\n  _.copy_object(THREE.Object3D.prototype, Object3D_Serialization_Mixin);\r\n  \r\nTHREE.Object3D.prototype.dm_mark = 'yes,this object has been marked by black magic, owned by me, dark matters'; \r\n\r\n//replace source with this\r\nTHREE.Object3D.prototype.replace_object_with_this = function ( source ) {\r\n\r\n    this.uuid = source.uuid;\r\n    this.name = source.name;\r\n\r\n    this.up.copy( source.up );\r\n    this.position.copy( source.position );\r\n    this.quaternion.copy( source.quaternion );\r\n    this.scale.copy( source.scale );\r\n\r\n    this.matrix.copy( source.matrix );\r\n    this.matrixWorld.copy( source.matrixWorld );\r\n\r\n    this.matrixAutoUpdate = source.matrixAutoUpdate;\r\n    this.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\r\n\r\n    this.visible = source.visible;\r\n\r\n    this.castShadow = source.castShadow;\r\n    this.receiveShadow = source.receiveShadow;\r\n\r\n    this.frustumCulled = source.frustumCulled;\r\n    this.renderOrder = source.renderOrder;\r\n\r\n    this.userData = JSON.parse( JSON.stringify( source.userData ) );\r\n\r\n    //copy array of children, not clone\r\n    for ( var i = 0; i < source.children.length; i ++ ) {\r\n        this.add( source.children[ i ] );\r\n    }\r\n    source.parent.add(this);\r\n    source.parent.remove(source);\r\n    \r\n    this.animations = source.animations;\r\n}\r\n\r\n\r\n}\r\n\r\nMix_It();\r\n\r\nexport {Mix_It};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/mixins/threejs_mixins.js\n// module id = 19\n// module chunks = 0","import {My_Lib} from '../base/my_lib.js';\r\nimport {Particle_Affector} from './particle_affector.js';\r\n\r\nfunction Custom_Affector()\r\n{\r\n\tParticle_Affector.apply(this, arguments);\r\n    this.custom_func = function dummy () {return true;};\r\n}\r\n\r\n\r\nCustom_Affector.prototype = Object.create(Particle_Affector.prototype);\r\n\r\n_.copy_object(Custom_Affector.prototype, \r\n    {\r\n    constructor: Custom_Affector,\r\n   \taffect: function (dt, pdata, vert)\r\n\t{\r\n        return this.custom_func(dt, p, vert);\r\n\t},\r\n    test_func: function () {\r\n        var p = {\r\n            position: {x: 0, y: 0, z: 0},\r\n            velocity: {x: 0, y: 0, z: 0}\r\n        };\r\n        var color = {r: 0, g: 0, b: 0};\r\n        this.custom_func(p, color);\r\n    },\r\n    set_affect_function: function (source) {    \r\n        if (typeof source === 'function') {\r\n            this.custom_func = source;\r\n        } else if (typeof source  === 'string') {\r\n            try {\r\n                this.custom_func = new Function ('dt,p,vert', source);\r\n                this.test_func();\r\n            }\r\n            catch (e) {\r\n                alert(e);\r\n                this.custom_func = undefined;\r\n            }\r\n            this.source_code = source;\r\n        }\r\n    },\r\n    \r\n\ttoJSON: function ()\r\n\t{\r\n        var data = {\r\n            name: \"Custom_Affector\"\r\n        };\r\n\t\tdata.params = My_Lib.Particle_Affector.prototype.toJSON.call(this, this);\r\n\t\tparams[\"source_code\"] = this.source_code;\r\n\t\treturn data;\r\n\t},\r\n\tparse: function (json)\r\n\t{\r\n\t\tMy_Lib.Particle_Affector.prototype.parse(this, json);\r\n\t\tthis.set_affect_func(json.source_code);\r\n\t}\r\n\r\n});\r\n\r\nMy_Lib.Register_Class(\"Custom_Affector\", Custom_Affector);\r\n\r\nexport {Custom_Affector};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/particles/custom_affector.js\n// module id = 20\n// module chunks = 0","import {My_Lib} from '../base/my_lib.js';\r\nimport {Particle_Emitter} from './particle_emitter.js';\r\n\r\n\r\nfunction Custom_Emitter()\r\n{\r\n\tParticle_Emitter.apply(this, arguments);\r\n}\r\n\r\n\r\nCustom_Emitter.prototype = Object.create(Particle_Emitter.prototype);\r\n\r\nvar methods = {\r\n    emit: function (p, color) {\r\n        if (this.custom_func) {\r\n            this.custom_func(p, color);\r\n        }\r\n    },\r\n    test_func: function () {\r\n        var p = {\r\n            position: {x: 0, y: 0, z: 0},\r\n            velocity: {x: 0, y: 0, z: 0}\r\n        };\r\n        var color = {r: 0, g: 0, b: 0};\r\n        this.custom_func(p, color);\r\n    },\r\n    set_emit_function: function (source) {\r\n        if (typeof source === 'function') {\r\n            this.custom_func = source;\r\n        } else if (typeof source  === 'string') {\r\n            try {\r\n                this.custom_func = new Function ('p', 'color', source);\r\n                this.test_func();\r\n            }\r\n            catch (e) {\r\n                alert(e);\r\n                this.custom_func = undefined;\r\n            }\r\n            this.source_code = source;\r\n        }\r\n    },\r\n    toJSON: function () {\r\n        var data = {};\r\n        data.name = \"Custom_Emitter\";\r\n        data.params = My_Lib.Particle_Emitter.prototype.toJSON.call(this, this);\r\n        if (this.source_code) {\r\n            data.params.source_code = this.source_code;\r\n        }\r\n        return data;\r\n    },\r\n    parse: function (data) {\r\n        My_Lib.Particle_Emitter.prototype.parse.call(this, data);        \r\n        this.set_emit_function (data.source_code);\r\n    },\r\n    constructor: Custom_Emitter,\r\n};\r\n\r\n_.copy_object(Custom_Emitter.prototype, methods);\r\nMy_Lib.Register_Class(\"Custom_Emitter\", Custom_Emitter);\r\n\r\n\r\nfunction test()\r\n{\r\n    var t = new Custom_Emitter();\r\n    var source = 'p.position.z = -100; p.velocity.y = 100;';\r\n    t.set_emit_function(source);\r\n    var p = {\r\n        velocity: {x: 0, y: 0, z: 0},\r\n        position: {x: 0, y: 0, z: 0}\r\n    };\r\n    t.custom_func(p);\r\n    console.log(p);\r\n    var json = t.toJSON();\r\n    console.log(json);\r\n    \r\n    t = new Custom_Emitter();\r\n    t.parse(json.params);\r\n    //console.log(t.custom_func);    \r\n}\r\n\r\n//test();\r\n\r\n/*\r\nCustom_Emitter.prototype = Object.create(My_Lib.Particle_Emitter.prototype);\r\nCustom_Emitter.prototype.constructor = Cone_Emitter;\r\nMy_Lib.Register_Class(\"Custom_Emitter\", Cone_Emitter);\r\n*/\r\n\r\nexport {Custom_Emitter};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/particles/custom_emitter.js\n// module id = 21\n// module chunks = 0","import {My_Lib} from '../base/my_lib.js';\r\n\r\nvar Particle_Forces = {};\r\n\r\n//base class\r\nParticle_Forces.Force = function ()\r\n{\r\n}\r\n\r\n\r\n_.copy_object(Particle_Forces.Force.prototype,{\r\n\t\tcalc: function (dt, particle, acceleration) \r\n\t\t{\r\n\t\t},\r\n\t\ttoJSON: function (child) \r\n\t\t{\r\n\t\t\treturn {};\r\n\t\t},\r\n\t\tparse: function (json) \r\n\t\t{\r\n\t\t},\r\n});\r\n\r\n//constant force\r\nParticle_Forces.Constant_Force = function (force)\r\n{\r\n\tif (typeof force !== 'undefined') {\r\n\t\tthis.force = force;\r\n\t} else {\r\n\t\tthis.force = {x:0, y:0, z:0};\r\n\t}\r\n}\r\n\r\nParticle_Forces.Constant_Force.prototype = Object.create(Particle_Forces.Force.prototype);\r\n_.copy_object(Particle_Forces.Constant_Force.prototype, {\r\n\tconstructor: Particle_Forces.Constant_Force,\r\n\tcalc: function (dt, p, acceleration) \r\n\t{\r\n\t\tacceleration.x += this.force.x;\r\n\t\tacceleration.y += this.force.y;\r\n\t\tacceleration.z += this.force.z;\r\n\t},\r\n\ttoJSON: function (child)\r\n\t{\r\n\t\tvar data = {};\r\n\t\tdata.name = \"Constant_Force\";\r\n\t\tdata.force = _.create_clone_object(this.force);\r\n\t\treturn data;\r\n\t},\r\n\tparse: function (json)\r\n\t{\t\r\n\t\tif (json.force) {\r\n\t\t\t_.copy_object(this.force, json.force);\r\n\t\t}\r\n\t}\r\n});\r\n\r\nMy_Lib.Register_Class(\"Constant_Force\", Particle_Forces.Constant_Force);\r\n\r\nexport {Particle_Forces};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/particles/forces.js\n// module id = 22\n// module chunks = 0","import {My_Lib} from '../base/my_lib.js';\r\nimport {Point_Generators} from './point_generators.js';\r\nimport {Particle_Emitter} from './particle_emitter.js';\r\nimport {Particle_Affector} from './particle_affector.js';\r\n\r\nfunction  Cone_Emitter()\r\n{\r\n\tParticle_Emitter.apply(this, arguments);\r\n\tthis.generator = new Point_Generators.Random_Direction();\r\n\tthis.origin = new THREE.Vector3(1, 1, 0);\r\n\tthis.velocity = new THREE.Vector3(0, 1, 0);\r\n\tthis.dispersion = {\"min\": 5, \"max\": 10};\r\n\tthis.dispersion.delta = 5;\r\n\tthis.speed = {min: 5, max: 10, delta:5};\r\n\tthis.color = new THREE.Color(1, 1, 1);\r\n}\r\n\r\nCone_Emitter.prototype = Object.create(Particle_Emitter.prototype);\r\nCone_Emitter.prototype.constructor = Cone_Emitter;\r\nMy_Lib.Register_Class(\"Cone_Emitter\", Cone_Emitter);\r\n\r\nCone_Emitter.prototype.toJSON = function ()\r\n{\r\n\tvar data = {};\r\n\tdata.name = \"Cone_Emitter\";\r\n\tdata.params = Particle_Emitter.prototype.toJSON.call(this, this);\r\n\t_.clone_field_list_one_level_recursion(this, data.params, \r\n\t[\"origin\", \r\n\t\"velocity\", \r\n\t\"dispersion\",\r\n\t\"speed\"]);\r\n\t\r\n\treturn data;\r\n}\r\n\r\nCone_Emitter.prototype.parse = function (data)\r\n{\r\n\tParticle_Emitter.prototype.parse.call(this, data);\r\n\tthis.origin.copy(data.origin);\r\n\tthis.velocity.copy(data.velocity);\r\n\tthis.set_dispersion(data.dispersion.min, data.dispersion.max);\r\n\tthis.set_speed(data.speed.min, data.speed.max);\r\n}\r\n\r\nCone_Emitter.prototype.set_speed = function (min, max)\r\n{\r\n\tthis.speed.min = min;\r\n\tthis.speed.max = max;\r\n\tthis.speed.delta = max - min;\r\n}\r\n\r\n\r\nCone_Emitter.prototype.set_dispersion = function (min, max)\r\n{\r\n\tthis.dispersion.min = min;\r\n\tthis.dispersion.max = max;\r\n\tthis.dispersion.delta = max - min;\r\n}\r\n\r\n\r\n\r\n\r\nCone_Emitter.prototype.emit = function (p, color, matrix)\r\n{\r\n\tp.position.copy(this.origin);\r\n\t\r\n\tthis.generator.get_direction(p.velocity);\r\n\tp.velocity.multiplyScalar(Math.random()*this.dispersion.delta + this.dispersion.min);\t\r\n\tp.velocity.add(this.velocity).normalize();\r\n\t\r\n    if (matrix) {\r\n        p.position.applyMatrix4(matrix);\r\n        p.velocity.applyMatrix4_rotation(matrix);\r\n    }\r\n        \r\n\tp.velocity.multiplyScalar(Math.random()*this.speed.delta + this.speed.min);\t\r\n\t\r\n    \r\n\tif (color) {\r\n\t\tthis.emit_color(color);\r\n\t}\r\n    \r\n}\r\n\r\nCone_Emitter.prototype.emit_color = function (color) \r\n{\r\n\tcolor.copy(this.color);\r\n}\r\n\r\nfunction Sphere_Emitter(radius, speed)\r\n{\r\n\tParticle_Emitter.call(this);\r\n\tthis.radius = radius || 1;\r\n    this.speed = speed || 1;\r\n\tthis.generator = new Point_Generators.Sphere(radius);\r\n    this.from_center = true;\r\n    Object.defineProperty(this, 'radius', {\r\n        configurable: true,\r\n        enumerable: true,\r\n        set: function (value) { radius = value; generator.radius = value;}\r\n    });\r\n}\r\n\r\nSphere_Emitter.prototype = Object.create(Particle_Emitter.prototype);\r\n\r\n_.copy_object(Sphere_Emitter.prototype, {\r\n    constructor: Sphere_Emitter,\r\n    emit: function (p, color, matrix)\r\n    {\r\n        if (this.from_center) {\r\n            p.position.set(0,0,0);\r\n        } else {\r\n            this.generator.get_point(p.position);\r\n        }\r\n        this.generator.get_normal(p.velocity);\r\n        if (matrix) {\r\n            p.position.applyMatrix4(matrix);\r\n            p.velocity.applyMatrix4_rotation(matrix);\r\n        }\r\n        p.velocity.multiplyScalar(this.speed);\r\n    },\r\n    toJSON: function (json) {\r\n\t\tvar params = Particle_Emitter.prototype.toJSON.call(this, this);\r\n        params.radius = this.radius;\r\n        params.speed = this.speed;\r\n        //params.generator.radius = this.radius;\r\n    },\r\n    parse: function (json) {\r\n\t\tParticle_Emitter.prototype.parse.call(this, json);\r\n        this.radius = json.radius;\r\n        this.speed = json.speed;\r\n    }\r\n});\r\n\r\nMy_Lib.Register_Class(\"Sphere_Emitter\", Sphere_Emitter);\r\n\r\n\r\nfunction Star_Dust_Emitter ()\r\n{\r\n\tParticle_Emitter.apply(this, arguments);\r\n\tthis.start_position = new THREE.Vector3(0, 0, 0);\r\n\tthis.end_position = new THREE.Vector3(1, 1, 1);\r\n\tthis.delta = new THREE.Vector3(1, 1, 1);\t\r\n\tthis.velocity = new THREE.Vector3(0, 0, 1);\r\n}\r\n\r\nStar_Dust_Emitter.prototype = Object.create(Particle_Emitter.prototype);\r\nStar_Dust_Emitter.prototype.constructor = Star_Dust_Emitter;\r\n_.copy_object( Star_Dust_Emitter.prototype,{\r\n\tset_velocity: function (x,y, z) \r\n\t{\r\n\t\tthis.velocity.set(x, y, z);\r\n\t},\r\n\tset_position_range : function (start, end)\r\n\t{\r\n\t\tthis.start_position.copy(start);\r\n\t\tthis.end_position.copy(end);\r\n\t\tthis.delta.set(end.x - start.x, end.y-start.y, end.z-start.z);\r\n\t\t\r\n\t},\r\n\tget_position: function (vector)\r\n\t{\r\n\t\tvector.x = Math.random() * this.delta.x + this.start_position.x;\r\n\t\tvector.y = Math.random() * this.delta.y + this.start_position.y;\r\n\t\tvector.z = Math.random() * this.delta.z + this.start_position.z;\r\n\t},\r\n\tget_velocity: function (vector)\r\n\t{\r\n\t\tvector.x = this.velocity.x;\r\n\t\tvector.y = this.velocity.y;\r\n\t\tvector.z = this.velocity.z;\r\n\t},\r\n\temit: function (p)\r\n\t{\r\n\t\tthis.get_position(p.position);\r\n\t\tif (this.parent) {\r\n\t\t\tthis.parent.localToWorld(p.position);\r\n\t\t}\r\n\t\tthis.get_velocity(p.velocity);\r\n\t},\r\n\ttoJSON: function ()\r\n\t{\r\n\t\tvar params = Particle_Emitter.prototype.toJSON.call(this, this);\r\n\t\t_.clone_field_list_one_level_recursion(this, params, [\"velocity\", \r\n\t\t\"start_position\",\r\n\t\t\"end_position\"])\r\n\t\tvar data = {\r\n\t\t\t\"name\": \"Star_Dust_Emitter\",\r\n\t\t\t\"params\": params,\r\n\t\t};\r\n\t\treturn data;\r\n\t},\r\n\tparse: function (json)\r\n\t{\r\n\t\tParticle_Emitter.prototype.parse.call(this, json);\r\n\t\tthis.set_position_range(json.start_position, json.end_position);\r\n\t\tthis.velocity.copy(json.velocity);\r\n\t}\r\n\t\r\n});\r\n\r\nMy_Lib.Register_Class(\"Star_Dust_Emitter\", Star_Dust_Emitter);\r\n\r\n\r\nfunction Star_Dust_Affector (end)\r\n{\r\n\tthis.end = end || 0;\r\n}\r\n\r\n\r\nStar_Dust_Affector.prototype = Object.create(Particle_Affector.prototype);\r\nStar_Dust_Affector.prototype.constructor = Star_Dust_Affector;\r\n\r\n_.copy_object(Star_Dust_Affector.prototype,{\r\n\taffect: function (dt, pdata, vert)\r\n\t{\r\n\t\tif (pdata.position.z > this.end) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\ttoJSON: function ()\r\n\t{\r\n\t\tvar params = Particle_Affector.prototype.toJSON.call(this, this);\r\n\t\tparams[\"end\"] = this.end;\r\n\t\tvar data = {\r\n\t\t\t\"name\": \"Star_Dust_Affector\",\r\n\t\t\t\"params\": params,\r\n\r\n\t\t};\r\n\t\treturn data;\r\n\t},\r\n\tparse: function (json)\r\n\t{\r\n\t\tParticle_Affector.prototype.parse(this, json);\r\n\t\tthis.end = json.end;\r\n\t}\r\n});\r\n\r\nMy_Lib.Register_Class(\"Star_Dust_Affector\", Star_Dust_Affector);\r\n\r\nexport {Cone_Emitter, Star_Dust_Emitter, Sphere_Emitter, Star_Dust_Affector};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/particles/test_emitters.js\n// module id = 23\n// module chunks = 0"],"sourceRoot":""}