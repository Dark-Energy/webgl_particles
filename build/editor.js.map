{"version":3,"sources":["webpack:///editor.js","webpack:///webpack/bootstrap 816df26b4431ef110f22","webpack:///./src/base/my_lib.js","webpack:///./src/particles/particle_affector.js","webpack:///./src/particles/particle_emitter.js","webpack:///./src/base/mouse_camera_controller.js","webpack:///./src/particles/particles_points.js","webpack:///./src/base/event_hub.js","webpack:///./src/base/mouse_intersector.js","webpack:///./src/base/simple_collider.js","webpack:///./src/gui/color_picker.js","webpack:///./src/gui/particles_panel.js","webpack:///./src/gui/particles_props.js","webpack:///./src/gui/texture_panel.js","webpack:///./src/particles/color_domain.js","webpack:///./src/particles/particle_shaders.js","webpack:///./src/particles/particles.js","webpack:///./src/particles/particles_manager.js","webpack:///./src/particles/point_generators.js","webpack:///./src/engine_main_webpack.js","webpack:///./src/gui_main_webpack.js","webpack:///./src/app/application.js","webpack:///./src/base/animations.js","webpack:///./src/base/loading_manager.js","webpack:///./src/base/package_manager.js","webpack:///./src/base/scene_serializer.js","webpack:///./src/editor_webpack_dev.js","webpack:///./src/gui/vueapp.js","webpack:///./src/mixins/camera_mixin.js","webpack:///./src/mixins/threejs_mixins.js","webpack:///./src/particles/custom_affector.js","webpack:///./src/particles/custom_emitter.js","webpack:///./src/particles/forces.js","webpack:///./src/particles/test_emitters.js"],"names":["modules","installedModules","__webpack_require__","moduleId","exports","module","i","l","call","m","c","value","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","getDefault","getModuleExports","object","property","prototype","hasOwnProperty","p","s","__webpack_exports__","My_Lib","Viewport","Object_Animation","animation","this","update","dt","create_text_image","width","height","text","npot","background","canvas","document","createElement","context","getContext","fillStyle","fillRect","font","fillText","texture","THREE","Texture","wrapS","wrapT","TextureWrapping","ClampToEdgeWrapping","minFilter","LinearFilter","needsUpdate","Create_Quad","vertex_shader","fragment_shader","plane","PlaneBufferGeometry","material","ShaderMaterial","vertexShader","fragmentShader","quad","Mesh","rotation","y","Math","PI","Render_Target","target","WebGLRenderTarget","magFilter","NearestFilter","format","RGBFormat","camera","PerspectiveCamera","render","scene","renderer","create_overlay_camera","OrthographicCamera","Overlay","autoClear","Mouse_Controller","root","over","click","callback","event_hub","Event_Hub","events","add_event_listener","func","obj","push","on","emit","listeners","length","t","run_function","window","setTimeout","create_run_function","app","run","loop","Euler_Controller","x","z","xspeed","yspeed","zspeed","Registered_Classes","Register_Class","console","log","Get_Class","create_class","parent","child","props","create","_","copy_object","contructor","Abstract_Fabric","data","constructor","type","parse","undefined","Print_Classes","key","Particle_Affector","__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__","id","generateUUID","affect","pdata","vert","color","toJSON","params","json","Force_Affector","forces","Array","add_force","force","apply_forces","particle","acceleration","calc","velocity","uuid","f","item","Particle_Emitter","emit_per_second","emit_delta","emit_count","lifetime","min","max","emit_life","random","calc_emitted_particles","need_emit","floor","matrix","position","set","applyMatrix4","applyMatrix4_rotation","Mouse_Camera_Controller","error","set_canvas_info","offset","getBoundingClientRect","left","top","clientWidth","clientHeight","refresh_canvas","new_canvas","get_normalized_screen_coordinates","vector","Vector3","get_normalize_mouse_position","event","clientX","clientY","unproject","r","copy","get_ray_from_camera_in_screen_coordinates","ray","Ray","sub","normalize","get_ray_from_camera_in_mouse_position","Particles_Points","geometry","Points","boundingSphere","Sphere","radius","getBoundingSphere","meta","mat","geom","Object3D","raycast","raycaster","intersects","sphere","matrixWorld","intersectsSphere","shit","tr","tmp","distance","sqrt","dot","point","main_event_hub","Mouse_Intersector","__WEBPACK_IMPORTED_MODULE_0__simple_collider_js__","__WEBPACK_IMPORTED_MODULE_1__mouse_camera_controller_js__","get_normalized_screen_coords","mouse_coords_to_vector","mouse_coords_to_ray","find_intersection_with_mouse_vector","Raycaster","intersectObjects","find_intersected_object","collider","check_ray","Simple_Collider","recursive","check_invisible","intersected_objects","_tested_sphere","prepare_check","intersected_map","_fakecaster","find_intersection_with_bounding_sphere","add_intersected","check_object_bounding_sphere","computeBoundingSphere","updateMatrixWorld","inter","non_collideble","visible","children","Color_Picker","default","g","b","template","new_value","changed","methods","$emit","Particles_Panel","__WEBPACK_IMPORTED_MODULE_0__particles_props_js__","__WEBPACK_IMPORTED_MODULE_1__texture_panel_js__","textures","selected","String","first_time","texture_panel_is_visible","add_to_select","my_selected","create_particles","remove_particles","particles","change_colors","show_texture_panel","particle_params","select_particles","get_particle_params","play","self","created","$on","arr","watch","new_selected","components","ParticlesProps","texture-panel","Behavior","Particles_Props","__WEBPACK_IMPORTED_MODULE_0__color_picker_js__","Blending_Selector","required","blending","behavior","show_behavior","Particle_Params","fire","$parent","selected_texture","texture_width","texture_height","panel_visible","show_panel","checked","update_color","blending-mode","draw_texture","particle-params","Texture_Panel","choose_texture","object_id","fill","texture_format_to_string","image","Table_Color","naturalWidth","table","naturalHeight","$refs","my_draw_image","get_texture_from_particles","copy_table","mounted","src","Color_Domain","Color","Particle_Shaders","default_table","index","ceil","Particle_System","emitter","affector","particle_lifetime","dynamic_color","create_particle_material","config_params","no_fade_color","pre_alpha","apply_world_matrix_on_emit","suicide","join","__WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__","__WEBPACK_IMPORTED_MODULE_2__particle_affector_js__","__WEBPACK_IMPORTED_MODULE_3__particles_points_js__","__WEBPACK_IMPORTED_MODULE_4__particle_shaders_js__","__WEBPACK_IMPORTED_MODULE_5__color_domain_js__","create_particle_data","colors","Float32Array","count","particle_data","vertices","node","create_particle_geometry","color_domain","depth_write","setDynamic","buffer","addAttribute","discrete_emit","emit_particles","set_name","old_need_emit","remove","verts","update_particle_geometry","dummy_color","discrete_emission","BufferAttribute","generate_material_name","my_name","OneFactor","array","SrcAlphaFactor","OneMinusSrcAlphaFactor","convert_blending_mode","three_blending","factors","blending_mode","set_texture","uniforms","recreate_material","create_uniforms","size","defines","additive","blendDst","blendSrc","one_alpha","select_texture","alpha_one","blend_obj","calc_defines","depthWrite","Texture_Manager","sprite","point_size","set_emitter","val","set_emission_per_second","transparent","set_bounding_sphere_radius","depthTest","vertex","fragment","set_pre_alpha","set_point_size","particles_array","ps","get_particle_names","names","set_particle_life_length","create_by_params","set_particle_count","set_color","emitter_fabric","Particle_Manager","fromJSON","indexOf","add","__WEBPACK_IMPORTED_MODULE_4__particles_js__","load_particles","replace_object_with_this","begin_name","testing","number","affector_fabric","JSON","e","Point_Generators","Random_Direction","alpha","cos","sin","get_normal","multiplyScalar","getObjectByProperty","create_name","create_new","particle_manager","Particles_Config","box_size","get_direction","get_inner_point","beta","get_point","__WEBPACK_IMPORTED_MODULE_0__base_event_hub_js__","__WEBPACK_IMPORTED_MODULE_1__base_my_lib_js__","__WEBPACK_IMPORTED_MODULE_2__base_animations_js__","__WEBPACK_IMPORTED_MODULE_3__base_mouse_intersector_js__","__WEBPACK_IMPORTED_MODULE_4__base_mouse_camera_controller_js__","__WEBPACK_IMPORTED_MODULE_5__base_loading_manager_js__","__WEBPACK_IMPORTED_MODULE_6__base_package_manager_js__","__WEBPACK_IMPORTED_MODULE_7__particles_particles_points_js__","__WEBPACK_IMPORTED_MODULE_8__particles_particle_emitter_js__","__WEBPACK_IMPORTED_MODULE_9__particles_forces_js__","__WEBPACK_IMPORTED_MODULE_10__particles_particle_affector_js__","__WEBPACK_IMPORTED_MODULE_11__particles_point_generators_js__","__WEBPACK_IMPORTED_MODULE_12__particles_custom_emitter_js__","__WEBPACK_IMPORTED_MODULE_13__particles_custom_affector_js__","__WEBPACK_IMPORTED_MODULE_14__particles_test_emitters_js__","__WEBPACK_IMPORTED_MODULE_15__particles_particle_shaders_js__","__WEBPACK_IMPORTED_MODULE_16__particles_particles_js__","__WEBPACK_IMPORTED_MODULE_17__particles_particles_manager_js__","__WEBPACK_IMPORTED_MODULE_18__base_scene_serializer_js__","__WEBPACK_IMPORTED_MODULE_19__mixins_threejs_mixins_js__","__WEBPACK_IMPORTED_MODULE_20__mixins_camera_mixin_js__","__WEBPACK_IMPORTED_MODULE_21__app_application_js__","__WEBPACK_IMPORTED_MODULE_22__particles_color_domain_js__","__WEBPACK_IMPORTED_MODULE_23__base_simple_collider_js__","requestAnimationFrame","__WEBPACK_IMPORTED_MODULE_0__gui_vueapp_js__","_create_loop_function","__WEBPACK_IMPORTED_MODULE_1__gui_color_picker_js__","__WEBPACK_IMPORTED_MODULE_2__gui_texture_panel_js__","__WEBPACK_IMPORTED_MODULE_3__gui_particles_props_js__","__WEBPACK_IMPORTED_MODULE_4__gui_particles_panel_js__","Application","__WEBPACK_IMPORTED_MODULE_1__base_event_hub_js__","__WEBPACK_IMPORTED_MODULE_2__base_mouse_intersector_js__","_lifecycle_event","dom_screen","viewport","config","_set_configuration","main_scene","Scene","clock","Clock","delta_time","main_camera","get_default_configuration","load_configuration","xhr","premultipliedAlpha","configuration_is_applied","clear_color","near","far","apply_configuration","alert","getElementById","dom_element","default_config","WebGLRenderer","render_params","appendChild","domElement","set_viewport","setClearColor","_create_main_scene","prevent","Child","fov","aspect_ratio","aspect","extend_proto","updateProjectionMatrix","delta","url","do_update","XHRLoader","onload","animated_objects","progress","status","before_update","pre_update","extend","child_func","mouse_move_listener","apply","arguments","addEventListener","len","mouse_controllers","proto","add_mouse_controller","getDelta","create_mouse_move_listener","remove_animated_object","splice","update_all","time_scale","Base_Animation","stopped","find_mouse_over_intersections","calc_animation","configuration","Euler_Animation","Scale_Animation","__WEBPACK_IMPORTED_MODULE_0__my_lib_js__","scaled_dt","param","time","stop","yscale","start","reset","xscale","zscale","scale","Chain_Loader","list","load","next","resource","do_error","onerror","stop_by_error","do_progress","onprogress","load_func","first","test_chain_loader","cl","item_loaded","Loading_Manager","get_async","texture_loader","finished","load_list","on_resource_loaded","on_load","load_list_json","resources","TextureLoader","state","Package_Manager","defaults","resource_list","on_progress","pack","load_list_textures","loader","animation_library","animations","parse_package_description","Scene_Serializer","bind_animations","bindings","copy_animations","bind","data_loaded","anims","create_animations","myanimations","getObjectByName","scene_loaded","anim","animdata","anim_uuid","add_animation","load_from_json","Vue","el","ObjectLoader","app2","__WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__","get_forward_plane_by_object","get_ray_from_screen_coordinates","Mixin","__WEBPACK_IMPORTED_MODULE_1__gui_main_webpack_js__","Object3D_Animation_Mixin","create_vue_app","particles-panel","__WEBPACK_IMPORTED_MODULE_0__particles_panel_js__","__WEBPACK_IMPORTED_MODULE_0__base_mouse_camera_controller_js__","old_toJson","Object3D_Serialization_Mixin","standard_serialization","Plane","negate","dist","mc","stringify","userData","Mix_It","elements","remove_animation","materials","collect_geometry","geometries","extractFromCache","isRootObject","output","castShadow","receiveShadow","images","toArray","metadata","generator","collect_materials","collect_animations_recursive","toJSON1","cache","values","source","quaternion","frustumCulled","renderOrder","collect_animations","dummy","Custom_Affector","set_affect_function","test_func","dm_mark","source_code","up","matrixAutoUpdate","set_affect_func","matrixWorldNeedsUpdate","custom_func","__WEBPACK_IMPORTED_MODULE_1__particle_affector_js__","set_emit_function","Function","Custom_Emitter","Particle_Forces","Force","Constant_Force","create_clone_object","test","Cone_Emitter","origin","set_dispersion","Star_Dust_Emitter","Sphere_Emitter","Star_Dust_Affector","__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__","__WEBPACK_IMPORTED_MODULE_3__particle_affector_js__","from_center","__WEBPACK_IMPORTED_MODULE_1__point_generators_js__","dispersion","speed","clone_field_list_one_level_recursion","set_speed","end_position","set_velocity","start_position","get_position","get_velocity","set_position_range","end","localToWorld"],"mappings":"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","file":"editor.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// identity function for calling harmony imports with the correct context\n/******/ \t__webpack_require__.i = function(value) { return value; };\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 24);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return My_Lib; });\n/*\r\n*/\n\nvar My_Lib = {};\n\nMy_Lib.Viewport = {};\n\nMy_Lib.Object_Animation = function (object, animation) {\n\tthis.object = object;\n\tthis.animation = animation;\n};\n\nMy_Lib.Object_Animation.prototype.update = function (dt) {\n\tthis.animation(this.object, dt);\n};\n\nMy_Lib.create_text_image = function (width, height, text, npot, background) {\n\t// create a canvas element\n\tvar canvas = document.createElement('canvas');\n\tcanvas.width = width;\n\tcanvas.height = height;\n\tvar context = canvas.getContext('2d');\n\tif (background) {\n\t\tcontext.fillStyle = background;\n\t\tcontext.fillRect(0, 0, canvas.width, canvas.height);\n\t}\n\tcontext.font = \"Bold 40px Arial\";\n\tcontext.fillStyle = \"rgba(0,255,0,0.95)\";\n\tcontext.fillText('Hello, world!', 0, 50);\n\n\t// canvas contents will be used for a texture\n\tvar texture = new THREE.Texture(canvas);\n\tif (npot) {\n\t\ttexture.wrapS = texture.wrapT = THREE.TextureWrapping.ClampToEdgeWrapping;\n\t\ttexture.minFilter = THREE.LinearFilter;\n\t}\n\ttexture.needsUpdate = true;\n\treturn texture;\n};\n\nMy_Lib.Create_Quad = function (width, height, vertex_shader, fragment_shader) {\n\t//plane created turn away from camera\n\tvar plane = new THREE.PlaneBufferGeometry(width, height);\n\n\tvar material = new THREE.ShaderMaterial({\n\t\tvertexShader: vertex_shader,\n\t\tfragmentShader: fragment_shader\n\t});\n\n\tvar quad = new THREE.Mesh(plane, material);\n\tquad.rotation.y = Math.PI;\n\treturn quad;\n};\n\nMy_Lib.Render_Target = function (width, height) {\n\tthis.target = new THREE.WebGLRenderTarget(width, height, {\n\t\tminFilter: THREE.LinearFilter,\n\t\tmagFilter: THREE.NearestFilter,\n\t\tformat: THREE.RGBFormat\n\t});\n\n\tthis.camera = new THREE.PerspectiveCamera(80, width / height, 0.1, 1000);\n};\n\nMy_Lib.Render_Target.prototype.render = function (scene, renderer) {\n\trenderer.render(scene, this.camera, this.target, true //forceClear\n\t);\n};\n\nMy_Lib.create_overlay_camera = function (width, height) {\n\tvar camera = new THREE.OrthographicCamera(width / -2, width / 2, height / 2, height / -2, -10000, 10000);\n\treturn camera;\n};\n\nMy_Lib.Overlay = function (width, height) {\n\tthis.camera = My_Lib.create_overlay_camera(width, height);\n};\n\nMy_Lib.Overlay.prototype.render = function (renderer) {\n\tif (!this.scene) {\n\t\treturn;\n\t}\n\n\trenderer.autoClear = false;\n\trenderer.render(this.scene, this.camera);\n\trenderer.autoClear = true;\n};\n\nMy_Lib.Mouse_Controller = function (root, over, click, callback) {\n\tthis.root = root;\n\tthis.over = over;\n\tthis.click = !!click;\n\tthis.callback = callback;\n};\n\n/*\r\nugly hack\r\n*/\n\nMy_Lib.event_hub = new Event_Hub();\n\nfunction Event_Hub() {\n\tthis.events = {};\n}\n\nEvent_Hub.prototype.add_event_listener = function (name, func, obj) {\n\tif (!this.events[name]) {\n\t\tthis.events[name] = [];\n\t}\n\tthis.events[name].push({ name: name, func: func, obj: obj });\n};\n\nEvent_Hub.prototype.on = Event_Hub.prototype.add_event_listener;\n\nEvent_Hub.prototype.emit = function (name, obj) {\n\tvar listeners = this.events[name];\n\tif (listeners) {\n\t\tfor (var i = 0; i < listeners.length; i++) {\n\t\t\tvar t = listeners[i];\n\t\t\tt.func.call(t.obj, obj);\n\t\t}\n\t}\n};\n\nvar run_function = //window.requestAnimationFrame;\nfunction (callback) {\n\twindow.setTimeout(callback, 1000 / 60);\n};\n\nMy_Lib.create_run_function = function (app) {\n\tMy_Lib.run = function () {\n\t\trun_function(function () {\n\t\t\tapp.loop();\n\t\t});\n\t};\n};\n\nMy_Lib.Euler_Controller = function (obj, x, y, z) {\n\tthis.obj = obj;\n\tthis.xspeed = x * Math.PI / 180;;\n\tthis.yspeed = y * Math.PI / 180;;\n\tthis.zspeed = z * Math.PI / 180;;\n};\n\nMy_Lib.Euler_Controller.prototype.update = function (dt) {\n\tthis.obj.rotation.x += this.xspeed * dt;\n\tthis.obj.rotation.y += this.yspeed * dt;\n\tthis.obj.rotation.z += this.zspeed * dt;\n};\n\n//Class Library\nMy_Lib.Registered_Classes = {};\n\nMy_Lib.Register_Class = function (name, func) {\n\tif (My_Lib.Registered_Classes[name]) {\n\t\tconsole.log(\"Register Class ERROR! Class with this name already exists!\", name);\n\t}\n\tMy_Lib.Registered_Classes[name] = func;\n};\n\nMy_Lib.Get_Class = function (name) {\n\treturn My_Lib.Registered_Classes[name];\n};\n\nMy_Lib.create_class = function (parent, child, props, name) {\n\tif (parent) {\n\t\tchild.prototype = Object.create(parent.prototype);\n\t}\n\t_.copy_object(child.prototype, props);\n\tchild.prototype.contructor = child;\n\tMy_Lib.Register_Class(child, name);\n};\n\nMy_Lib.Abstract_Fabric = function (data) {\n\tvar constructor = My_Lib.Get_Class(data.type);\n\tif (constructor) {\n\t\tvar object = new constructor();\n\t\tobject.parse(data);\n\t\treturn object;\n\t}\n\treturn undefined;\n};\n\nMy_Lib.Print_Classes = function () {\n\tfor (var key in this.Registered_Classes) {\n\t\tconsole.log(\"class registered :\", key, this.Registered_Classes[key]);\n\t}\n};\n\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particle_Affector; });\n/* unused harmony export Force_Affector */\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n\n\n//base class for particle affector\nfunction Particle_Affector() {\n\tthis.id = _.generateUUID();\n}\n\nParticle_Affector.prototype.affect = function (dt, pdata, vert, color) {\n\treturn true;\n};\n\nParticle_Affector.prototype.toJSON = function (child) {\n\tif (child) {\n\t\treturn {};\n\t}\n\tvar data = {\n\t\tid: this.id,\n\t\t\"name\": \"Particle_Affector\",\n\t\tparams: {}\n\t};\n\tif (child) {\n\t\treturn params;\n\t}\n\treturn data;\n};\n\nParticle_Affector.prototype.parse = function (json) {};\n\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Particle_Affector\", Particle_Affector);\n\nfunction Force_Affector() {\n\tParticle_Affector.call(this);\n\tthis.forces = new Array();\n}\n\nForce_Affector.prototype = Object.create(Particle_Affector.prototype);\n\n_.copy_object(Force_Affector.prototype, {\n\tconstructor: Force_Affector,\n\tadd_force: function (force) {\n\t\tthis.forces.push(force);\n\t},\n\tapply_forces: function (dt, particle, vert, color) {\n\t\tvar acceleration = { x: 0, y: 0, z: 0 };\n\t\tfor (var i = 0; i < this.forces.length; i++) {\n\t\t\tthis.forces[i].calc(dt, particle, acceleration);\n\t\t}\n\t\t//integrate\n\t\tparticle.velocity.x += acceleration.x * dt;\n\t\tparticle.velocity.y += acceleration.y * dt;\n\t\tparticle.velocity.z += acceleration.z * dt;\n\t},\n\taffect: function (dt, particle, vert, color) {\n\t\tthis.apply_forces(dt, particle, vert, color);\n\t\treturn true;\n\t},\n\ttoJSON: function (child) {\n\t\tvar data = {};\n\t\tdata.name = \"Force_Affector\";\n\t\tdata.uuid = this.uuid;\n\t\tdata.params = Particle_Affector.prototype.toJSON.call(this, this);\n\t\tif (this.forces.length > 0) {\n\t\t\tdata.params.forces = new Array();\n\t\t\tfor (var i = 0; i < this.forces.length; i++) {\n\t\t\t\tdata.params.forces.push(this.forces[i].toJSON());\n\t\t\t}\n\t\t}\n\t\treturn data;\n\t},\n\tparse: function (json) {\n\t\tvar f, item;\n\t\tif (json.forces) {\n\n\t\t\tfor (var i = 0; i < json.forces.length; i++) {\n\t\t\t\titem = json.forces[i];\n\t\t\t\tf = __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Get_Class(item.name);\n\t\t\t\tif (f) {\n\t\t\t\t\tf = new f();\n\t\t\t\t\tf.parse(item);\n\t\t\t\t\tthis.add_force(f);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});\n\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Force_Affector\", Force_Affector);\n\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particle_Emitter; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n\n\n//Base class for Particle Emitters\nfunction Particle_Emitter(emit_per_second) {\n\tthis.uuid = _.generateUUID();\n\tthis.name = '';\n\tthis.emit_delta = 0;\n\tthis.emit_count = 0;\n\tthis.emit_per_second = emit_per_second || 5;\n\t//linear interpolation = min + random * (max-min)\t\n\tthis.lifetime = { \"min\": 0, \"max\": 2.0 };\n}\n\nParticle_Emitter.prototype.emit_life = function () {\n\treturn this.lifetime.min + Math.random() * (this.lifetime.max - this.lifetime.min);\n};\n\nParticle_Emitter.prototype.calc_emitted_particles = function (dt) {\n\t//count particles need emit\n\tthis.emit_delta += this.emit_per_second * dt;\n\tvar need_emit = Math.floor(this.emit_delta);\n\tif (need_emit > 0) {\n\t\tthis.emit_delta -= need_emit;\n\t\t//this.emit_count += need_emit;\n\t\t//need_emit = this.emit_count;\n\t}\n\treturn need_emit;\n};\n\nParticle_Emitter.prototype.emit = function (p, c, matrix) {\n\tp.position.set(0, 0, 0);\n\tp.velocity.set(0, 1, 0);\n\n\tif (matrix) {\n\t\tp.position.applyMatrix4(matrix);\n\t\tp.velocity.applyMatrix4_rotation(matrix);\n\t}\n};\n\nParticle_Emitter.prototype.toJSON = function (child) {\n\tvar params = {\n\t\t\"uuid\": this.uuid,\n\t\t\"emit_per_second\": this.emit_per_second,\n\t\t\"lifetime\": {\n\t\t\t\"min\": this.lifetime.min,\n\t\t\t\"max\": this.lifetime.max\n\t\t}\n\t};\n\tif (this.name) {\n\t\tparams.name = this.name;\n\t}\n\tif (child) {\n\t\treturn params;\n\t}\n\tvar data = {};\n\tdata.name = \"Particle_Emitter\";\n\tdata.params = params;\n\treturn data;\n};\n\nParticle_Emitter.prototype.parse = function (data) {\n\tthis.emit_per_second = data.emit_per_second;\n\tthis.name = data.name;\n\tthis.uuid = data.uuid || _.generateUUID();\n\t_.copy_object(this.lifetime, data.lifetime);\n};\n\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Particle_Emitter\", Particle_Emitter);\n\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Mouse_Camera_Controller; });\n//Unfortunately, canvas properties can change permanenty. \n//Because, you need do refresh_canvas on each call!\n//each time you need recacl BoundingRect and clientRect of the fucking canvas\n//also, camera may be not that camera, who render scene. it may be other camera\n//because you need refresh camera on eash call\n//i could done this normal function, but this object may do different job\n//this is single-time object\n//it easy economyfy number of arguments on calling functions\n\n//not, this class doesn't store reference to canvas, \n//this store only information about canvas size and position \n//i.e. BoundingClientRect and clientWidth,clientHeight\n//yes, this class store reference to camera\n\n//probably, it may be mixin to camera\n\n\nfunction Mouse_Camera_Controller(canvas, camera) {\n    if (canvas === undefined) {\n        console.error(\"Mouse_Camera_Controller. Propable premordial creating object. canvas is undefined. Do nothing\");\n    } else {\n        this.set_canvas_info(canvas);\n    }\n    this.camera = camera;\n}\n\n_.copy_object(Mouse_Camera_Controller.prototype, {\n    constructor: Mouse_Camera_Controller,\n    set_canvas_info: function (canvas) {\n        var offset = canvas.getBoundingClientRect();\n        this.offset = {\n            left: offset.left,\n            top: offset.top\n        };\n        this.width = canvas.clientWidth;\n        this.height = canvas.clientHeight;\n    },\n    refresh_canvas: function (new_canvas) {\n        this.set_canvas_info(new_canvas);\n    },\n\n    get_normalized_screen_coordinates: function (x, y) {\n        //step 1 : normalized\n        x = (x - this.offset.left) / this.width;\n        y = (y - this.offset.top) / this.height;\n        //step 2 : from unsigned to signed, translate origin from top left corner to center \n        var x = x * 2.0 - 1.0;\n        var y = -(y * 2.0 - 1.0);\n        var vector = new THREE.Vector3(x, y, 1);\n        return vector;\n    },\n\n    //do some what prevent method, only give mouse event instead x,y coordiantes\n    get_normalize_mouse_position: function (event) {\n        return this.get_normalized_screen_coordinates(event.clientX, event.clientY);\n    },\n\n    //return new unproject vector, not change given\n    //used THREE.Vector3.unproject method\n    //including apply inver camera matrix\n    //on my view, that wrong, because method do it big then promise\n    //unproject must do only unproject, not else thing\n    //because my need new method, who will do only unproject \n    unproject: function (vector) {\n        var r = new THREE.Vector3();\n        r.copy(vector);\n        r.unproject(this.camera);\n        //this aready done \n        //r.applyMatrix4(camera.matrixWorldInverse);    \n        return r;\n    },\n\n    //get ray with origin in camera position and direction, \n    //pointed to far away where unproject screen point are\n    get_ray_from_camera_in_screen_coordinates: function (x, y) {\n        var vector = this.get_normalized_screen_coordinates(x, y);\n        vector = this.unproject(vector);\n        var ray = new THREE.Ray(this.camera.position, vector.sub(this.camera.position).normalize());\n        return ray;\n    },\n\n    //do same what prevent method, only give mouse event for convience\n    //see it as overriding function in C++\n    get_ray_from_camera_in_mouse_position: function (event) {\n        return this.get_ray_from_camera_in_screen_coordinates(event.x, event.y);\n    }\n\n});\n\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particles_Points; });\n\nfunction Particles_Points(geometry, material) {\n    THREE.Points.call(this, geometry, material);\n    this.type = 'particles_points';\n\n    this.boundingSphere = new THREE.Sphere();\n    this.boundingSphere.radius = 10.0;\n}\n\nParticles_Points.prototype = Object.create(THREE.Points.prototype);\n\nParticles_Points.prototype.constructor = Particles_Points;\n\nParticles_Points.prototype.getBoundingSphere = function () {\n    return this.boundingSphere;\n};\n\nParticles_Points.prototype.toJSON = function (meta) {\n    var mat = this.material;\n    var geom = this.geometry;\n    this.material = undefined;\n    this.geometry = undefined;\n    var object = THREE.Object3D.prototype.toJSON.call(this, meta);\n    this.material = mat;\n    this.geometry = geom;\n    return object;\n};\n\n//WTF?\nParticles_Points.prototype.raycast = function (raycaster, intersects) {\n    var sphere = new THREE.Sphere();\n    sphere.copy(this.boundingSphere);\n    sphere.applyMatrix4(this.matrixWorld);\n    var r = raycaster.ray.intersectsSphere(sphere);\n    if (r === false) return;\n    console.log(\"INTERSECTION1\", this.name, sphere);\n    return;\n\n    var shit = new THREE.Vector3();\n    shit.copy(this.position);\n    var tr = new THREE.Ray(new THREE.Vector3(0, 0, 20), shit);\n    console.log(\"test \", tr.intersectsSphere(sphere), sphere);\n    console.log(\"hit sphere \" + this.name, sphere, raycaster.ray);\n    return raycaster.ray.intersectsSphere(sphere);\n\n    console.log(\"hit sphere \" + this.type, \"shpere is \", sphere, \"ray is \", r);\n    if (r) {\n        var tmp = new THREE.Vector3(this.position);\n        tmp.sub(r);\n        intersects.push({\n            distance: Math.sqrt(tmp.dot(tmp)),\n            point: this.position,\n            object: this\n        });\n    }\n};\n\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return main_event_hub; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return Event_Hub; });\nfunction Event_Hub() {\n    this.events = {};\n}\n\nEvent_Hub.prototype.add_event_listener = function (name, func, obj) {\n    if (!this.events[name]) {\n        this.events[name] = [];\n    }\n    this.events[name].push({ name: name, func: func, obj: obj });\n};\n\nEvent_Hub.prototype.on = Event_Hub.prototype.add_event_listener;\n\nEvent_Hub.prototype.emit = function (name, obj) {\n    var listeners = this.events[name];\n    if (listeners) {\n        for (var i = 0; i < listeners.length; i++) {\n            var t = listeners[i];\n            t.func.call(t.obj, obj);\n        }\n    }\n};\n\nvar main_event_hub = new Event_Hub();\n\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Mouse_Intersector; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__simple_collider_js__ = __webpack_require__(7);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__mouse_camera_controller_js__ = __webpack_require__(3);\nvar Mouse_Intersector = {};\n\n\n\n\nMouse_Intersector.get_normalized_screen_coords = function (canvas, x, y) {\n\t\t\t\tvar offset = canvas.getBoundingClientRect();\n\t\t\t\tvar width = canvas.clientWidth;\n\t\t\t\tvar height = canvas.clientHeight;\n\t\t\t\t//normalize coordinates\n\t\t\t\tvar x = (x - offset.left) / width;\n\t\t\t\tvar y = (y - offset.top) / height;\n\t\t\t\tvar x = x * 2 - 1;\n\t\t\t\tvar y = -(y * 2 - 1);\n\t\t\t\tvar vector = new THREE.Vector3(x, y, 1);\n\t\t\t\treturn vector;\n};\n\nMouse_Intersector.mouse_coords_to_vector = function (canvas, event) {\n\t\t\t\treturn this.get_normalized_screen_coords(canvas, event.clientX, event.clientY);\n};\n\nMouse_Intersector.unproject = function (vector, camera) {\n\t\t\t\tvar r = new THREE.Vector3();\n\t\t\t\tr.copy(vector);\n\t\t\t\tr.unproject(camera);\n\t\t\t\t//this done yet\n\t\t\t\t//r.applyMatrix4(camera.matrixWorldInverse);    \n\t\t\t\treturn r;\n};\n\nMouse_Intersector.mouse_coords_to_ray = function (canvas, event, camera) {\n\t\t\t\tvar vector = this.mouse_coords_to_vector(canvas, event);\n\t\t\t\tvector = this.unproject(vector, camera);\n\t\t\t\tvar ray = new THREE.Ray(camera.position, vector.sub(camera.position).normalize());\n\t\t\t\treturn ray;\n};\n\nMouse_Intersector.find_intersection_with_mouse_vector = function (vector, camera, scene) {\n\t\t\t\tvector.unproject(camera);\n\t\t\t\tvar ray = new THREE.Raycaster(camera.position, vector.sub(camera.position).normalize());\n\t\t\t\t// create an array containing all objects in the scene with which the ray intersects\n\t\t\t\t//var intersects = ray.intersectObjects( [grid_text.root], true ); \n\t\t\t\t//console.log(fake_plane.root.children[0].geometry);\n\t\t\t\tvar intersects = ray.intersectObjects([scene], true);\n\t\t\t\treturn intersects;\n};\n\nMouse_Intersector.find_intersected_object = function (scene, ray) {\n\n\t\t\t\tvar collider = new __WEBPACK_IMPORTED_MODULE_0__simple_collider_js__[\"a\" /* Simple_Collider */](scene);\n\t\t\t\tvar intersects = collider.check_ray(ray);\n\t\t\t\treturn intersects;\n};\n\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Simple_Collider; });\nfunction Simple_Collider(root, params) {\n    this.root = root;\n    if (params === undefined) {\n        params = {};\n    }\n    this.params = {\n        recursive: params.recursive === undefined ? true : params.recursive,\n        check_invisible: params.check_invisible === undefined ? true : params.check_invisible\n    };\n    this.intersected_objects = [];\n    this._tested_sphere = new THREE.Sphere();\n}\n\nSimple_Collider.prototype.prepare_check = function (ray) {\n    this.intersected_objects = [];\n    this.intersected_map = {};\n    this._fakecaster = { ray: ray };\n};\n\nSimple_Collider.prototype.check_ray = function (ray) {\n    this.prepare_check(ray);\n\n    this.find_intersection_with_bounding_sphere(this.root);\n\n    return this.intersected_objects;\n};\n\nSimple_Collider.prototype.add_intersected = function (obj) {\n    if (!this.intersected_map[obj.uuid]) {\n        this.intersected_map[obj.uuid] = obj;\n        this.intersected_objects.push(obj);\n    }\n};\n\nSimple_Collider.prototype.check_object_bounding_sphere = function (obj) {\n    //get bounding sphere\n    if (obj.getBoundingSphere) {\n        this._tested_sphere.copy(obj.getBoundingSphere());\n    } else if (obj.geometry) {\n        //fuck this shit, why don't exists method getBoundingSphere, which encapsulates this?\n        if (obj.geometry.boundingSphere === null) obj.geometry.computeBoundingSphere();\n        //copy sphere from object geometry and transform it with object. matrixWorld\n        this._tested_sphere.copy(obj.geometry.boundingSphere);\n        //console.log(\"get bounding sphere\", this._tested_sphere);\n    } else {\n        return false;\n    }\n\n    //test bounding spere\n    obj.updateMatrixWorld(true);\n    this._tested_sphere.applyMatrix4(obj.matrixWorld);\n    //find intersection\n    var inter = this._fakecaster.ray.intersectsSphere(this._tested_sphere);\n    //console.log(\"inter with sphere, level\", level, inter, sphere.center, raycaster.ray);\n    //add to intersected list, if success\n    if (inter) {\n        this.intersected_objects.push(obj);\n        return true;\n    } else {\n        return false;\n    }\n};\n\nSimple_Collider.prototype.find_intersection_with_bounding_sphere = function (object, top) {\n\n    if (!object.non_collideble && (object.visible || this.params.check_invisible)) {\n        this.check_object_bounding_sphere(object);\n    }\n    if (!this.params.recursive) return;\n\n    //test children\n    var children = object.children;\n    for (var i = 0; i < children.length; i++) {\n        var child = children[i];\n        this.find_intersection_with_bounding_sphere(child);\n    }\n};\n\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Color_Picker; });\n\nvar Color_Picker = {\n    props: {\n        value: {\n            type: Object,\n            default: function () {\n                return { r: 0, g: 0, b: 0 };\n            }\n        }\n    },\n    template: '<div>\\\r\n    <p>Red Green Blue Color\\\r\n    <p>\\\r\n    <input type=\"range\" min=\"0\" max=\"255\" @change=\"changed\" :value=\"value.r\" ref=\"r\" id=\"r\" >\\\r\n    <input type=\"range\" min=\"0\" max=\"255\" @change=\"changed\" :value=\"value.g\" ref=\"g\" id=\"g\">\\\r\n    <input type=\"range\" min=\"0\" max=\"255\" @change=\"changed\" :value=\"value.b\" ref=\"b\" id=\"b\">\\\r\n    </div>',\n    data: function () {\n        return {\n            new_value: {\n                r: 0,\n                g: 0,\n                b: 0\n            }\n        };\n    },\n    methods: {\n        changed: function (event) {\n            this.value[event.target.id] = event.target.value;\n            this.$emit('input', this.value);\n        }\n    }\n};\n\n//Vue.component(\"color-picker\", Color_Picker);\n\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particles_Panel; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__particles_props_js__ = __webpack_require__(10);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__texture_panel_js__ = __webpack_require__(11);\n\n\n\nvar Particles_Panel = {\n    props: {\n        particles: {\n            type: Object,\n            default: function () {\n                return [];\n            }\n        },\n        textures: {\n            type: Object,\n            default: function () {\n                return [];\n            }\n        },\n        selected: {\n            type: String,\n            default: ''\n        }\n    },\n    data: function () {\n\n        return {\n            first_time: true,\n            particle_params: {},\n            my_selected: false,\n            texture_panel_is_visible: false\n        };\n    },\n    methods: {\n        add_to_select: function (id) {\n            //console.log(\"select new \", id, this.particles);\n            this.particles.push(id);\n            this.my_selected = id;\n        },\n        create_particles: function () {\n            event_hub.$emit(\"create_particles\");\n        },\n        remove_particles: function (event) {\n            event_hub.$emit(\"remove_particles\", this.my_selected);\n            for (var i = 0; i < this.particles.length; i++) {\n                if (this.particles[i] == this.my_selected) {\n                    this.particles.splice(i, 1);\n                    //selecte next available particles or empty\n                    if (this.particles.length > 0) {\n                        if (i + 1 < this.particles.length) {\n                            this.my_selected = this.particles[i + 1];\n                        } else {\n                            this.my_selected = this.particles[0];\n                        }\n                    } else {\n                        this.my_selected = '';\n                    }\n\n                    break;\n                }\n            }\n        },\n\n        change_colors: function (event) {\n            event_hub.$emit(\"change_particles_color\", this.my_selected, event);\n        },\n\n        show_texture_panel: function (event) {\n            this.texture_panel_is_visible = !this.texture_panel_is_visible;\n            //console.log(\"this \", this.texture_panel_is_visible);\n        },\n\n        select_particles: function (event) {\n            this.particle_params = event_hub.get_particle_params(this.my_selected);\n        },\n        play: function (event) {\n            event_hub.$emit(\"replay\", this.my_selected, this.particle_params);\n        }\n\n    },\n    created: function () {\n\n        var self = this;\n        event_hub.$on(\"adding_particles\", function (id) {\n            self.add_to_select(id);\n        });\n\n        if (!!this.selected) {\n            this.my_selected = this.selected;\n        } else {\n            if (this.particles.length > 0) {\n                this.my_selected = this.particles[0];\n            }\n        }\n        if (this.my_selected) {\n            this.particle_params = event_hub.get_particle_params(this.my_selected);\n        }\n    },\n\n    watch: {\n        particles: function (arr) {\n            //console.log(\"watch particles\", arr);\n            if (this.particles.length > 0) {\n                if (this.first_time) {\n                    this.my_selected = this.particles[0];\n                    this.first_time = false;\n                }\n            }\n        },\n        my_selected: function (new_selected) {\n            //console.log(\"watch new selected\", new_selected);\n            this.particle_params = event_hub.get_particle_params(this.my_selected);\n        }\n    },\n\n    template: '<div>\\\r\n\t<button type=\"button\" id=\"btn-add\" v-on:click=\"create_particles\">New</button>\\\r\n\t<br>\\\r\n\t<select v-model=\"my_selected\" id=\"object-list\" ref=\"particles_list\">\\\r\n\t\t<option disabled value=\"\">Please select one</option>\\\r\n\t  <option v-for=\"option in particles\" v-bind:value=\"option\">\\\r\n\t\t{{ option }}\\\r\n\t  </option>\\\r\n\t</select>\\\r\n\t<br>\\\r\n    <span>Selected: {{ my_selected }}</span><br>\\\r\n        <button type=\"button\" id=\"btn-play\" v-on:click=\"play\">Refresh</button>\\\r\n        <button type=\"button\" id=\"btn-remove\" v-on:click=\"remove_particles\">Remove</button>\\\r\n    <p>  <span class=\"info-panel\">Particles properties</span></p>\\\r\n    <div class=\"particles-properties\">\\\r\n        <div v-if=\"my_selected\" >\\\r\n            <ParticlesProps  :params=\"particle_params\" />\\\r\n            <a href=\"javascript:void(0)\" @click=\"show_texture_panel\">Show texture panel</a>\\\r\n            <div class=\"dummy\" v-if=\"texture_panel_is_visible\">\\\r\n            <texture-panel :textures=\"textures\" :object_id=\"my_selected\" :selected=\"particle_params.texture\"/>\\\r\n            </div>\\\r\n        </div>\\\r\n    </div>\\\r\n    </div>',\n\n    components: {\n        'ParticlesProps': __WEBPACK_IMPORTED_MODULE_0__particles_props_js__[\"a\" /* Particles_Props */],\n        'texture-panel': __WEBPACK_IMPORTED_MODULE_1__texture_panel_js__[\"a\" /* Texture_Panel */]\n    }\n};\n\n//Vue.component(\"particles-panel\", Particles_Panel);\n\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particles_Props; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__color_picker_js__ = __webpack_require__(8);\n\n\nvar Blending_Selector = {\n    props: {\n        \"blending\": {\n            type: String,\n            required: true,\n            default: \"no\"\n        }\n    },\n    template: '<select v-model=\"blending\" id=\"blending\" v-on:change=\"select\">\\\r\n            <option value=\"no\">no</option>\\\r\n            <option value=\"additive\">additive</option>\\\r\n            <option value=\"one_alpha\">one, minus src alpha</option>\\\r\n            <option value=\"alpha_one\">minus src alpha, one</option>\\\r\n            <option value=\"alpha\">alpha</option>\\\r\n        </select>',\n    methods: {\n        select: function (event) {\n            this.$emit(\"change\", this.blending);\n        }\n    }\n};\n\nvar Behavior = {\n    props: [\"affect_method\", \"emit_method\"],\n\n    data: function () {\n        return {\n            behavior: false\n        };\n    },\n\n    template: '<div>\\\r\n    <button type=\"button\" @click=\"show_behavior\">Show Behaviour</button>\\\r\n    <div class=\"behavior\" v-if=\"behavior\">\\\r\n    <p>affect method<br>\\\r\n    <textarea v-model=\"affect_method\"></textarea>\\\r\n    <p>emit method<br>\\\r\n    <textarea v-model=\"emit_method\"></textarea>\\\r\n    </div>',\n    methods: {\n        show_behavior: function (f) {\n            var behavior = !this.behavior;\n            this.behavior = behavior;\n        }\n    }\n\n};\n\nvar Particle_Params = {\n    props: {\n        \"params\": {\n            type: Object,\n            default: function () {\n                return {};\n            }\n        }\n    },\n\n    template: '<div @keyup.13=\"fire\">\\\r\n        <div class=\"prop-column\">\\\r\n            Life Length: <br/>\\\r\n            <input type=\"text\" id=\"life_length\" v-model.number=\"params.life_length\" type=\"number\" step=\"0.1\" />\\\r\n        </div>\\\r\n        <div class=\"prop-column\">\\\r\n            Emit per second <br/>\\\r\n            <input type=\"text\" id=\"emit_per_second\" v-model.number=\"params.emit_per_second\" type=\"number\" />\\\r\n        </div>\\\r\n        <div class=\"prop-column\">\\\r\n            Number of particles<br/>\\\r\n            <input type=\"text\" id=\"count\" v-model.number=\"params.count\" type=\"number\" />\\\r\n        </div>\\\r\n        <div class=\"prop-column\">\\\r\n            Point Size<br/>\\\r\n            <input type=\"text\" id=\"size\" v-model.number=\"params.size\" type=\"number\" step=\"0.1\" />\\\r\n        </div>\\\r\n</div>',\n    methods: {\n        fire: function (event) {\n            this.$parent.fire(event);\n        }\n    }\n};\n\nvar Particles_Props = {\n    props: {\n        \"params\": {\n            type: Object,\n            default: function () {\n                return {};\n            }\n        }\n    },\n    template: '<div>  <particle-params :params=params />\\\r\n        <color-picker :value=\"params.color\" @input=\"update_color\"></color-picker>\\\r\n        <p>Blending mode</p>\\\r\n            <blending-mode :blending=params.blending @change=\"blending_change\"> </blending-mode>\\\r\n        <p>Precomputed alpha <input type=\"checkbox\" v-model=\"params.precomputed_alpha\" @change=\"fire\" id=\"pre_alpha\"></p>\\\r\n        <behavior :affect_method=params.affect_method :emit_method=params.emit_method />\\\r\n    <div>',\n\n    data: function () {\n        return {\n            behavior: false\n        };\n    },\n    watch: {\n        params: function () {\n            //console.log(\"change \", this.params.id);\n        }\n    },\n    methods: {\n        blending_change: function (event) {\n            this.params.blending = event;\n            this.emit_param_change(\"blending\", event);\n        },\n        emit_param_change: function (key, value) {\n            var params = {};\n            params[key] = value;\n            event_hub.$emit(\"change_params\", this.params.id, params);\n        },\n        fire: function (event) {\n            var value = event.target.type === 'checkbox' ? event.target.checked : event.target.value;\n            this.emit_param_change(event.target.id, value);\n        },\n\n        update_color: function (event) {\n            event_hub.$emit('change_color', this.params.id, event);\n        }\n\n    },\n    components: {\n        'color-picker': __WEBPACK_IMPORTED_MODULE_0__color_picker_js__[\"a\" /* Color_Picker */],\n        'blending-mode': Blending_Selector,\n        'behavior': Behavior,\n        'particle-params': Particle_Params\n    }\n};\n\n//Vue.component(\"ParticlesProps\", Particles_Props);\n\n\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Texture_Panel; });\n\nvar Texture_Panel = {\n    template: '<div class=\"texture-panel\">\\\r\n            <div class=\"high-tools-panel\">\\\r\n            <select id=\"texture_select\" v-model=\"selected\" v-on:change=\"choose_texture\">\\\r\n            <option v-for=\"option in textures\" v-bind:value=\"option\">\\\r\n                {{ option }}\\\r\n            </option>\\\r\n            </select>\\\r\n            <button type=\"button\" v-on:click=\"apply\">apply</button>\\\r\n            </div>\\\r\n            <div class=\"texture-canvas\">\\\r\n            <canvas id=\"texture-canvas-obj\" class=\"texture-canvas\" ref=\"canvas\">\\\r\n            </canvas>\\\r\n            </div>\\\r\n            <div class=\"texture-info\">\\\r\n                Texture Format  {{format}} <br />\\\r\n                Texture Width {{texture_width}} Height {{texture_height}}\\\r\n            </div>\\\r\n            <div class=\"clear\" />\\\r\n        </div>',\n\n    //texture dictionaries, selected texture, object id, which selected texture\n    props: [\"textures\", \"selected\", \"object_id\"],\n\n    data: function () {\n        return {\n            selected_texture: '',\n            texture_width: 0,\n            texture_height: 0,\n            format: '',\n            panel_visible: false,\n            selected: ''\n        };\n    },\n\n    methods: {\n        show_panel: function (event) {\n            this.panel_visible = !this.panel_visible;\n        },\n        choose_texture: function (event) {\n            this.selected = event.target.value;\n            this.selected_texture = this.selected;\n            this.draw_texture(this.selected_texture);\n        },\n        apply: function () {\n            //console.log(\"apply of \", this.object_id, this.selected_texture);\n            event_hub.$emit(\"select_texture\", this.object_id, this.selected_texture);\n        },\n        draw_texture: function (name) {\n            if (!name) return;\n            var texture = event_hub.get_texture(name);\n            if (!texture) {\n                console.error(\"Oh, Fuck! Texture \" + name + \" not found!\");\n                return;\n            }\n            this.format = texture_format_to_string(texture.format);\n            var image = texture.image;\n            this.texture_width = image.naturalWidth || image.width;\n            this.texture_height = image.naturalHeight || image.height;\n\n            var canvas = this.$refs[\"canvas\"];\n            my_draw_image(canvas, image, 0, 0);\n        },\n\n        get_texture_from_particles: function (id) {\n            if (!id) {\n                return;\n            }\n            this.selected_texture = event_hub.get_texture_from_particles(id);\n            this.draw_texture(this.selected_texture);\n        }\n    },\n\n    mounted: function () {\n        this.get_texture_from_particles(this.object_id);\n        //console.log(\"mount of texture panel\", this.object_id, this.selected_texture, this.selected);\n        //print(\"<h3>Hi! I mounted and my texture is \" + this.selected_texture + \",\" + this.selected + \"</h3>\");\n    },\n\n    watch: {\n        object_id: function (value) {\n            this.get_texture_from_particles(value);\n        }\n    }\n\n};\n\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Color_Domain; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return Table_Color; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n\n\nfunction Color_Domain(r, g, b) {\n    this.color = new THREE.Color(r, g, b);\n    this.uuid = _.generateUUID();\n    this.name = '';\n    this.type = \"Color_Domain\";\n}\n\n_.copy_object(Color_Domain.prototype, {\n    toJSON: function (child) {\n        var data = {};\n        data.uuid = this.uuid;\n        if (this.name !== '') {\n            data.name = this.name;\n        }\n        data.type = this.type;\n        data.color = { r: this.color.r, g: this.color.g, b: this.color.b };\n        return;\n    },\n    parse: function (json) {\n        this.uuid = json.uuid;\n        if (json.name !== undefined) {\n            this.name = json.name;\n        }\n        if (json.color !== undefined) {\n            this.color.set(json.color.r, json.color.g, json.color.b);\n        }\n    },\n    emit: function (color) {\n        color.r = this.color.r;\n        color.g = this.color.g;\n        color.b = this.color.b;\n    },\n    fill: function (color, offset) {\n        color[offset + 0] = this.color.r;\n        color[offset + 1] = this.color.g;\n        color[offset + 2] = this.color.b;\n    }\n});\n\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class('Color_Domain', Color_Domain);\n\nfunction Table_Color(table) {\n    if (table !== undefined) {\n        this.copy_table(table);\n    } else {\n        this.default_table();\n    }\n}\n\nTable_Color.prototype = Object.create(Color_Domain);\n\n_.copy_object(Table_Color.prototype, {\n    constructor: Table_Color,\n    copy_table: function (table) {\n        this.table = new Array(table.length);\n        for (var i = 0; i < table.length; i++) {\n            this.table = new THREE.Color(table[i]);\n        }\n    },\n    emit: function (color) {\n        var index = Math.ceil(Math.random() * this.table.length) % this.table.length;\n        var src = this.table[index];\n        color.r = src.r;\n        color.g = src.g;\n        color.b = src.b;\n    },\n    fill: function (color, offset) {\n        var index = Math.ceil(Math.random() * this.table.length) % this.table.length;\n        var src = this.table[index];\n        color[offset] = src.r;\n        color[offset + 1] = src.g;\n        color[offset + 2] = src.b;\n    },\n    default_table: function () {\n        this.table = new Array(8);\n        this.table[0] = new THREE.Color(1, 0, 0);\n        this.table[1] = new THREE.Color(0, 1, 0);\n        this.table[2] = new THREE.Color(0, 0, 1);\n        this.table[3] = new THREE.Color(1, 0, 1);\n        this.table[4] = new THREE.Color(1, 1, 0);\n        this.table[5] = new THREE.Color(1, 0.4, 0.4);\n        this.table[6] = new THREE.Color(0.5, 0.7, 0.98);\n        this.table[7] = new THREE.Color(0.9, 0.4, 0.4);\n    },\n    get: function () {\n        var r = { r: 0, g: 0, b: 0 };\n        this.emit(r);\n        return r;\n    }\n});\n\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Table_Color\", Table_Color);\n\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particle_Shaders; });\nvar Particle_Shaders = {};\n\n(function () {\n\n\t//particle attributes:\n\t//position\n\t//color\n\t//left, size\n\tvar vertex_shader = [\n\t//'attribute vec4 position;',\n\t'attribute vec4 color;', 'attribute float params;', 'varying vec4 vcolor;', 'uniform float lifetime;', 'uniform float point_size;', 'uniform vec2 screen_size;', '#ifndef DYNAMIC_COLORS', 'uniform vec3 particle_color;', '#endif', 'void main () {', 'gl_Position = projectionMatrix * viewMatrix * vec4( position, 1.0 );', '#ifdef DYNAMIC_COLORS', 'vcolor.rgb = color.rgb;', '#else', 'vcolor.rgb = particle_color.rgb;', '#endif', '#ifdef NO_FADE_COLOR', 'vcolor.a = 1.0;', '#else',\n\t//params contains life length which decreased by time\n\t'float tmp = params / lifetime;', 'tmp = min(tmp, 1.0);', 'vcolor.a = tmp;', '#endif', 'float t =  screen_size.y* projectionMatrix[1][1] / gl_Position.w;', 't = t * point_size;', 'if (params > 0.0) {', 'gl_PointSize = t;', '}', 'else {',\n\t//'vcolor.a = 0.0;',\n\t'gl_PointSize = 0.0;', 'gl_Position.z = -1000.0;', '}', '}'];\n\n\tvar fragment_shader = ['varying vec4 vcolor;', '#ifdef PARTICLE_TEXTURE', 'uniform sampler2D sprite;', '#endif', 'void main() {', '#ifdef PARTICLE_TEXTURE', 'vec4 tex = texture2D( sprite, gl_PointCoord );', 'vec3 fragment_color = tex.rgb;', 'fragment_color.rgb *= vcolor.rgb;', 'float alpha = tex.a;', '#else', 'vec3 fragment_color = vcolor.rgb;', 'float alpha = 1.0;', '#endif', '#ifdef PRE_ALPHA', 'fragment_color.rgb *= alpha;', '#endif', '#ifndef NO_FADE_COLOR', 'float fragment_alpha = alpha * vcolor.a;', '#else', 'float fragment_alpha = alpha;', '#endif', 'gl_FragColor = vec4(fragment_color.rgb, fragment_alpha);', '}'];\n\n\tParticle_Shaders.vertex = vertex_shader.join('\\n');\n\tParticle_Shaders.fragment = fragment_shader.join('\\n');\n})();\n\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particle_System; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__particle_affector_js__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__particles_points_js__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__particle_shaders_js__ = __webpack_require__(13);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__color_domain_js__ = __webpack_require__(12);\n\n\n\n\n\n\n\nfunction Particle_System(data) {\n    this.uuid = _.generateUUID();\n\n    this.params = this.config_params(data);\n\n    this.emitter = this.params.emitter;\n    this.affector = this.params.affector;\n    this.particle_lifetime = this.params.particle_lifetime;\n    this.texture = this.params.texture;\n\n    this.dynamic_color = false;\n\n    var count = this.params.count;\n\n    this.material = this.create_particle_material();\n    this.node = new __WEBPACK_IMPORTED_MODULE_3__particles_points_js__[\"a\" /* Particles_Points */](this.create_particle_geometry(count), this.material);\n    this.node.name = this.name;\n    this.node.boundingSphere.radius = this.params.bounding_radius;\n    this.node.non_collideble = this.params.non_collideble;\n}\n\nParticle_System.prototype.config_params = function (data) {\n    var params = {};\n    //default\n    params.particle_lifetime = 3.0;\n    params.no_fade_color = false;\n    params.pre_alpha = true;\n    params.depth_test = true;\n    params.depth_write = false;\n    params.color = { \"r\": 1, \"g\": 1, \"b\": 1 };\n    params.blending = \"one_alpha\";\n    params.size = 1;\n    params.count = 100;\n    params.name = '';\n    params.bounding_radius = 2.0;\n    params.discrete_emission = false;\n    params.apply_world_matrix_on_emit = true;\n    params.non_collideble = false;\n\n    for (var key in data) {\n        if (Object.prototype.hasOwnProperty.call(data, key)) {\n            if (data[key] !== undefined) {\n                params[key] = data[key];\n            }\n        }\n    }\n\n    params.emitter = data.emitter || new __WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__[\"a\" /* Particle_Emitter */](1);\n    params.affector = data.affector || new __WEBPACK_IMPORTED_MODULE_2__particle_affector_js__[\"a\" /* Particle_Affector */]();\n\n    return params;\n};\n\nParticle_System.prototype.set_name = function (name) {\n    this.name = name;\n    this.node.name = name;\n};\n\nParticle_System.prototype.suicide = function () {\n    this.node.parent.remove(this.node);\n    main_event_hub.emit(\"kill_me\", this);\n};\n\nParticle_System.prototype.create_particle_data = function (count) {\n    var particle_data = new Array(count);\n    var p;\n    //var matrix = this.node.worldMatrix();\n    for (var i = 0; i < count; i++) {\n        p = {};\n        p.position = new THREE.Vector3(0, 0, 0);\n        p.velocity = new THREE.Vector3(0, 0, 0);\n\n        //p.position.copy(this.node.position);\n        //p.position.applyMatrix4(matrix);\n        //p.velocity.applyMatrix4_rotation(matrix);\n\n        p.lifetime = 0;\n        particle_data[i] = p;\n    }\n    this.particle_data = particle_data;\n};\n\nParticle_System.prototype.create_particle_geometry = function (count) {\n    this.create_particle_data(count);\n\n    var vertices = new Float32Array(count * 3); // position\n    var colors = new Float32Array(count * 3);\n    var params = new Float32Array(count);\n\n    var particle;\n    for (var i = 0; i < count; i++) {\n        particle = this.particle_data[i];\n        //create particle\n        vertices[i * 3] = particle.position.x;\n        vertices[i * 3 + 1] = particle.position.y;\n        vertices[i * 3 + 2] = particle.position.z;\n\n        params[i] = 0.0;\n\n        if (this.params.color_domain) {\n            this.params.color_domain.fill(colors, i * 3);\n        } else {\n            colors[i * 3] = this.params.color.r;\n            colors[i * 3 + 1] = this.params.color.g;\n            colors[i * 3 + 2] = this.params.color.b;\n        }\n    }\n\n    this.geometry = {};\n    this.geometry.vertices = new THREE.BufferAttribute(vertices, 3).setDynamic(true);\n    this.geometry.colors = new THREE.BufferAttribute(colors, 3);\n    if (this.dynamic_color) {\n        this.geometry.colors.setDynamic(true);\n    }\n    this.geometry.params = new THREE.BufferAttribute(params, 1).setDynamic(true);\n    var geom = new THREE.BufferGeometry();\n    this.geometry.buffer = geom;\n    geom.addAttribute('position', this.geometry.vertices);\n    geom.addAttribute('color', this.geometry.colors);\n    geom.addAttribute('params', this.geometry.params);\n\n    return geom;\n};\n\nParticle_System.prototype.discrete_emit = function (count) {\n    this.emit_particles(0, count);\n    this.geometry.vertices.needsUpdate = true;\n    this.geometry.params.needsUpdate = true;\n    this.geometry.colors.needsUpdate = true;\n};\n\nParticle_System.prototype.emit_particles = function (dt, need_emit) {\n    //emit particles\n    var p;\n    var verts = this.geometry.vertices.array;\n    var params = this.geometry.params.array;\n\n    var old_need_emit = need_emit;\n    this.node.updateMatrixWorld(true);\n    var matrix = this.node.matrixWorld;\n    for (var i = 0; i < this.particle_data.length && need_emit > 0; i++) {\n        if (!(params[i] > 0)) {\n\n            p = this.particle_data[i];\n            this.emitter.emit(p, null, matrix);\n            p.lifetime = this.particle_lifetime;\n\n            verts[i * 3] = p.position.x;\n            verts[i * 3 + 1] = p.position.y;\n            verts[i * 3 + 2] = p.position.z;\n            params[i] = p.lifetime;\n            need_emit--;\n            //colors[i*3] = this.params.color.r\n            //colors[i*3+1] = this.params.color.g;\n            //colors[i*3+2] = this.params.color.b;\n        }\n    }\n    //console.log(\"created new particles \", old_need_emit - need_emit);\n};\n\nParticle_System.prototype.update_particle_geometry = function (dt) {\n    var verts = this.geometry.vertices.array;\n    var params = this.geometry.params.array;\n    var p;\n    var vert = new THREE.Vector3(0, 0, 0);\n    var dummy_color = { \"r\": 1, \"b\": 1, \"g\": 1 };\n    for (var i = 0; i < this.particle_data.length; i++) {\n\n        if (params[i] > 0) {\n            p = this.particle_data[i];\n\n            //integrate\n            p.position.x += p.velocity.x * dt;\n            p.position.y += p.velocity.y * dt;\n            p.position.z += p.velocity.z * dt;\n            p.lifetime -= dt;\n\n            if (p.lifetime <= 0 || !this.affector.affect(dt, p, vert, dummy_color)) {\n                p.lifetime = 0;\n            }\n            params[i] = p.lifetime;\n            verts[i * 3] = p.position.x;\n            verts[i * 3 + 1] = p.position.y;\n            verts[i * 3 + 2] = p.position.z;\n        }\n    }\n\n    if (!this.params.discrete_emission) {\n        var need_emit = this.emitter.calc_emitted_particles(dt);\n        this.emit_particles(dt, need_emit);\n    }\n\n    this.geometry.vertices.needsUpdate = true;\n    this.geometry.params.needsUpdate = true;\n    this.geometry.colors.needsUpdate = true;\n};\n\nParticle_System.prototype.update = function (dt) {\n    this.update_particle_geometry(dt);\n};\n\nParticle_System.prototype.generate_material_name = function () {\n    var my_name = \"MY_PARTICLE_MATERIAL\";\n    if (!!this.texture) {\n        my_name += \"_WITH_TEXTURE\";\n    }\n    if (this.params.no_fade_color) {\n        my_name += \"_NO_FADE_COLOR\";\n    }\n    return my_name;\n};\n\nParticle_System.prototype.blending_mode = {\n    \"additive\": {\n        \"blendSrc\": THREE.OneFactor,\n        \"blendDst\": THREE.OneFactor\n    },\n    \"alpha\": {\n        \"blendSrc\": THREE.SrcAlphaFactor,\n        \"blendDst\": THREE.OneMinusSrcAlphaFactor\n    },\n    \"one_alpha\": {\n        \"blendSrc\": THREE.OneFactor,\n        \"blendDst\": THREE.OneMinusSrcAlphaFactor\n    },\n    \"alpha_one\": {\n        \"blendSrc\": THREE.SrcAlphaFactor,\n        \"blendDst\": THREE.OneFactor\n    }\n};\n\nParticle_System.prototype.convert_blending_mode = function (blending) {\n    var three_blending;\n    var factors = this.blending_mode[\"one_alpha\"];\n    if (blending === 'no') {\n        three_blending = THREE.NoBlending;\n    } else {\n        three_blending = THREE.CustomBlending;\n        if (this.blending_mode[blending]) {\n            factors = this.blending_mode[blending];\n        }\n    }\n    return { \"blending\": three_blending, \"factors\": factors };\n};\n\nParticle_System.prototype.set_texture = function (texture) {\n    if (typeof texture === 'string') {\n        if (this.params.texture === texture) {\n            return;\n        }\n        this.params.texture = texture;\n        this.texture = __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Texture_Manager.get(texture);\n    } else {\n        console.error(\"Oh Shit! texture in set_texture is not string! it's object or undefined!\", texture);\n    }\n\n    if (this.material.uniforms.sprite) {\n        this.material.uniforms.sprite.value = this.texture;\n    } else {\n        //this.material.uniforms.sprite = {value: texture};\n        this.recreate_material();\n        console.error(\"Oh Shit! Our shader has not texture! Need create shader with texture!\");\n    }\n};\n\nParticle_System.prototype.create_uniforms = function () {\n    var uniforms = {\n        \"lifetime\": {\n            value: this.particle_lifetime\n        },\n        \"point_size\": {\n            value: this.params.size\n        },\n        \"screen_size\": {\n            value: new THREE.Vector2(__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Viewport.width, __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Viewport.height)\n        }\n    };\n    if (!!this.texture) {\n        uniforms[\"sprite\"] = {\n            value: this.texture\n        };\n    };\n    if (!this.dynamic_color) {\n        uniforms[\"particle_color\"] = { value: this.params.color };\n    }\n    return uniforms;\n};\n\nParticle_System.prototype.calc_defines = function () {\n    var defines = {};\n    if (this.params.pre_alpha) {\n        defines[\"PRE_ALPHA\"] = true;\n    }\n    if (!!this.texture) {\n        defines[\"PARTICLE_TEXTURE\"] = true;\n    }\n    if (this.params.no_fade_color) {\n        defines[\"NO_FADE_COLOR\"] = true;\n    }\n    if (this.params.color_domain) {\n        defines[\"DYNAMIC_COLORS\"] = true;\n    }\n    return defines;\n};\n\nParticle_System.prototype.select_texture = function (texture) {\n    if (typeof this.texture === 'string') {\n        this.texture = __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Texture_Manager.get(this.texture);\n        if (!this.texture) {\n            console.error(\"Oh, not found texture <\" + this.params.texture + \"> in create particle material! Instead get \" + this.texture);\n        }\n    }\n};\n\nParticle_System.prototype.create_particle_material = function () {\n\n    this.select_texture(this.texture);\n\n    var blend_obj = this.convert_blending_mode(this.params.blending);\n\n    var uniforms = this.create_uniforms();\n    var defines = this.calc_defines();\n\n    var mat = new THREE.ShaderMaterial({\n        transparent: true,\n        depthWrite: this.params.depth_write,\n        depthTest: this.params.depth_test,\n        blending: blend_obj.blending,\n        blendSrc: blend_obj.factors.blendSrc,\n        blendDst: blend_obj.factors.blendDst,\n        defines: defines,\n        uniforms: uniforms,\n        vertexShader: __WEBPACK_IMPORTED_MODULE_4__particle_shaders_js__[\"a\" /* Particle_Shaders */].vertex,\n        fragmentShader: __WEBPACK_IMPORTED_MODULE_4__particle_shaders_js__[\"a\" /* Particle_Shaders */].fragment\n    });\n    return mat;\n};\n\nParticle_System.prototype.recreate_material = function () {\n    this.node.material = this.material = this.create_particle_material();\n};\n\nParticle_System.prototype.set_pre_alpha = function (pre_alpha) {\n    if (this.params.pre_alpha !== !!pre_alpha) {\n        this.params.pre_alpha = pre_alpha;\n        this.recreate_material();\n    }\n};\n\nParticle_System.prototype.set_point_size = function (size) {\n    if (this.params.size != size) {\n        this.params.size = size;\n        this.node.material.uniforms[\"point_size\"].value = size;\n    }\n};\n\nParticle_System.prototype.set_blending = function (blending) {\n    this.params.blending = blending;\n    var b = this.convert_blending_mode(blending);\n    this.material.blending = b.blending;\n    this.material.blendSrc = b.factors.blendSrc;\n    this.material.blendDst = b.factors.blendDst;\n};\n\nParticle_System.prototype.toJSON = function () {\n    var data = {};\n    data.uuid = this.uuid;\n    data.node = this.node.uuid;\n    if (this.name || this.node.name) {\n        data.name = this.name || this.node.name;\n    }\n    data.params = {};\n    if (this.params) {\n        _.copy_object(data.params, this.params);\n    }\n    data.params.emitter = this.emitter.toJSON();\n    data.params.affector = this.affector.toJSON();\n    return data;\n};\n\nParticle_System.prototype.set_emitter = function (emitter) {\n    this.emitter = this.params.emitter = emitter;\n};\n\nParticle_System.prototype.set_particle_life_length = function (val) {\n    if (val !== this.params.particle_lifetime) {\n        this.params.particle_lifetime = this.particle_lifetime = val;\n        this.material.uniforms['lifetime'].value = val;\n    }\n};\n\nParticle_System.prototype.set_emission_per_second = function (val) {\n    this.emitter.emit_per_second = val;\n};\n\nParticle_System.prototype.set_particle_count = function (count) {\n    if (count !== this.particle_data.length) {\n        this.params.count = count;\n        this.node.geometry = this.create_particle_geometry(count);\n    }\n};\n\nParticle_System.prototype.set_color = function (color) {\n    this.params.color.r = color.r;\n    this.params.color.g = color.g;\n    this.params.color.b = color.b;\n};\n\nParticle_System.prototype.set_bounding_sphere_radius = function (radius) {\n    this.node.boundingSphere.radius = radius;\n};\n\n\n\n/***/ }),\n/* 15 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particle_Manager; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__particle_affector_js__ = __webpack_require__(1);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__particles_points_js__ = __webpack_require__(4);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__particles_js__ = __webpack_require__(14);\n\n\n\n\n\n\nfunction Particle_Manager() {\n    this.particles = {};\n    this.particles_array = [];\n}\n\n_.copy_object(Particle_Manager.prototype, {\n    constructor: Particle_Manager,\n    add: function (ps, name) {\n        if (!this.particles[name]) {\n            this.particles[name] = ps;\n            this.particles_array.push(ps);\n        }\n    },\n    remove_particles: function (name) {\n        var ps = this.particles[name];\n        var i = this.particles_array.indexOf(ps);\n        if (i >= 0) {\n            this.particles_array.splice(i, 1);\n        }\n        if (ps) {\n            ps.suicide();\n            delete this.particles[name];\n        }\n    },\n    get_particle_names: function () {\n        var names = [];\n        for (var key in this.particles) {\n            names.push(key);\n        }\n        return names;\n    },\n\n    update: function (dt) {\n        for (var i = 0; i < this.particles_array.length; i++) {\n            this.particles_array[i].update(dt);\n        }\n    },\n\n    create_by_params: function (params) {\n        var ps = new __WEBPACK_IMPORTED_MODULE_4__particles_js__[\"a\" /* Particle_System */](params);\n        this.add(ps);\n        return ps;\n    },\n\n    toJSON: function () {\n        var arr = [];\n\n        var data;\n        var p;\n        for (var key in this.particles) {\n            p = this.particles[key];\n            if (p.uuid) {\n                data = p.toJSON();\n                arr.push(data);\n            }\n        }\n\n        return arr;\n    },\n\n    emitter_fabric: function (params) {\n        if (params.emitter) {\n            var emitter = __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Get_Class(params.emitter.name);\n            if (emitter) {\n                emitter = new emitter();\n            } else {\n                emitter = new __WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__[\"a\" /* Particle_Emitter */]();\n            }\n            emitter.parse(params.emitter.params);\n            return emitter;\n        }\n        return undefined;\n    },\n\n    affector_fabric: function (params) {\n        if (params.affector) {\n            var affector = __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Get_Class(params.affector.name);\n            if (affector) {\n                affector = new affector();\n            } else {\n                affector = new __WEBPACK_IMPORTED_MODULE_2__particle_affector_js__[\"a\" /* Particle_Affector */]();\n            }\n            affector.parse(params.affector.params);\n            return affector;\n        }\n        return undefined;\n    },\n\n    fromJSON: function (json, callback, root, name) {\n        if (this.particles[name]) {\n            console.log(\"WARNING Particle Manager! Particle System with this name already exists\", name);\n        }\n\n        try {\n            var data = JSON.parse(json);\n        } catch (e) {\n            console.log(\"error parsing json on \", name, json);\n            throw e;\n        }\n\n        return this.parse(data, root, name);\n    },\n\n    parse: function (data, root, name) {\n        var emitter = this.emitter_fabric(data.params);\n        var affector = this.affector_fabric(data.params);\n        data.params.emitter = emitter;\n        data.params.affector = affector;\n\n        var ps = new __WEBPACK_IMPORTED_MODULE_4__particles_js__[\"a\" /* Particle_System */](data.params);\n        ps.set_name(data.name);\n\n        //add to scene graph\n        if (data.params.parent) {\n            var parent = root.getObjectByName(data.params.parent);\n            //console.log(data.params.parent, \"parent particles\", name, root);\n            parent.add(ps.node);\n        } else {\n            root.add(ps.node);\n        }\n\n        //ugly fucking hack\n        //copy node properties\n        this.add(ps, name);\n        return ps;\n    },\n\n    load_particles: function (json, root) {\n        var particles = json.particles;\n        for (var i = 0; i < particles.length; i++) {\n            var p = particles[i];\n            var ps = this.parse(p, root, p.name);\n            ps.node.uuid = p.node;\n            ps.node.name = p.name;\n            var obj = root.getObjectByProperty(\"uuid\", p.node);\n            if (obj) {\n                ps.node.replace_object_with_this(obj);\n            }\n        }\n    },\n\n    create_name: function () {\n        var number = this.particles_array.length + 1;\n        var begin_name = 'Particle_System_';\n        var testing = true;\n        while (testing) {\n            name = begin_name + number;\n            if (this.particles[name] !== undefined) {\n                number++;\n            } else {\n                return name;\n            }\n        }\n    },\n\n    create_new: function () {\n        var name = this.create_name();\n\n        var params = {};\n        var ps = new __WEBPACK_IMPORTED_MODULE_4__particles_js__[\"a\" /* Particle_System */](params);\n        ps.set_name(name);\n        this.add(ps, name);\n        return ps;\n    }\n});\n\nif (__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].particle_manager === undefined) {\n    __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].particle_manager = new Particle_Manager();\n}\n\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Particles_Config = {\n    \"box_size\": 10\n};\n\n\n\n/***/ }),\n/* 16 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Point_Generators; });\nvar Point_Generators = {};\n\nPoint_Generators.Random_Direction = function () {};\n\nPoint_Generators.Random_Direction.prototype.get_direction = function (vector) {\n\tvector.x = Math.random();\n\tvector.y = Math.random();\n\tvector.z = Math.random();\n};\n\nPoint_Generators.Sphere = function (radius) {\n\tthis.radius = radius;\n};\n\nPoint_Generators.Sphere.prototype.get_inner_point = function (vector) {\n\tvar alpha = Math.random() * Math.PI * 2;\n\tvar beta = Math.random() * Math.PI;\n\tvector.x = Math.cos(alpha) * Math.sin(beta);\n\tvector.y = Math.cos(beta);\n\tvector.z = Math.sin(alpha) * Math.sin(beta);\n};\n\nPoint_Generators.Sphere.prototype.get_normal = function (vector) {\n\tvector.x = Math.random() * 2 - 1;\n\tvector.y = Math.random() * 2 - 1;\n\tvector.z = Math.random() * 2 - 1;\n\tvector.normalize();\n};\n\nPoint_Generators.Sphere.prototype.get_point = function (vector) {\n\tthis.get_normal(vector);\n\tvector.multiplyScalar(this.radius);\n};\n\n\n\n/***/ }),\n/* 17 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_event_hub_js__ = __webpack_require__(5);\n/* harmony namespace reexport (by used) */ __webpack_require__.d(__webpack_exports__, \"B\", function() { return __WEBPACK_IMPORTED_MODULE_0__base_event_hub_js__[\"a\"]; });\n/* harmony namespace reexport (by used) */ __webpack_require__.d(__webpack_exports__, \"C\", function() { return __WEBPACK_IMPORTED_MODULE_0__base_event_hub_js__[\"b\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__base_my_lib_js__ = __webpack_require__(0);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return __WEBPACK_IMPORTED_MODULE_1__base_my_lib_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__base_animations_js__ = __webpack_require__(20);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return __WEBPACK_IMPORTED_MODULE_2__base_animations_js__[\"a\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return __WEBPACK_IMPORTED_MODULE_2__base_animations_js__[\"b\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"d\", function() { return __WEBPACK_IMPORTED_MODULE_2__base_animations_js__[\"c\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__base_mouse_intersector_js__ = __webpack_require__(6);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"e\", function() { return __WEBPACK_IMPORTED_MODULE_3__base_mouse_intersector_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__base_mouse_camera_controller_js__ = __webpack_require__(3);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"f\", function() { return __WEBPACK_IMPORTED_MODULE_4__base_mouse_camera_controller_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__base_loading_manager_js__ = __webpack_require__(21);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"g\", function() { return __WEBPACK_IMPORTED_MODULE_5__base_loading_manager_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__base_package_manager_js__ = __webpack_require__(22);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"h\", function() { return __WEBPACK_IMPORTED_MODULE_6__base_package_manager_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__particles_particles_points_js__ = __webpack_require__(4);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"i\", function() { return __WEBPACK_IMPORTED_MODULE_7__particles_particles_points_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__particles_particle_emitter_js__ = __webpack_require__(2);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"j\", function() { return __WEBPACK_IMPORTED_MODULE_8__particles_particle_emitter_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__particles_forces_js__ = __webpack_require__(30);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"k\", function() { return __WEBPACK_IMPORTED_MODULE_9__particles_forces_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__particles_particle_affector_js__ = __webpack_require__(1);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"l\", function() { return __WEBPACK_IMPORTED_MODULE_10__particles_particle_affector_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__particles_point_generators_js__ = __webpack_require__(16);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"m\", function() { return __WEBPACK_IMPORTED_MODULE_11__particles_point_generators_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__particles_custom_emitter_js__ = __webpack_require__(29);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"n\", function() { return __WEBPACK_IMPORTED_MODULE_12__particles_custom_emitter_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__particles_custom_affector_js__ = __webpack_require__(28);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"o\", function() { return __WEBPACK_IMPORTED_MODULE_13__particles_custom_affector_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__particles_test_emitters_js__ = __webpack_require__(31);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"p\", function() { return __WEBPACK_IMPORTED_MODULE_14__particles_test_emitters_js__[\"a\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"q\", function() { return __WEBPACK_IMPORTED_MODULE_14__particles_test_emitters_js__[\"b\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"r\", function() { return __WEBPACK_IMPORTED_MODULE_14__particles_test_emitters_js__[\"c\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"s\", function() { return __WEBPACK_IMPORTED_MODULE_14__particles_test_emitters_js__[\"d\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_15__particles_particle_shaders_js__ = __webpack_require__(13);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"t\", function() { return __WEBPACK_IMPORTED_MODULE_15__particles_particle_shaders_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_16__particles_particles_js__ = __webpack_require__(14);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"u\", function() { return __WEBPACK_IMPORTED_MODULE_16__particles_particles_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_17__particles_particles_manager_js__ = __webpack_require__(15);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"v\", function() { return __WEBPACK_IMPORTED_MODULE_17__particles_particles_manager_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_18__base_scene_serializer_js__ = __webpack_require__(23);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"w\", function() { return __WEBPACK_IMPORTED_MODULE_18__base_scene_serializer_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_19__mixins_threejs_mixins_js__ = __webpack_require__(27);\n/* harmony namespace reexport (by used) */ __webpack_require__.d(__webpack_exports__, \"D\", function() { return __WEBPACK_IMPORTED_MODULE_19__mixins_threejs_mixins_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_20__mixins_camera_mixin_js__ = __webpack_require__(26);\n/* harmony namespace reexport (by used) */ __webpack_require__.d(__webpack_exports__, \"E\", function() { return __WEBPACK_IMPORTED_MODULE_20__mixins_camera_mixin_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_21__app_application_js__ = __webpack_require__(19);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"x\", function() { return __WEBPACK_IMPORTED_MODULE_21__app_application_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_22__particles_color_domain_js__ = __webpack_require__(12);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"y\", function() { return __WEBPACK_IMPORTED_MODULE_22__particles_color_domain_js__[\"a\"]; });\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"z\", function() { return __WEBPACK_IMPORTED_MODULE_22__particles_color_domain_js__[\"b\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_23__base_simple_collider_js__ = __webpack_require__(7);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"A\", function() { return __WEBPACK_IMPORTED_MODULE_23__base_simple_collider_js__[\"a\"]; });\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/***/ }),\n/* 18 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__gui_vueapp_js__ = __webpack_require__(25);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return __WEBPACK_IMPORTED_MODULE_0__gui_vueapp_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__gui_color_picker_js__ = __webpack_require__(8);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return __WEBPACK_IMPORTED_MODULE_1__gui_color_picker_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__gui_texture_panel_js__ = __webpack_require__(11);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return __WEBPACK_IMPORTED_MODULE_2__gui_texture_panel_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__gui_particles_props_js__ = __webpack_require__(10);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"d\", function() { return __WEBPACK_IMPORTED_MODULE_3__gui_particles_props_js__[\"a\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__gui_particles_panel_js__ = __webpack_require__(9);\n/* harmony reexport (binding) */ __webpack_require__.d(__webpack_exports__, \"e\", function() { return __WEBPACK_IMPORTED_MODULE_4__gui_particles_panel_js__[\"a\"]; });\n\n\n\n\n\n\n/***/ }),\n/* 19 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Application; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__base_event_hub_js__ = __webpack_require__(5);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__base_mouse_intersector_js__ = __webpack_require__(6);\n/*\r\nmain class\r\nthis has abstract virtual methods\r\nstart - which create renderer and conduct start initializations\r\nupdate - updated scene objects, animations, phisics\r\nrender - control scene rendering\r\nthis methods must rewrite on derived classes\r\nneed set \r\nPROPERTIES\r\nmain_camera - camera which point of view render whole scene and user interacts\r\ndom_screen - dom element which contain canvas and display scene\r\nrenderer - three.js renderer\r\ncanvas - is created by three.js renderer, it have to append to dom_screen children, fuck it\r\ncanvas width and height defining on creating it by renderer, fuck it\r\n\r\n\r\n\r\n*/\n\n\n\n\n\nfunction Application(config) {\n\n    this._lifecycle_event(\"before_created\");\n\n    this._init_timer();\n    this._create_loop_function();\n\n    this.mouse_controllers = [];\n\n    __WEBPACK_IMPORTED_MODULE_1__base_event_hub_js__[\"a\" /* main_event_hub */].add_event_listener(\"kill_me\", function (obj) {\n        this.remove_animated_object(obj);\n    }, this);\n}\n\nApplication.prototype.start = function (config) {\n    console.log(\"start application...\");\n    this._set_configuration(config);\n};\n\nApplication.prototype._lifecycle_event = function (name, event) {\n    if (this[name]) {\n        return this[name](event);\n    }\n    return false;\n};\n\nApplication.prototype._init_timer = function () {\n    this.clock = new THREE.Clock();\n    this.delta_time = 0;\n    this.animated_objects = [];\n};\n\nvar run_function = window.requestAnimationFrame || function (callback) {\n    window.setTimeout(callback, 1000 / 60);\n};\n\nApplication.prototype._create_loop_function = function () {\n    var self = this;\n    this.run = function () {\n        run_function(function () {\n            self.loop();\n            //main_event_hub.emit(\"new_frame\");\n        });\n    };\n\n    //My_Lib.create_run_function(this);\n\n    //main_even_hub.add_event_listener(\"new_frame\", this.loop, this);    \n};\n\nApplication.prototype.get_default_configuration = function () {\n    return {\n        \"dom_element\": \"screen\",\n        \"render_params\": {\n            \"premultipliedAlpha\": true,\n            \"alpha\": true\n        },\n        \"viewport\": {\n            \"width\": 800,\n            \"height\": 600\n        },\n        \"clear_color\": 0x0000FF,\n        \"main_camera\": {\n            \"fov\": 80,\n            \"near\": 0.1,\n            \"far\": 1000,\n            \"aspect_ratio\": 1.3333333333333333,\n            \"position\": {\n                \"x\": 0,\n                \"y\": 0,\n                \"z\": 0\n            }\n        }\n    };\n};\n\nApplication.prototype._create_render = function (json) {\n    if (this.dom_screen || this.renderer) {\n        alert(\"Create render alert! Something strange happenes!\");\n    }\n    if (!this.dom_screen) {\n        this.dom_screen = document.getElementById(json.dom_element);\n    }\n    if (!this.renderer) {\n        this.renderer = new THREE.WebGLRenderer(json.render_params);\n    }\n    if (!!!this.dom_screen || typeof this.dom_screen === 'undefined') {\n        console.error(\"Some terrorous happens! dom element for screen not found! element id is \" + json.dom_element);\n    }\n    //console.log(\"found dome element \" + json.dom_element);\n    this.dom_screen.appendChild(this.renderer.domElement);\n    this.canvas = this.renderer.domElement;\n\n    this.renderer.setSize(json.viewport.width, json.viewport.height);\n    this.set_viewport(json.viewport.width, json.viewport.height);\n    this.renderer.setClearColor(json.clear_color);\n\n    this._lifecycle_event(\"render_created\");\n};\n\nApplication.prototype._create_main_scene = function (json) {\n    var event = { prevent: false };\n    this._lifecycle_event(\"before_create_main_scene\", event);\n    /*\r\n    if (event.prevent) {\r\n        return;\r\n    }\r\n    */\n    if (!this.main_scene) {\n        this.main_scene = new THREE.Scene();\n    }\n\n    var camera = json.main_camera;\n    if (!this.main_camera) {\n        this.main_camera = new THREE.PerspectiveCamera(camera.fov, camera.aspect_ratio, camera.near, camera.far);\n        this.main_scene.add(this.main_camera);\n        this.main_camera.name = \"main_camera\";\n    } else {\n        this.main_camera.fov = camera.fov;\n        this.main_camera.near = camera.near;\n        this.main_camera.far = camera.far;\n        this.main_camera.aspect = camera.aspect_ratio;\n        this.main_camera.updateProjectionMatrix();\n    }\n\n    this.main_camera.position.set(camera.position.x, camera.position.y, camera.position.z);\n};\n\nApplication.prototype.apply_configuration = function (json) {\n    this.configuration = json;\n    this._create_render(json);\n    this._create_main_scene(json);\n    this._lifecycle_event(\"created\");\n};\n\nApplication.prototype.load_configuration = function (url) {\n    var xhr = new THREE.XHRLoader();\n\n    var self = this;\n\n    var config = self.get_default_configuration();\n\n    var configuration_is_applied = false;\n\n    function onload(data) {\n        console.log(\"configuration loaded from url <<\" + url + \">>\");\n        var obj = JSON.parse(data);\n        //user config append to default config and may rewrite them, \n        //though user naven't to rewrite ALL config to change some params\n        _.copy_object(config, obj);\n        self.apply_configuration(config);\n        console.log(configuration_is_applied, \"onload\");\n        configuration_is_applied = true;\n    }\n    function progress() {}\n    function error(event) {\n        console.error(\"Error on loading config!\", event.target.status);\n        console.log(\"Setting default configuration\");\n        console.log(configuration_is_applied, \"error\");\n        configuration_is_applied = true;\n        self.apply_configuration(config);\n    }\n    xhr.load(url, onload, progress, error);\n};\n\nApplication.prototype._set_configuration = function (config) {\n    var default_config = this.get_default_configuration();\n\n    //this is url of configuration file\n    if (typeof config === 'string') {\n        console.log(\"get configuration from url >> \" + config);\n        this.load_configuration(config);\n\n        //this is object filled with data\n    } else if (typeof config === 'object') {\n        console.log(\"get configuration from user object\");\n        _.copy_object(default_config, config);\n        this.apply_configuration(default_config);\n        //configuration not given, use default\n    } else {\n        console.log(\"_set_configuration: set default configration\");\n        this.apply_configuration(default_config);\n    }\n};\n\nApplication.extend = function (methods, child_func) {\n\n    var Child;\n    if (typeof child_func === 'undefined') {\n        Child = function () {\n            Application.apply(this, arguments);\n        };\n    } else {\n        Child = child_func;\n    }\n\n    //create new object and set prototype chain\n    Child.prototype = Object.create(Application.prototype);\n    //copy methods to new object\n    _.copy_object(Child.prototype, methods);\n    Child.prototype.constructor = Child;\n\n    return Child;\n};\n\nApplication.extend_proto = function (proto, methods) {\n    var obj = Object.create(proto);\n    _.copy_object(obj, methods);\n    Application.call(obj);\n    return obj;\n};\n\nApplication.prototype.loop = function () {\n    var delta = this.clock.getDelta();\n    //fix this - add options to control min frame rate\n    if (delta > 0.1) {\n        delta = 0.1;\n    }\n    this.delta_time = delta;\n    this.do_update(delta);\n    this.update(delta);\n    this.render(delta);\n    this.run();\n    //My_Lib.run();\n};\n\nApplication.prototype.add_animated_object = function (obj) {\n    //fix probably duplicates\n    this.animated_objects.push(obj);\n};\n\nApplication.prototype.remove_animated_object = function (obj) {\n    for (var i = 0; i < this.animated_objects.length; i++) {\n        if (this.animated_objects[i] === obj) {\n            this.animated_objects.splice(i, 1);\n            break;\n        }\n    }\n};\n\nApplication.prototype.update_all = function (delta) {\n    var obj;\n    for (var i = 0, len = this.animated_objects.length; i < len; i++) {\n        obj = this.animated_objects[i];\n        if (obj[\"update\"]) {\n            obj.update(delta);\n        }\n    }\n};\n\nApplication.prototype.pre_update = function (delta) {\n    this.update_all(delta);\n    __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].particle_manager.update(delta);\n    //event\n    if (this.before_update !== undefined) {\n        this.before_update(delta);\n    }\n};\n\nApplication.prototype.do_update = function (dt) {\n    this.pre_update(dt);\n    this.update(dt);\n};\n\nApplication.prototype.update = function (delta) {};\n\nApplication.prototype.create_mouse_move_listener = function () {\n    if (this[\"mouse_move_listener\"]) {\n        return;\n    }\n    var self = this;\n    this.mouse_move_listener = true;\n    function mouse_move_listener(event) {\n        var vector = __WEBPACK_IMPORTED_MODULE_2__base_mouse_intersector_js__[\"a\" /* Mouse_Intersector */].mouse_coords_to_vector(self.dom_screen, event);\n        self.find_mouse_over_intersections(vector);\n    };\n    document.addEventListener(\"mousemove\", mouse_move_listener);\n};\n\nApplication.prototype.find_mouse_over_intersections = function (vector) {\n    vector.unproject(this.main_camera);\n    var ray = new THREE.Raycaster(this.main_camera.position, vector.sub(this.main_camera.position).normalize());\n    var obj;\n    for (var i = 0, len = this.mouse_controllers.length; i < len; i++) {\n        obj = this.mouse_controllers[i];\n        if (obj.over) {\n            // create an array containing all objects in the scene with which the ray intersects\n            //var intersects = ray.intersectObjects( [grid_text.root], true ); \n            //console.log(fake_plane.root.children[0].geometry);\n            var intersects = ray.intersectObjects([obj.root], true);\n            obj.callback(intersects);\n        }\n    }\n};\n\nApplication.prototype.add_mouse_controller = function (root, over, click, callback) {\n    var tmp = new __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Mouse_Controller(root, over, click, callback);\n    this.mouse_controllers.push(tmp);\n    if (over) {\n        this.create_mouse_move_listener();\n    }\n    return tmp;\n};\n\nApplication.prototype.set_viewport = function (width, height) {\n    __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Viewport.width = width;\n    __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Viewport.height = height;\n};\n\nApplication.prototype.render = function (delta) {\n    this.renderer.setClearColor(this.configuration.clear_color);\n    this.renderer.autoClear = true;\n    this.renderer.render(this.main_scene, this.main_camera);\n};\n\n\n\n/***/ }),\n/* 20 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Base_Animation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return Euler_Animation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return Scale_Animation; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__my_lib_js__ = __webpack_require__(0);\n\n\n//length - simple length of animations\n//-1 - infinite\n//0 - stop\n//> 0 - length of animation, \n//if time > length, animation stop\n//need rewrite this crap to safe floating point mannere\n//and append more controle on animation \nfunction Base_Animation() {\n    this.time = 0;\n    this.time_scale = 1.0;\n    this.type = \"Base_Animation\";\n    this.uuid = _.generateUUID();\n    this.length = -1;\n    this.stopped = false;\n}\n\nBase_Animation.prototype.update = function (dt) {\n    var scaled_dt = dt * this.time_scale;\n    this.time += scaled_dt;\n    if (this.length < 0 || this.time < this.length) {\n        this.calc_animation(dt);\n    }\n};\n\nBase_Animation.prototype.stop = function () {\n    this.stopped = true;\n};\n\nBase_Animation.prototype.start = function () {\n    this.stopped = false;\n};\n\nBase_Animation.prototype.reset = function () {\n    this.time = 0;\n};\n\nBase_Animation.prototype.calc_animation = function (dt) {};\n\nBase_Animation.prototype.apply = function (obj) {};\n\nBase_Animation.prototype.toJSON = function (data) {\n    var data = {};\n    data.uuid = this.uuid;\n    data.type = this.type;\n    if (this.name !== '') {\n        data.name = this.name;\n    }\n    data.time_scale = this.time_scale === undefined ? 1.0 : this.time_scale;\n    data.length = this.length;\n    return data;\n};\n\nBase_Animation.prototype.parse = function (param) {\n    this.type = param.type;\n    this.uuid = param.uuid;\n    this.name = param.name ? param.name : '';\n    this.time_scale = param.time_scale === undefined ? 1.0 : param.time_scale;\n    this.length = param.length === undefined ? -1 : param.length;\n};\n\nfunction Euler_Animation(x, y, z) {\n    Base_Animation.call(this);\n    this.type = \"Euler_Animation\";\n    this.xspeed = x;\n    this.yspeed = y;\n    this.zspeed = z;\n    this.x = 0;\n    this.y = 0;\n    this.z = 0;\n    this.name = '';\n}\n\nEuler_Animation.prototype = Object.create(Base_Animation.prototype);\n\nEuler_Animation.prototype.constructor = Euler_Animation;\n\nEuler_Animation.prototype.calc_animation = function (dt) {\n    //console.log(this.xspeed,this.yspeed, this.zpeed, dt, this.time_scale);\n    dt *= this.time_scale;\n    this.x += this.xspeed * dt;\n    this.y += this.yspeed * dt;\n    this.z += this.zspeed * dt;\n};\n\nEuler_Animation.prototype.apply = function (obj) {\n    obj.rotation.set(this.x, this.y, this.z);\n};\n\nEuler_Animation.prototype.toJSON = function (json) {\n    var data = Base_Animation.prototype.toJSON.call(this);\n    data.xspeed = this.xspeed;\n    data.yspeed = this.yspeed;\n    data.zspeed = this.zspeed;\n    return data;\n};\n\nEuler_Animation.prototype.parse = function (param) {\n    Base_Animation.prototype.parse.call(this, param);\n    this.xspeed = param.xspeed;\n    this.yspeed = param.yspeed;\n    this.zspeed = param.zspeed;\n    this.x = this.y = this.z = 0;\n};\n\nfunction Scale_Animation(x, y, z) {\n    Base_Animation.call(this);\n    //speed of scale\n    this.xscale = x;\n    this.yscale = y;\n    this.zscale = z;\n    this.x = 1.0;\n    this.y = 1.0;\n    this.z = 1.0;\n}\n\nScale_Animation.prototype = Object.create(Base_Animation.prototype);\n\n_.copy_object(Scale_Animation.prototype, {\n    constructor: Scale_Animation,\n    calc_animation: function (dt) {\n        dt = dt * this.time_scale;\n        this.x += this.xscale * dt;\n        this.y += this.yscale * dt;\n        this.z += this.zscale * dt;\n    },\n    apply: function (obj) {\n        obj.scale.set(this.x, this.y, this.z);\n    },\n    reset: function () {\n        if (this.first) {}\n        this.x = 1.0;\n        this.y = 1.0;\n        this.z = 1.0;\n        this.time = 0;\n    }\n});\n\n__WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Base_Animation\", Base_Animation);\n__WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Euler_Animation\", Euler_Animation);\n__WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Scale_Animation\", Scale_Animation);\n\n\n\n/***/ }),\n/* 21 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Loading_Manager; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__my_lib_js__ = __webpack_require__(0);\n\n\n//events: \n//item_loaded\n//onerror\n//onprogress\n//finished\nfunction Chain_Loader() {}\n\nChain_Loader.prototype = {\n\tconstructor: Chain_Loader,\n\tstart: function (list) {\n\t\tthis.list = list;\n\t\tthis.index = 0;\n\t\tthis.load(this.list[0]);\n\t\tthis.stop_by_error = false;\n\t},\n\n\tnext: function (resource) {\n\t\tif (this.item_loaded && resource) {\n\t\t\tthis.item_loaded(resource, this.list[this.index]);\n\t\t}\n\t\tthis.index++;\n\t\tif (this.index < this.list.length) {\n\t\t\tthis.load(this.list[this.index]);\n\t\t} else {\n\t\t\tif (this.finished) {\n\t\t\t\tthis.finished();\n\t\t\t}\n\t\t}\n\t},\n\n\tdo_error: function (error) {\n\t\tif (this.onerror) {\n\t\t\tthis.onerror(error);\n\t\t} else {\n\t\t\tconsole.error(\"Chain Loader Error!\", error);\n\t\t}\n\t\tif (!this.stop_by_error) {\n\t\t\tthis.next();\n\t\t}\n\t},\n\n\tdo_progress: function () {\n\t\tif (this.onprogress) {\n\t\t\tthis.onprogress.apply(this, arguments);\n\t\t}\n\t},\n\n\tload: function (item) {\n\t\tvar self = this;\n\t\tif (this.load_func) {\n\t\t\tthis.load_func(item, function (item) {\n\t\t\t\tself.next.apply(self, arguments);\n\t\t\t}, function (item) {\n\t\t\t\tself.do_error.apply(self, arguments);\n\t\t\t}, function (item) {\n\t\t\t\tself.do_progress.apply(self, arguments);\n\t\t\t});\n\t\t}\n\t}\n};\n\nfunction test_chain_loader() {\n\tvar cl = new Chain_Loader();\n\tcl.item_loaded = function (item) {\n\t\tconsole.log(\"load item \", item);\n\t};\n\tcl.finished = function (item) {\n\t\tconsole.log(\"loader manager - job done\");\n\t};\n\tcl.load_func = function (item, next, error, progress) {\n\t\tif (item) {\n\t\t\tnext(item);\n\t\t} else {\n\t\t\terror(item);\n\t\t}\n\t};\n\tcl.start([\"first\", \"second\", null, \"tree\"]);\n}\n//test_chain_loader();\n\n\nfunction Loading_Manager() {\n\tthis.resources = {};\n\tthis.texture_loader = new THREE.TextureLoader();\n}\n\nLoading_Manager.prototype = {\n\tconstructor: Loading_Manager,\n\tget: function (name) {\n\t\treturn this.resources[name];\n\t},\n\n\tget_async: function (name, callback) {\n\t\t//already loaded?\n\t\tvar texture = this.get(name);\n\t\tif (texture) {\n\t\t\tif (callback) {\n\t\t\t\tcallback(texture);\n\t\t\t}\n\t\t\treturn texture;\n\t\t}\n\n\t\t//if not load this async\n\t\tvar self = this;\n\t\ttexture = this.texture_loader.load(name, function (texture) {\n\t\t\tif (callback) {\n\t\t\t\tcallback(texture);\n\t\t\t}\n\t\t});\n\t\tthis.resources[name] = texture;\n\t\treturn texture;\n\t},\n\n\tload_list: function (resource_list, on_load, load_func, on_progress) {\n\t\tvar self = this;\n\n\t\tvar cl = new Chain_Loader();\n\t\tvar self = this;\n\t\tcl.onerror = function (error) {\n\t\t\tconsole.error(\"ERROR loading texture\", error, cl.list[cl.index]);\n\t\t};\n\t\tcl.item_loaded = function (resource, name) {\n\t\t\tself.resources[name] = resource;\n\t\t\tif (self.on_resource_loaded) {\n\t\t\t\tself.on_resource_loaded(resource);\n\t\t\t}\n\t\t};\n\t\tcl.on_progress = function () {\n\t\t\tif (on_progress) {\n\t\t\t\ton_progress();\n\t\t\t}\n\t\t};\n\t\tcl.load_func = function () {\n\t\t\tload_func.apply(this, arguments);\n\t\t};\n\t\tcl.finished = function () {\n\t\t\tif (on_load) {\n\t\t\t\ton_load();\n\t\t\t}\n\t\t};\n\t\tcl.start(resource_list);\n\t},\n\n\tload_list_textures: function (resource_list, on_load) {\n\t\tvar self = this;\n\t\tthis.load_list(resource_list, on_load, function (url, next, error, progress) {\n\t\t\tvar texture = self.texture_loader.load(url, next, progress, error);\n\t\t});\n\t},\n\n\tload_list_json: function (resource_list, on_load, progress) {\n\t\tvar self = this;\n\t\tvar loader = new THREE.XHRLoader();\n\t\tthis.load_list(resource_list, on_load, function (url, next, error, progress) {\n\t\t\tvar texture = loader.load(url, next, progress, error);\n\t\t}, progress);\n\t},\n\n\tfree: function () {\n\t\tthis.resources = {};\n\t}\n};\n\n__WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].Texture_Manager = new Loading_Manager();\n\n\n\n/***/ }),\n/* 22 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Package_Manager; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__my_lib_js__ = __webpack_require__(0);\n//TODO: remove this ugly crap and replace something reasonable\n\n\n\n//this ugly class loading texture list in json format, parse it, and loading textures\n//then it call event data_loaded, when give texture list in json format\n\nfunction Package_Manager() {\n    this.state = {};\n}\n\n//load json file with descriptions of package: texture list, particles list, scene objects list\nPackage_Manager.prototype.load = function (url, defaults) {\n    this.defaults = defaults;\n    var self = this;\n    this.state = {\n        \"type\": \"start\"\n    };\n\n    var self = this;\n    function onload(data) {\n        self.state[\"type\"] = \"done\";\n        self.state[\"data\"] = data;\n\n        self.parse_package_description(data);\n    }\n    function error(event) {\n        self.state[\"type\"] = \"error\";\n        self.state[\"error\"] = event;\n        console.error(\"ERror! Failed loading resources with url \" + url, event.target);\n        if (self.error) {\n            self.error(event.target);\n        }\n        self.pack = self.defaults;\n        self.load_resources(self.defaults);\n    }\n    function progress() {}\n    var xhr = new THREE.XHRLoader();\n    xhr.load(url, onload, progress, error);\n};\n\n//parse loaded json file \nPackage_Manager.prototype.parse_package_description = function (data) {\n    console.log(\"packaged description loaded, begin parsing...\");\n    try {\n        var pack = JSON.parse(data);\n        this.pack = pack;\n        if (this.loaded) {\n            this.loaded(pack);\n        }\n    } catch (e) {\n        console.error(\"error parsing resources \", e);\n        if (this.error) {\n            this.error(event);\n        }\n        return;\n    }\n    this.load_resources(pack);\n};\n\nPackage_Manager.prototype.load_resources = function (pack) {\n    var self = this;\n    //load textures\n    console.log(\"Package Manager: begin loading textures...\");\n    __WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].Texture_Manager.load_list_textures(pack.textures, function () {\n        //load json descriptions files\n        if (self.data_loaded) {\n            self.data_loaded(pack);\n        }\n    });\n};\n\n\n\n/***/ }),\n/* 23 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Scene_Serializer; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__my_lib_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__particles_particles_manager_js__ = __webpack_require__(15);\n\n\n\nfunction Scene_Serializer(root) {\n    this.animation_library = {};\n}\n\nScene_Serializer.prototype.toJSON = function (root) {\n    this.json = root.toJSON();\n    console.log(\"my lib particle manager\", __WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].particle_manager);\n    this.json[\"particles\"] = __WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].particle_manager.toJSON();\n    var anims = root.collect_animations(root);\n    if (anims.count > 0) {\n        this.json[\"myanimations\"] = anims;\n    }\n\n    return this.json;\n};\n\nScene_Serializer.prototype.create_animations = function (animations) {\n    for (var key in animations) {\n        if (this.animation_library[key] === undefined && Object.prototype.hasOwnProperty.call(animations, key)) {\n            var data = animations[key];\n            //console.log(\"create animations \", data.uuid);            \n            var anim = __WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].Abstract_Fabric(data);\n            if (anim) {\n                this.animation_library[key] = anim;\n            }\n        }\n    }\n};\n\nScene_Serializer.prototype.bind_animations = function (animdata) {\n    if (!animdata) return;\n\n    var bindings = animdata.bindings;\n\n    //console.log(\"bind animation\");\n    var self = this;\n    function copy_animations(obj, bind) {\n        for (var i = 0; i < bind.animations.length; i++) {\n            var anim_uuid = bind.animations[i];\n            obj.add_animation(self.animation_library[anim_uuid]);\n        }\n    }\n\n    for (var i = 0; i < bindings.length; i++) {\n        var bind = bindings[i];\n        var uuid = bind.uuid;\n        var obj = this.root.getObjectByProperty(\"uuid\", uuid);\n        if (obj) {\n            //console.log(\"binding \" + uuid + \" object to animation \"+uuid);\n            copy_animations(obj, bind);\n        }\n    }\n};\n\nScene_Serializer.prototype.load_from_json = function (url) {\n    var self = this;\n    function onload(json) {\n        try {\n            var data = JSON.parse(json);\n        } catch (e) {\n            console.error(\"Failed to parse scene \", e);\n            throw e;\n        }\n        if (data === undefined) {\n            console.error(\"Something fucking happened, failed to load scene \", url);\n            return;\n        }\n        self.load(data);\n    }\n    function progress() {}\n    function error(e) {\n        console.error(e.target);\n        throw e;\n    }\n    var xhr = new THREE.XHRLoader();\n    xhr.load(url, onload, progress, error);\n};\n\nScene_Serializer.prototype.load = function (json) {\n    this.animation_library = {};\n    var o = new THREE.ObjectLoader();\n    if (json !== undefined) {\n        this.json = json;\n    }\n    var root = o.parse(this.json, function () {\n        console.log(\"onload\");\n    });\n    this.root = root;\n\n    __WEBPACK_IMPORTED_MODULE_0__my_lib_js__[\"a\" /* My_Lib */].particle_manager.load_particles(this.json, root);\n\n    this.create_animations(this.json.myanimations.animations);\n    this.bind_animations(this.json.myanimations);\n    this.main_camera = root.getObjectByName(\"main_camera\");\n\n    if (this.scene_loaded) {\n        this.scene_loaded(root);\n    }\n    return root;\n};\n\n\n\n/***/ }),\n/* 24 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__ = __webpack_require__(17);\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"My_Lib\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"a\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Base_Animation\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"b\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Euler_Animation\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"c\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Scale_Animation\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"d\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Mouse_Intersector\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"e\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Mouse_Camera_Controller\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"f\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Loading_Manager\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"g\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Package_Manager\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"h\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Particles_Points\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"i\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Particle_Emitter\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"j\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Particle_Forces\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"k\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Particle_Affector\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"l\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Point_Generators\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"m\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Custom_Emitter\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"n\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Custom_Affector\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"o\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Cone_Emitter\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"p\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Star_Dust_Emitter\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"q\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Sphere_Emitter\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"r\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Star_Dust_Affector\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"s\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Particle_Shaders\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"t\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Particle_System\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"u\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Particle_Manager\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"v\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Scene_Serializer\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"w\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Application\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"x\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Color_Domain\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"y\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Table_Color\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"z\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Simple_Collider\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"A\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"main_event_hub\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"B\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Event_Hub\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"C\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Mix_It\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"D\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Mixin\", function() { return __WEBPACK_IMPORTED_MODULE_0__engine_main_webpack_js__[\"E\"]; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__gui_main_webpack_js__ = __webpack_require__(18);\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"create_vue_app\", function() { return __WEBPACK_IMPORTED_MODULE_1__gui_main_webpack_js__[\"a\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Color_Picker\", function() { return __WEBPACK_IMPORTED_MODULE_1__gui_main_webpack_js__[\"b\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Texture_Panel\", function() { return __WEBPACK_IMPORTED_MODULE_1__gui_main_webpack_js__[\"c\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Particles_Props\", function() { return __WEBPACK_IMPORTED_MODULE_1__gui_main_webpack_js__[\"d\"]; });\n/* harmony namespace reexport (by provided) */ __webpack_require__.d(__webpack_exports__, \"Particles_Panel\", function() { return __WEBPACK_IMPORTED_MODULE_1__gui_main_webpack_js__[\"e\"]; });\n\n\n\n/***/ }),\n/* 25 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return create_vue_app; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__particles_panel_js__ = __webpack_require__(9);\n\n\nfunction create_vue_app(id) {\n\n  var app2 = new Vue({\n    el: id,\n\n    components: {\n      'particles-panel': __WEBPACK_IMPORTED_MODULE_0__particles_panel_js__[\"a\" /* Particles_Panel */]\n    },\n    data: {\n      particles: [],\n      textures: []\n    },\n    template: '<div id=\"app\">\\\r\n            <particles-panel :particles=\"particles\" :textures=\"textures\"></particles-panel>\\\r\n            </div>'\n  });\n\n  return app2;\n}\n\n\n\n/***/ }),\n/* 26 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Mixin; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_mouse_camera_controller_js__ = __webpack_require__(3);\n\n\nfunction Mixin() {\n\n    //need for unproject object and dragging\n    THREE.PerspectiveCamera.prototype.get_forward_plane_by_object = function (obj) {\n        var z = new THREE.Vector3();\n        z.setFromMatrixColumn(this.matrixWorld, 2);\n        var dist = obj.position.dot(z);\n        var plane = new THREE.Plane(z.negate(), dist);\n        return plane;\n    };\n\n    THREE.PerspectiveCamera.prototype.get_ray_from_screen_coordinates = function (canvas, x, y) {\n        var mc = new __WEBPACK_IMPORTED_MODULE_0__base_mouse_camera_controller_js__[\"a\" /* Mouse_Camera_Controller */](canvas, this);\n        var ray = mc.get_ray_from_camera_in_screen_coordinates(x, y);\n        return ray;\n    };\n}\n\nMixin();\n\n\n/***/ }),\n/* 27 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Mix_It; });\nfunction Mix_It() {\n\n    //FIX\n    THREE.Vector3.prototype.applyMatrix4_rotation = function (m) {\n        // input: THREE.Matrix4 affine matrix\n\n        var x = this.x,\n            y = this.y,\n            z = this.z;\n        var e = m.elements;\n\n        this.x = e[0] * x + e[4] * y + e[8] * z;\n        this.y = e[1] * x + e[5] * y + e[9] * z;\n        this.z = e[2] * x + e[6] * y + e[10] * z;\n\n        return this;\n    };\n\n    var Object3D_Animation_Mixin = {\n\n        add_animation: function (anim) {\n            if (!this.animations) {\n                this.animations = [];\n            }\n            if (this.animations.indexOf(anim) < 0) {\n                this.animations.push(anim);\n            }\n        },\n\n        remove_animation: function (anim) {\n            if (this.animations) {\n                var i = this.animations.indexOf(anim);\n                if (i > -1) {\n                    this.animations.splice(i, 1);\n                }\n            }\n        },\n\n        update: function (dt) {\n            //console.log(\"object update\", dt);\n            if (this.animations !== undefined) {\n                for (var i = 0; i < this.animations.length; i++) {\n                    var anim = this.animations[i];\n                    anim.update(dt);\n                    //console.log(this.rotation);\n                    anim.apply(this);\n                    //console.log(this.rotation);\n                }\n            }\n\n            for (var i = 0; i < this.children.length; i++) {\n                var obj = this.children[i];\n                if (obj.update) {\n                    obj.update(dt);\n                }\n            }\n        }\n\n    };\n    _.copy_object(THREE.Object3D.prototype, Object3D_Animation_Mixin);\n\n    THREE.Object3D.prototype.old_toJson = THREE.Object3D.toJSON;\n\n    var Object3D_Serialization_Mixin = {\n        standard_serialization: function (meta) {\n            // standard Object3D serialization\n            var object = {};\n\n            object.uuid = this.uuid;\n            object.type = this.type;\n            if (this.name !== '') object.name = this.name;\n            if (JSON.stringify(this.userData) !== '{}') object.userData = this.userData;\n            if (this.castShadow === true) object.castShadow = true;\n            if (this.receiveShadow === true) object.receiveShadow = true;\n            if (this.visible === false) object.visible = false;\n\n            object.matrix = this.matrix.toArray();\n\n            if (this.type !== \"particles_points\") {\n                if (this.geometry !== undefined) {\n                    object.geometry = this.geometry.uuid;\n                }\n                if (this.material !== undefined) {\n                    object.material = this.material.uuid;\n                }\n\n                if (this.material !== undefined && meta.materials[this.material.uuid] === undefined) {\n                    meta.materials[this.material.uuid] = this.material.toJSON(meta);\n                }\n\n                if (this.geometry !== undefined && meta.geometries[this.geometry.uuid] === undefined) {\n                    meta.geometries[this.geometry.uuid] = this.geometry.toJSON(meta);\n                }\n            }\n\n            if (this.animations) {\n                object.animations = [];\n                for (var i = 0; i < this.animations.length; i++) {\n                    object.animations.push(this.animations[i].uuid);\n                }\n            }\n\n            if (this.children.length > 0) {\n                object.children = [];\n                for (var i = 0; i < this.children.length; i++) {\n                    var child = this.children[i];\n                    //object.children.push( child.standard_serialization( meta ) );\n                    object.children.push(child.toJSON(meta));\n                }\n            }\n            return object;\n        },\n\n        collect_materials: function (meta) {\n            if (this.material !== undefined && meta.materials[this.material.uuid] === undefined) {\n                meta.materials[this.material.uuid] = this.material.toJSON(meta);\n            }\n\n            for (var i = 0; i < this.children.length; i++) {\n                this.children[i].collect_materials(meta);\n            }\n        },\n\n        collect_geometry: function (meta) {\n            if (this.geometry !== undefined && meta.geometries[this.geometry.uuid] === undefined) {\n                meta.geometries[this.geometry.uuid] = this.geometry.toJSON(meta);\n            }\n\n            for (var i = 0; i < this.children.length; i++) {\n                this.children[i].collect_geometry(meta);\n            }\n        },\n\n        toJSON1: function (meta) {\n\n            // extract data from the cache hash\n            // remove metadata on each item\n            // and return as array\n            function extractFromCache(cache, t) {\n                var values = [];\n                for (var key in cache) {\n                    var data = cache[key];\n                    delete data.metadata;\n                    values.push(data);\n                }\n                return values;\n            }\n\n            this.updateMatrixWorld(true);\n\n            // meta is '' when called from JSON.stringify\n            var isRootObject = meta === undefined || meta === '';\n\n            var output = {};\n\n            if (isRootObject) {\n\n                meta = {\n                    geometries: {},\n                    materials: {},\n                    textures: {},\n                    images: {}\n                };\n\n                //this.collect_materials(meta);\n                //this.collect_geometry(meta);\n                var object = this.standard_serialization(meta);\n\n                output.metadata = {\n                    version: 4.4,\n                    type: 'Object',\n                    generator: 'Object3D.toJSON'\n                };\n\n                var geometries = extractFromCache(meta.geometries, \"geoim\");\n                var materials = extractFromCache(meta.materials, \"materials\");\n                var textures = extractFromCache(meta.textures, \"textures\");\n                var images = extractFromCache(meta.images, \"images\");\n\n                if (geometries.length > 0) output.geometries = geometries;\n                if (materials.length > 0) output.materials = materials;\n                if (textures.length > 0) output.textures = textures;\n                if (images.length > 0) output.images = images;\n\n                var anims = this.collect_animations(this);\n                if (anims.count > 0) {\n                    output[\"myanimations\"] = anims;\n                }\n\n                output.object = object;\n            } else {\n                output.object = this.standard_serialization(meta);\n                output.type = this.type;\n                if (output.object === undefined) {\n                    console.log(\"i am undefined\", this);\n                }\n            }\n\n            return output;\n        },\n\n        collect_animations: function (scene) {\n            var data = {\n                animations: {},\n                bindings: [],\n                count: 0\n            };\n\n            function collect_animations_recursive(root) {\n                if (root.animations) {\n                    for (var i = 0; i < root.animations.length; i++) {\n                        var anim = root.animations[i];\n                        if (data.animations[anim.uuid] === undefined) {\n                            data.animations[anim.uuid] = anim.toJSON();\n                            data.count++;\n                        }\n                    }\n\n                    var bind = {};\n                    bind.uuid = root.uuid;\n                    bind.animations = [];\n                    for (var i = 0; i < root.animations.length; i++) {\n                        bind.animations.push(root.animations[i].uuid);\n                    }\n                    data.bindings.push(bind);\n                }\n\n                if (root.children) {\n                    for (var i = 0; i < root.children.length; i++) {\n                        collect_animations_recursive(root.children[i]);\n                    }\n                }\n            }\n            collect_animations_recursive(scene);\n            return data;\n        }\n\n    };\n\n    _.copy_object(THREE.Object3D.prototype, Object3D_Serialization_Mixin);\n\n    THREE.Object3D.prototype.dm_mark = 'yes,this object has been marked by black magic, owned by me, dark matters';\n\n    //replace source with this\n    THREE.Object3D.prototype.replace_object_with_this = function (source) {\n\n        this.uuid = source.uuid;\n        this.name = source.name;\n\n        this.up.copy(source.up);\n        this.position.copy(source.position);\n        this.quaternion.copy(source.quaternion);\n        this.scale.copy(source.scale);\n\n        this.matrix.copy(source.matrix);\n        this.matrixWorld.copy(source.matrixWorld);\n\n        this.matrixAutoUpdate = source.matrixAutoUpdate;\n        this.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\n\n        this.visible = source.visible;\n\n        this.castShadow = source.castShadow;\n        this.receiveShadow = source.receiveShadow;\n\n        this.frustumCulled = source.frustumCulled;\n        this.renderOrder = source.renderOrder;\n\n        this.userData = JSON.parse(JSON.stringify(source.userData));\n\n        //copy array of children, not clone\n        for (var i = 0; i < source.children.length; i++) {\n            this.add(source.children[i]);\n        }\n        source.parent.add(this);\n        source.parent.remove(source);\n\n        this.animations = source.animations;\n    };\n}\n\nMix_It();\n\n\n\n/***/ }),\n/* 28 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Custom_Affector; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__particle_affector_js__ = __webpack_require__(1);\n\n\n\nfunction Custom_Affector() {\n    __WEBPACK_IMPORTED_MODULE_1__particle_affector_js__[\"a\" /* Particle_Affector */].apply(this, arguments);\n    this.custom_func = function dummy() {\n        return true;\n    };\n}\n\nCustom_Affector.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_1__particle_affector_js__[\"a\" /* Particle_Affector */].prototype);\n\n_.copy_object(Custom_Affector.prototype, {\n    constructor: Custom_Affector,\n    affect: function (dt, pdata, vert) {\n        return this.custom_func(dt, p, vert);\n    },\n    test_func: function () {\n        var p = {\n            position: { x: 0, y: 0, z: 0 },\n            velocity: { x: 0, y: 0, z: 0 }\n        };\n        var color = { r: 0, g: 0, b: 0 };\n        this.custom_func(p, color);\n    },\n    set_affect_function: function (source) {\n        if (typeof source === 'function') {\n            this.custom_func = source;\n        } else if (typeof source === 'string') {\n            try {\n                this.custom_func = new Function('dt,p,vert', source);\n                this.test_func();\n            } catch (e) {\n                alert(e);\n                this.custom_func = undefined;\n            }\n            this.source_code = source;\n        }\n    },\n\n    toJSON: function () {\n        var data = {\n            name: \"Custom_Affector\"\n        };\n        data.params = __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Particle_Affector.prototype.toJSON.call(this, this);\n        params[\"source_code\"] = this.source_code;\n        return data;\n    },\n    parse: function (json) {\n        __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Particle_Affector.prototype.parse(this, json);\n        this.set_affect_func(json.source_code);\n    }\n\n});\n\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Custom_Affector\", Custom_Affector);\n\n\n\n/***/ }),\n/* 29 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Custom_Emitter; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__ = __webpack_require__(2);\n\n\n\nfunction Custom_Emitter() {\n    __WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__[\"a\" /* Particle_Emitter */].apply(this, arguments);\n}\n\nCustom_Emitter.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_1__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype);\n\nvar methods = {\n    emit: function (p, color) {\n        if (this.custom_func) {\n            this.custom_func(p, color);\n        }\n    },\n    test_func: function () {\n        var p = {\n            position: { x: 0, y: 0, z: 0 },\n            velocity: { x: 0, y: 0, z: 0 }\n        };\n        var color = { r: 0, g: 0, b: 0 };\n        this.custom_func(p, color);\n    },\n    set_emit_function: function (source) {\n        if (typeof source === 'function') {\n            this.custom_func = source;\n        } else if (typeof source === 'string') {\n            try {\n                this.custom_func = new Function('p', 'color', source);\n                this.test_func();\n            } catch (e) {\n                alert(e);\n                this.custom_func = undefined;\n            }\n            this.source_code = source;\n        }\n    },\n    toJSON: function () {\n        var data = {};\n        data.name = \"Custom_Emitter\";\n        data.params = __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Particle_Emitter.prototype.toJSON.call(this, this);\n        if (this.source_code) {\n            data.params.source_code = this.source_code;\n        }\n        return data;\n    },\n    parse: function (data) {\n        __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Particle_Emitter.prototype.parse.call(this, data);\n        this.set_emit_function(data.source_code);\n    },\n    constructor: Custom_Emitter\n};\n\n_.copy_object(Custom_Emitter.prototype, methods);\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Custom_Emitter\", Custom_Emitter);\n\nfunction test() {\n    var t = new Custom_Emitter();\n    var source = 'p.position.z = -100; p.velocity.y = 100;';\n    t.set_emit_function(source);\n    var p = {\n        velocity: { x: 0, y: 0, z: 0 },\n        position: { x: 0, y: 0, z: 0 }\n    };\n    t.custom_func(p);\n    console.log(p);\n    var json = t.toJSON();\n    console.log(json);\n\n    t = new Custom_Emitter();\n    t.parse(json.params);\n    //console.log(t.custom_func);    \n}\n\n//test();\n\n/*\r\nCustom_Emitter.prototype = Object.create(My_Lib.Particle_Emitter.prototype);\r\nCustom_Emitter.prototype.constructor = Cone_Emitter;\r\nMy_Lib.Register_Class(\"Custom_Emitter\", Cone_Emitter);\r\n*/\n\n\n\n/***/ }),\n/* 30 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Particle_Forces; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n\n\nvar Particle_Forces = {};\n\n//base class\nParticle_Forces.Force = function () {};\n\n_.copy_object(Particle_Forces.Force.prototype, {\n\tcalc: function (dt, particle, acceleration) {},\n\ttoJSON: function (child) {\n\t\treturn {};\n\t},\n\tparse: function (json) {}\n});\n\n//constant force\nParticle_Forces.Constant_Force = function (force) {\n\tif (typeof force !== 'undefined') {\n\t\tthis.force = force;\n\t} else {\n\t\tthis.force = { x: 0, y: 0, z: 0 };\n\t}\n};\n\nParticle_Forces.Constant_Force.prototype = Object.create(Particle_Forces.Force.prototype);\n_.copy_object(Particle_Forces.Constant_Force.prototype, {\n\tconstructor: Particle_Forces.Constant_Force,\n\tcalc: function (dt, p, acceleration) {\n\t\tacceleration.x += this.force.x;\n\t\tacceleration.y += this.force.y;\n\t\tacceleration.z += this.force.z;\n\t},\n\ttoJSON: function (child) {\n\t\tvar data = {};\n\t\tdata.name = \"Constant_Force\";\n\t\tdata.force = _.create_clone_object(this.force);\n\t\treturn data;\n\t},\n\tparse: function (json) {\n\t\tif (json.force) {\n\t\t\t_.copy_object(this.force, json.force);\n\t\t}\n\t}\n});\n\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Constant_Force\", Particle_Forces.Constant_Force);\n\n\n\n/***/ }),\n/* 31 */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return Cone_Emitter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"b\", function() { return Star_Dust_Emitter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"c\", function() { return Sphere_Emitter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"d\", function() { return Star_Dust_Affector; });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__ = __webpack_require__(0);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__point_generators_js__ = __webpack_require__(16);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__ = __webpack_require__(2);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__particle_affector_js__ = __webpack_require__(1);\n\n\n\n\n\nfunction Cone_Emitter() {\n\t__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].apply(this, arguments);\n\tthis.generator = new __WEBPACK_IMPORTED_MODULE_1__point_generators_js__[\"a\" /* Point_Generators */].Random_Direction();\n\tthis.origin = new THREE.Vector3(1, 1, 0);\n\tthis.velocity = new THREE.Vector3(0, 1, 0);\n\tthis.dispersion = { \"min\": 5, \"max\": 10 };\n\tthis.dispersion.delta = 5;\n\tthis.speed = { min: 5, max: 10, delta: 5 };\n\tthis.color = new THREE.Color(1, 1, 1);\n}\n\nCone_Emitter.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype);\nCone_Emitter.prototype.constructor = Cone_Emitter;\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Cone_Emitter\", Cone_Emitter);\n\nCone_Emitter.prototype.toJSON = function () {\n\tvar data = {};\n\tdata.name = \"Cone_Emitter\";\n\tdata.params = __WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype.toJSON.call(this, this);\n\t_.clone_field_list_one_level_recursion(this, data.params, [\"origin\", \"velocity\", \"dispersion\", \"speed\"]);\n\n\treturn data;\n};\n\nCone_Emitter.prototype.parse = function (data) {\n\t__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype.parse.call(this, data);\n\tthis.origin.copy(data.origin);\n\tthis.velocity.copy(data.velocity);\n\tthis.set_dispersion(data.dispersion.min, data.dispersion.max);\n\tthis.set_speed(data.speed.min, data.speed.max);\n};\n\nCone_Emitter.prototype.set_speed = function (min, max) {\n\tthis.speed.min = min;\n\tthis.speed.max = max;\n\tthis.speed.delta = max - min;\n};\n\nCone_Emitter.prototype.set_dispersion = function (min, max) {\n\tthis.dispersion.min = min;\n\tthis.dispersion.max = max;\n\tthis.dispersion.delta = max - min;\n};\n\nCone_Emitter.prototype.emit = function (p, color, matrix) {\n\tp.position.copy(this.origin);\n\n\tthis.generator.get_direction(p.velocity);\n\tp.velocity.multiplyScalar(Math.random() * this.dispersion.delta + this.dispersion.min);\n\tp.velocity.add(this.velocity).normalize();\n\n\tif (matrix) {\n\t\tp.position.applyMatrix4(matrix);\n\t\tp.velocity.applyMatrix4_rotation(matrix);\n\t}\n\n\tp.velocity.multiplyScalar(Math.random() * this.speed.delta + this.speed.min);\n\n\tif (color) {\n\t\tthis.emit_color(color);\n\t}\n};\n\nCone_Emitter.prototype.emit_color = function (color) {\n\tcolor.copy(this.color);\n};\n\nfunction Sphere_Emitter(radius, speed) {\n\t__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].call(this);\n\tthis.radius = radius || 1;\n\tthis.speed = speed || 1;\n\tthis.generator = new __WEBPACK_IMPORTED_MODULE_1__point_generators_js__[\"a\" /* Point_Generators */].Sphere(radius);\n\tthis.from_center = true;\n\tObject.defineProperty(this, 'radius', {\n\t\tconfigurable: true,\n\t\tenumerable: true,\n\t\tset: function (value) {\n\t\t\tradius = value;generator.radius = value;\n\t\t}\n\t});\n}\n\nSphere_Emitter.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype);\n\n_.copy_object(Sphere_Emitter.prototype, {\n\tconstructor: Sphere_Emitter,\n\temit: function (p, color, matrix) {\n\t\tif (this.from_center) {\n\t\t\tp.position.set(0, 0, 0);\n\t\t} else {\n\t\t\tthis.generator.get_point(p.position);\n\t\t}\n\t\tthis.generator.get_normal(p.velocity);\n\t\tif (matrix) {\n\t\t\tp.position.applyMatrix4(matrix);\n\t\t\tp.velocity.applyMatrix4_rotation(matrix);\n\t\t}\n\t\tp.velocity.multiplyScalar(this.speed);\n\t},\n\ttoJSON: function (json) {\n\t\tvar params = __WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype.toJSON.call(this, this);\n\t\tparams.radius = this.radius;\n\t\tparams.speed = this.speed;\n\t\t//params.generator.radius = this.radius;\n\t},\n\tparse: function (json) {\n\t\t__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype.parse.call(this, json);\n\t\tthis.radius = json.radius;\n\t\tthis.speed = json.speed;\n\t}\n});\n\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Sphere_Emitter\", Sphere_Emitter);\n\nfunction Star_Dust_Emitter() {\n\t__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].apply(this, arguments);\n\tthis.start_position = new THREE.Vector3(0, 0, 0);\n\tthis.end_position = new THREE.Vector3(1, 1, 1);\n\tthis.delta = new THREE.Vector3(1, 1, 1);\n\tthis.velocity = new THREE.Vector3(0, 0, 1);\n}\n\nStar_Dust_Emitter.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype);\nStar_Dust_Emitter.prototype.constructor = Star_Dust_Emitter;\n_.copy_object(Star_Dust_Emitter.prototype, {\n\tset_velocity: function (x, y, z) {\n\t\tthis.velocity.set(x, y, z);\n\t},\n\tset_position_range: function (start, end) {\n\t\tthis.start_position.copy(start);\n\t\tthis.end_position.copy(end);\n\t\tthis.delta.set(end.x - start.x, end.y - start.y, end.z - start.z);\n\t},\n\tget_position: function (vector) {\n\t\tvector.x = Math.random() * this.delta.x + this.start_position.x;\n\t\tvector.y = Math.random() * this.delta.y + this.start_position.y;\n\t\tvector.z = Math.random() * this.delta.z + this.start_position.z;\n\t},\n\tget_velocity: function (vector) {\n\t\tvector.x = this.velocity.x;\n\t\tvector.y = this.velocity.y;\n\t\tvector.z = this.velocity.z;\n\t},\n\temit: function (p) {\n\t\tthis.get_position(p.position);\n\t\tif (this.parent) {\n\t\t\tthis.parent.localToWorld(p.position);\n\t\t}\n\t\tthis.get_velocity(p.velocity);\n\t},\n\ttoJSON: function () {\n\t\tvar params = __WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype.toJSON.call(this, this);\n\t\t_.clone_field_list_one_level_recursion(this, params, [\"velocity\", \"start_position\", \"end_position\"]);\n\t\tvar data = {\n\t\t\t\"name\": \"Star_Dust_Emitter\",\n\t\t\t\"params\": params\n\t\t};\n\t\treturn data;\n\t},\n\tparse: function (json) {\n\t\t__WEBPACK_IMPORTED_MODULE_2__particle_emitter_js__[\"a\" /* Particle_Emitter */].prototype.parse.call(this, json);\n\t\tthis.set_position_range(json.start_position, json.end_position);\n\t\tthis.velocity.copy(json.velocity);\n\t}\n\n});\n\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Star_Dust_Emitter\", Star_Dust_Emitter);\n\nfunction Star_Dust_Affector(end) {\n\tthis.end = end || 0;\n}\n\nStar_Dust_Affector.prototype = Object.create(__WEBPACK_IMPORTED_MODULE_3__particle_affector_js__[\"a\" /* Particle_Affector */].prototype);\nStar_Dust_Affector.prototype.constructor = Star_Dust_Affector;\n\n_.copy_object(Star_Dust_Affector.prototype, {\n\taffect: function (dt, pdata, vert) {\n\t\tif (pdata.position.z > this.end) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t},\n\ttoJSON: function () {\n\t\tvar params = __WEBPACK_IMPORTED_MODULE_3__particle_affector_js__[\"a\" /* Particle_Affector */].prototype.toJSON.call(this, this);\n\t\tparams[\"end\"] = this.end;\n\t\tvar data = {\n\t\t\t\"name\": \"Star_Dust_Affector\",\n\t\t\t\"params\": params\n\n\t\t};\n\t\treturn data;\n\t},\n\tparse: function (json) {\n\t\t__WEBPACK_IMPORTED_MODULE_3__particle_affector_js__[\"a\" /* Particle_Affector */].prototype.parse(this, json);\n\t\tthis.end = json.end;\n\t}\n});\n\n__WEBPACK_IMPORTED_MODULE_0__base_my_lib_js__[\"a\" /* My_Lib */].Register_Class(\"Star_Dust_Affector\", Star_Dust_Affector);\n\n\n\n/***/ })\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// editor.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 24);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 816df26b4431ef110f22","/*\r\n*/\r\n\r\n\r\nvar My_Lib = {};\r\n\r\nMy_Lib.Viewport = {};\r\n\r\n\r\nMy_Lib.Object_Animation = function (object, animation)\r\n{\r\n\tthis.object = object;\r\n\tthis.animation = animation;\r\n}\r\n\r\nMy_Lib.Object_Animation.prototype.update = function (dt)\r\n{\r\n\tthis.animation(this.object, dt);\r\n}\r\n\r\nMy_Lib.create_text_image = function (width, height, text, npot, background) \r\n{\r\n\t// create a canvas element\r\n\tvar canvas = document.createElement('canvas');\r\n\tcanvas.width = width;\r\n\tcanvas.height = height;\r\n\tvar context = canvas.getContext('2d');\r\n\tif (background) \r\n\t{\r\n\t\tcontext.fillStyle = background;\r\n\t\tcontext.fillRect(0, 0, canvas.width, canvas.height);\r\n\t}\r\n\tcontext.font = \"Bold 40px Arial\";\r\n\tcontext.fillStyle = \"rgba(0,255,0,0.95)\";\r\n    context.fillText('Hello, world!', 0, 50);\r\n    \r\n\t// canvas contents will be used for a texture\r\n\tvar texture = new THREE.Texture(canvas) \r\n\tif (npot) {\r\n\t\ttexture.wrapS = texture.wrapT = THREE.TextureWrapping.ClampToEdgeWrapping;\r\n\t\ttexture.minFilter = THREE.LinearFilter;\r\n\t}\r\n\ttexture.needsUpdate = true; \t\r\n\treturn texture;\r\n}\r\n\r\n\r\nMy_Lib.Create_Quad = function (width, height, vertex_shader, fragment_shader)\r\n{\r\n\t//plane created turn away from camera\r\n\tvar plane = new THREE.PlaneBufferGeometry( width, height);\r\n\t\r\n\tvar material = new THREE.ShaderMaterial( {\r\n\t\tvertexShader: vertex_shader,\r\n\t\tfragmentShader: fragment_shader\r\n\t} ); \r\n\r\n\tvar quad = new THREE.Mesh( plane, material );\r\n\tquad.rotation.y = Math.PI;\r\n\treturn quad;\r\n}\r\n\r\n\r\nMy_Lib.Render_Target = function (width, height)\r\n{\r\n\tthis.target = new THREE.WebGLRenderTarget( \r\n\twidth, \r\n\theight, \r\n\t{ \r\n\t\tminFilter: THREE.LinearFilter, \r\n\t\tmagFilter: THREE.NearestFilter, \r\n\t\tformat: THREE.RGBFormat \r\n\t} ); \r\n\t\r\n\tthis.camera = new THREE.PerspectiveCamera(80, width/height, 0.1, 1000);\r\n}\r\n\r\nMy_Lib.Render_Target.prototype.render = function (scene, renderer)\r\n{\r\n\trenderer.render( scene, \r\n\t\tthis.camera, \r\n\t\tthis.target, \r\n\t\ttrue  //forceClear\r\n\t\t);\r\n}\r\n\r\n\r\nMy_Lib.create_overlay_camera = function (width, height)\r\n{\r\n\tvar camera =  new THREE.OrthographicCamera( \r\n\t\twidth / - 2, \r\n\t\twidth / 2, \r\n\t\theight / 2, \r\n\t\theight /- 2, -10000, 10000 );\r\n\treturn camera;\r\n}\r\n\r\nMy_Lib.Overlay = function (width, height)\r\n{\r\n\tthis.camera = My_Lib.create_overlay_camera(width, height);\r\n}\r\n\r\nMy_Lib.Overlay.prototype.render = function (renderer)\r\n{\r\n\tif (!this.scene) {\r\n\t\treturn;\r\n\t}\r\n\t\r\n\trenderer.autoClear = false;\r\n\trenderer.render(this.scene, this.camera);\r\n\trenderer.autoClear = true;\r\n}\r\n\r\n\r\nMy_Lib.Mouse_Controller = function (root, over, click, callback)\r\n{\r\n\tthis.root = root;\r\n\tthis.over = over;\r\n\tthis.click = !!click;\r\n\tthis.callback = callback;\r\n}\r\n\r\n\r\n\r\n/*\r\nugly hack\r\n*/\r\n\r\nMy_Lib.event_hub = new Event_Hub();\r\n\r\nfunction Event_Hub() {\r\n    this.events = {};\r\n}\r\n\r\n\r\n\r\nEvent_Hub.prototype.add_event_listener = function (name, func, obj)\r\n{\r\n    if (!this.events[name]) {\r\n        this.events[name] = [];\r\n    }\r\n    this.events[name].push( {name: name, func: func, obj: obj} );\r\n}\r\n\r\nEvent_Hub.prototype.on  = Event_Hub.prototype.add_event_listener;\r\n\r\nEvent_Hub.prototype.emit = function(name, obj)\r\n{\r\n    var listeners = this.events[name];\r\n    if (listeners) {\r\n        for(var i = 0; i < listeners.length; i++) {\r\n            var t = listeners[i];\r\n            t.func.call(t.obj, obj);            \r\n        }\r\n    }\r\n}\r\n\r\n\r\nvar run_function = //window.requestAnimationFrame;\r\n\tfunction(callback){\r\n\t\twindow.setTimeout(callback, 1000 / 60);\r\n\t}\r\n\r\n\r\nMy_Lib.create_run_function = function (app) \r\n{\r\n    My_Lib.run = function () { run_function( function () { app.loop(); }); }\r\n}\r\n\r\n\r\n\r\n\r\nMy_Lib.Euler_Controller = function (obj, x, y, z)\r\n{\r\n\tthis.obj = obj;\r\n\tthis.xspeed = x * Math.PI / 180;;\r\n\tthis.yspeed = y * Math.PI / 180;;\r\n\tthis.zspeed = z * Math.PI / 180;;\r\n}\r\n\r\nMy_Lib.Euler_Controller.prototype.update = function (dt)\r\n{\r\n\tthis.obj.rotation.x += this.xspeed * dt;\r\n\tthis.obj.rotation.y += this.yspeed * dt;\r\n\tthis.obj.rotation.z += this.zspeed * dt;\r\n}\r\n\r\n//Class Library\r\nMy_Lib.Registered_Classes = {};\r\n\r\nMy_Lib.Register_Class = function (name, func)\r\n{\r\n\tif (My_Lib.Registered_Classes[name]){\r\n\t\tconsole.log(\"Register Class ERROR! Class with this name already exists!\", name);\r\n\t}\r\n\tMy_Lib.Registered_Classes[name] = func;\r\n}\r\n\r\nMy_Lib.Get_Class = function (name)\r\n{\r\n\treturn My_Lib.Registered_Classes[name];\r\n}\r\n\r\n\r\nMy_Lib.create_class = function(parent, child, props, name)\r\n{\r\n    if (parent) {\r\n        child.prototype = Object.create(parent.prototype);\r\n    } \r\n    _.copy_object(child.prototype, props);\r\n    child.prototype.contructor = child;                \r\n    My_Lib.Register_Class(child, name);\r\n}\r\n\r\nMy_Lib.Abstract_Fabric = function (data)\r\n{\r\n    var constructor = My_Lib.Get_Class(data.type);\r\n    if (constructor) {\r\n        var object = new constructor();\r\n        object.parse(data);\r\n        return object;\r\n    }\r\n    return undefined;\r\n}\r\n\r\nMy_Lib.Print_Classes = function ()\r\n{\r\n    for(var key in this.Registered_Classes) {\r\n        console.log(\"class registered :\", key, this.Registered_Classes[key]);\r\n    }\r\n}\r\n\r\n\r\nexport { My_Lib };\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/base/my_lib.js","import {My_Lib} from '../base/my_lib.js';\r\n\r\n//base class for particle affector\r\nfunction Particle_Affector()\r\n{\r\n    this.id = _.generateUUID();\r\n}\r\n\r\n\r\nParticle_Affector.prototype.affect = function (dt, pdata, vert, color)\r\n{\r\n\treturn true;\r\n}\r\n\r\nParticle_Affector.prototype.toJSON = function (child)\r\n{\r\n\tif (child) {\r\n\t\treturn {};\r\n\t}\r\n\tvar data = {\r\n        id: this.id,\r\n\t\t\"name\": \"Particle_Affector\",\r\n\t\tparams : {}\r\n\t};\r\n    if (child) {\r\n        return params;\r\n    }\r\n\treturn data;\r\n}\r\n\r\nParticle_Affector.prototype.parse = function (json)\r\n{\r\n}\r\n\r\nMy_Lib.Register_Class(\"Particle_Affector\", Particle_Affector);\r\n\r\nfunction Force_Affector()\r\n{\r\n    Particle_Affector.call(this);\r\n\tthis.forces = new Array();\r\n}\r\n\r\nForce_Affector.prototype = Object.create(Particle_Affector.prototype);\r\n\r\n_.copy_object(Force_Affector.prototype, {\r\n\tconstructor: Force_Affector,\r\n\tadd_force: function (force)\r\n\t{\r\n\t\tthis.forces.push(force);\r\n\t},\r\n\tapply_forces: function (dt, particle, vert, color)\r\n\t{\r\n\t\tvar acceleration = {x:0, y:0, z:0};\r\n\t\tfor(var i = 0; i < this.forces.length; i++) {\r\n\t\t\tthis.forces[i].calc(dt, particle, acceleration);\r\n\t\t}\r\n\t\t//integrate\r\n\t\tparticle.velocity.x += acceleration.x * dt;\r\n\t\tparticle.velocity.y += acceleration.y * dt;\r\n\t\tparticle.velocity.z += acceleration.z * dt;\r\n\t},\r\n\taffect: function (dt, particle, vert, color)\r\n\t{\r\n\t\tthis.apply_forces(dt, particle, vert, color);\r\n\t\treturn true;\r\n\t},\r\n\ttoJSON: function (child)\r\n\t{\r\n\t\tvar data = {};\r\n\t\tdata.name = \"Force_Affector\";\t\t\r\n        data.uuid = this.uuid;\r\n\t\tdata.params = Particle_Affector.prototype.toJSON.call(this, this);\r\n\t\tif (this.forces.length > 0) {\r\n\t\t\tdata.params.forces = new Array();\r\n\t\t\tfor(var i = 0; i < this.forces.length; i++) {\r\n\t\t\t\tdata.params.forces.push( this.forces[i].toJSON() );\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn data;\r\n\t},\r\n\tparse: function (json)\r\n\t{\r\n\t\tvar f, item;\r\n\t\tif (json.forces) {\r\n\t\t\t\t\r\n\t\t\tfor(var i =0; i < json.forces.length; i++) {\r\n\t\t\t\titem = json.forces[i];\r\n\t\t\t\tf = My_Lib.Get_Class(item.name);\r\n\t\t\t\tif (f) {\r\n\t\t\t\t\tf = new f();\r\n\t\t\t\t\tf.parse(item);\r\n\t\t\t\t\tthis.add_force(f);\r\n\t\t\t\t} \r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n});\r\n\r\nMy_Lib.Register_Class(\"Force_Affector\", Force_Affector);\r\n\r\nexport { Particle_Affector, Force_Affector };\n\n\n// WEBPACK FOOTER //\n// ./src/particles/particle_affector.js","import {My_Lib} from '../base/my_lib.js';\r\n\r\n//Base class for Particle Emitters\r\nfunction Particle_Emitter(emit_per_second)\r\n{\r\n    this.uuid = _.generateUUID();\r\n    this.name = '';\r\n\tthis.emit_delta = 0;\r\n\tthis.emit_count = 0;\r\n\tthis.emit_per_second = emit_per_second || 5;\r\n\t//linear interpolation = min + random * (max-min)\t\r\n\tthis.lifetime = {\"min\": 0, \"max\":2.0};\r\n}\r\n\r\nParticle_Emitter.prototype.emit_life = function ()\r\n{\r\n\treturn this.lifetime.min + Math.random() * (this.lifetime.max - this.lifetime.min);\r\n}\r\n\r\nParticle_Emitter.prototype.calc_emitted_particles = function (dt)\r\n{\r\n\t//count particles need emit\r\n\tthis.emit_delta += this.emit_per_second*dt;\r\n\tvar need_emit = Math.floor(this.emit_delta);\r\n\tif (need_emit > 0) {\r\n\t\tthis.emit_delta -= need_emit;\r\n\t\t//this.emit_count += need_emit;\r\n\t\t//need_emit = this.emit_count;\r\n\t}\r\n\treturn need_emit;\r\n}\r\n\r\n\r\nParticle_Emitter.prototype.emit = function (p, c, matrix)\r\n{\r\n    p.position.set(0, 0, 0);\r\n    p.velocity.set(0, 1, 0);\r\n    \r\n    if (matrix) {\r\n        p.position.applyMatrix4(matrix);\r\n        p.velocity.applyMatrix4_rotation(matrix);\r\n    }\r\n}\r\n\r\n\r\nParticle_Emitter.prototype.toJSON = function (child)\r\n{\r\n\tvar params = {\r\n        \"uuid\": this.uuid,\r\n\t\t\"emit_per_second\": this.emit_per_second,\r\n\t\t\"lifetime\": {\r\n\t\t\t\"min\": this.lifetime.min,\r\n\t\t\t\"max\": this.lifetime.max\r\n\t\t},\r\n\t};\r\n    if (this.name) {\r\n        params.name = this.name;\r\n    }\r\n\tif (child) {\r\n\t\treturn params;\r\n\t}\r\n\tvar data = {};\r\n\tdata.name = \"Particle_Emitter\";\r\n\tdata.params = params;\t\r\n\treturn data;\r\n}\r\n\r\nParticle_Emitter.prototype.parse = function (data)\r\n{\r\n\tthis.emit_per_second = data.emit_per_second;\r\n    this.name = data.name;\r\n    this.uuid = data.uuid || _.generateUUID();\r\n\t_.copy_object(this.lifetime, data.lifetime);\r\n}\r\n\r\nMy_Lib.Register_Class(\"Particle_Emitter\", Particle_Emitter);\r\n\r\nexport { Particle_Emitter };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/particles/particle_emitter.js","//Unfortunately, canvas properties can change permanenty. \r\n//Because, you need do refresh_canvas on each call!\r\n//each time you need recacl BoundingRect and clientRect of the fucking canvas\r\n//also, camera may be not that camera, who render scene. it may be other camera\r\n//because you need refresh camera on eash call\r\n//i could done this normal function, but this object may do different job\r\n//this is single-time object\r\n//it easy economyfy number of arguments on calling functions\r\n\r\n//not, this class doesn't store reference to canvas, \r\n//this store only information about canvas size and position \r\n//i.e. BoundingClientRect and clientWidth,clientHeight\r\n//yes, this class store reference to camera\r\n\r\n//probably, it may be mixin to camera\r\n\r\n\r\nfunction Mouse_Camera_Controller(canvas, camera)\r\n{\r\n    if (canvas === undefined) {\r\n        console.error(\"Mouse_Camera_Controller. Propable premordial creating object. canvas is undefined. Do nothing\");\r\n    } else {\r\n        this.set_canvas_info(canvas);\r\n    }\r\n    this.camera = camera;\r\n}\r\n\r\n_.copy_object(Mouse_Camera_Controller.prototype,{\r\n    constructor : Mouse_Camera_Controller,\r\n    set_canvas_info: function (canvas)\r\n    {\r\n        var offset = canvas.getBoundingClientRect();\r\n        this.offset = \r\n        {\r\n            left: offset.left,\r\n            top : offset.top\r\n        };\r\n        this.width = canvas.clientWidth;\r\n        this.height = canvas.clientHeight;\r\n    },\r\n    refresh_canvas: function (new_canvas)\r\n    {\r\n        this.set_canvas_info(new_canvas);\r\n    }\r\n    ,\r\n    get_normalized_screen_coordinates: function (x,y)\r\n    {\r\n        //step 1 : normalized\r\n        x = (x - this.offset.left) / this.width;\r\n        y = (y - this.offset.top) / this.height;\r\n        //step 2 : from unsigned to signed, translate origin from top left corner to center \r\n        var x = x * 2.0 - 1.0;\r\n        var y = -(y * 2.0 - 1.0);\r\n        var vector = new THREE.Vector3( x, y, 1 );\r\n        return vector;        \r\n    },\r\n    \r\n    //do some what prevent method, only give mouse event instead x,y coordiantes\r\n    get_normalize_mouse_position: function (event) \r\n    {\r\n        return this.get_normalized_screen_coordinates(event.clientX, event.clientY);\r\n    },\r\n    \r\n    //return new unproject vector, not change given\r\n    //used THREE.Vector3.unproject method\r\n    //including apply inver camera matrix\r\n    //on my view, that wrong, because method do it big then promise\r\n    //unproject must do only unproject, not else thing\r\n    //because my need new method, who will do only unproject \r\n    unproject: function(vector)\r\n    {\r\n        var r = new THREE.Vector3();\r\n        r.copy(vector);\r\n        r.unproject(this.camera);\r\n        //this aready done \r\n        //r.applyMatrix4(camera.matrixWorldInverse);    \r\n        return r;\r\n    },\r\n    \r\n    \r\n    //get ray with origin in camera position and direction, \r\n    //pointed to far away where unproject screen point are\r\n    get_ray_from_camera_in_screen_coordinates: function (x,y) \r\n    {\r\n        var vector = this.get_normalized_screen_coordinates(x,y);\r\n        vector = this.unproject(vector);\r\n        var ray = new THREE.Ray( this.camera.position, vector.sub( this.camera.position ).normalize() );\r\n        return ray;\r\n    },\r\n    \r\n    //do same what prevent method, only give mouse event for convience\r\n    //see it as overriding function in C++\r\n    get_ray_from_camera_in_mouse_position: function (event)\r\n    {\r\n        return this.get_ray_from_camera_in_screen_coordinates(event.x, event.y);\r\n    },\r\n\r\n\r\n});\r\n\r\n\r\nexport { Mouse_Camera_Controller };\n\n\n// WEBPACK FOOTER //\n// ./src/base/mouse_camera_controller.js","    \r\nfunction Particles_Points (geometry, material)\r\n{\r\n    THREE.Points.call(this, geometry, material);\r\n    this.type = 'particles_points';\r\n    \r\n    this.boundingSphere = new THREE.Sphere();\r\n    this.boundingSphere.radius = 10.0;\r\n}\r\n\r\nParticles_Points.prototype = Object.create( THREE.Points.prototype )\r\n\r\nParticles_Points.prototype.constructor = Particles_Points;\r\n\r\nParticles_Points.prototype.getBoundingSphere = function()\r\n{\r\n    return this.boundingSphere;\r\n}\r\n\r\nParticles_Points.prototype.toJSON = function (meta)\r\n{\r\n    var mat = this.material;\r\n    var geom = this.geometry;\r\n    this.material = undefined;\r\n    this.geometry = undefined;\r\n    var object =  THREE.Object3D.prototype.toJSON.call(this, meta);\r\n    this.material = mat;\r\n    this.geometry = geom;\r\n    return object;\r\n}\r\n\r\n//WTF?\r\nParticles_Points.prototype.raycast = function (raycaster, intersects)\r\n{\r\n    var sphere = new THREE.Sphere()\r\n    sphere.copy( this.boundingSphere );\r\n    sphere.applyMatrix4( this.matrixWorld ); \r\n    var r = raycaster.ray.intersectsSphere( sphere );\r\n    if ( r === false ) return;\r\n    console.log(\"INTERSECTION1\", this.name, sphere);\r\n    return;\r\n    \r\n    var shit  = new THREE.Vector3();\r\n    shit.copy(this.position);\r\n    var tr = new THREE.Ray( new THREE.Vector3(0, 0, 20), shit);\r\n    console.log(\"test \", tr.intersectsSphere(sphere), sphere);\r\n    console.log(\"hit sphere \"  + this.name, sphere, raycaster.ray);\r\n    return raycaster.ray.intersectsSphere( sphere );\r\n    \r\n    \r\n    console.log(\"hit sphere \" + this.type, \"shpere is \", sphere, \"ray is \", r);\r\n    if (r) {\r\n            var tmp = new THREE.Vector3(this.position);\r\n            tmp.sub(r);\r\n   \t\t\tintersects.push( {\r\n\t\t\t\tdistance: Math.sqrt( tmp.dot(tmp) ),\r\n\t\t\t\tpoint: this.position,\r\n\t\t\t\tobject: this\r\n\t\t\t} ); \r\n    }\r\n}\r\n\r\n\r\nexport {Particles_Points};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/particles/particles_points.js","function Event_Hub() {\r\n    this.events = {};\r\n}\r\n\r\n\r\n\r\nEvent_Hub.prototype.add_event_listener = function (name, func, obj)\r\n{\r\n    if (!this.events[name]) {\r\n        this.events[name] = [];\r\n    }\r\n    this.events[name].push( {name: name, func: func, obj: obj} );\r\n}\r\n\r\nEvent_Hub.prototype.on  = Event_Hub.prototype.add_event_listener;\r\n\r\nEvent_Hub.prototype.emit = function(name, obj)\r\n{\r\n    var listeners = this.events[name];\r\n    if (listeners) {\r\n        for(var i = 0; i < listeners.length; i++) {\r\n            var t = listeners[i];\r\n            t.func.call(t.obj, obj);            \r\n        }\r\n    }\r\n}\r\n\r\nvar main_event_hub = new Event_Hub();\r\n\r\nexport {main_event_hub, Event_Hub};\n\n\n// WEBPACK FOOTER //\n// ./src/base/event_hub.js","var Mouse_Intersector = {};\r\n\r\nimport {Simple_Collider} from \"./simple_collider.js\";\r\nimport {Mouse_Camera_Controller} from './mouse_camera_controller.js';\r\n\r\n\r\nMouse_Intersector.get_normalized_screen_coords = function (canvas, x, y)\r\n{\r\n\tvar offset = canvas.getBoundingClientRect();\r\n\tvar width = canvas.clientWidth;\r\n\tvar height = canvas.clientHeight;\r\n    //normalize coordinates\r\n    var x = (x - offset.left) / width;\r\n    var y = (y - offset.top) / height;\r\n\tvar x = x * 2 - 1;\r\n\tvar y = -(y * 2 - 1);\r\n\tvar vector = new THREE.Vector3( x, y, 1 );\r\n\treturn vector;\r\n}\r\n\r\nMouse_Intersector.mouse_coords_to_vector = function (canvas, event) \r\n{\r\n    return this.get_normalized_screen_coords(canvas, event.clientX, event.clientY);\r\n}\r\n\r\n\r\nMouse_Intersector.unproject = function(vector, camera)\r\n{\r\n    var r = new THREE.Vector3();\r\n    r.copy(vector);\r\n\tr.unproject(camera);\r\n    //this done yet\r\n    //r.applyMatrix4(camera.matrixWorldInverse);    \r\n    return r;\r\n}\r\n\r\nMouse_Intersector.mouse_coords_to_ray = function (canvas, event, camera) \r\n{\r\n    var vector = this.mouse_coords_to_vector(canvas, event);\r\n    vector = this.unproject(vector, camera);\r\n\tvar ray = new THREE.Ray( camera.position, vector.sub( camera.position ).normalize() );\r\n\treturn ray;\r\n}\r\n\r\n\r\n\r\nMouse_Intersector.find_intersection_with_mouse_vector = function(vector, camera, scene)\r\n{\r\n\tvector.unproject(camera);\r\n\tvar ray = new THREE.Raycaster( camera.position, vector.sub( camera.position ).normalize() );\r\n\t// create an array containing all objects in the scene with which the ray intersects\r\n\t//var intersects = ray.intersectObjects( [grid_text.root], true ); \r\n\t//console.log(fake_plane.root.children[0].geometry);\r\n\tvar intersects = ray.intersectObjects( [scene], true ); \r\n\treturn intersects;\r\n}\r\n\r\n\r\nMouse_Intersector.find_intersected_object = function (scene, ray)\r\n{\r\n\r\n    var collider = new Simple_Collider(scene);\r\n    var intersects = collider.check_ray(ray);\r\n    return intersects;\r\n}\r\n\r\n\r\nexport { Mouse_Intersector };\n\n\n// WEBPACK FOOTER //\n// ./src/base/mouse_intersector.js","function Simple_Collider(root, params)\r\n{\r\n    this.root = root;\r\n    if (params === undefined) {\r\n        params = {};\r\n    }\r\n    this.params = \r\n    {\r\n        recursive: params.recursive === undefined ? true : params.recursive,\r\n        check_invisible: params.check_invisible === undefined ? true : params.check_invisible \r\n    };\r\n    this.intersected_objects = [];\r\n    this._tested_sphere = new THREE.Sphere();    \r\n}\r\n\r\nSimple_Collider.prototype.prepare_check = function (ray)\r\n{\r\n    this.intersected_objects = [];\r\n    this.intersected_map = {};\r\n    this._fakecaster = {ray: ray};    \r\n}\r\n\r\nSimple_Collider.prototype.check_ray = function (ray)\r\n{\r\n    this.prepare_check(ray);\r\n    \r\n    this.find_intersection_with_bounding_sphere( this.root); \r\n    \r\n    return this.intersected_objects;\r\n}\r\n\r\nSimple_Collider.prototype.add_intersected = function (obj)\r\n{\r\n    if (!this.intersected_map[obj.uuid]) {\r\n        this.intersected_map[obj.uuid] = obj;\r\n        this.intersected_objects.push(obj);\r\n    }\r\n}\r\n\r\nSimple_Collider.prototype.check_object_bounding_sphere = function(obj)\r\n{\r\n    //get bounding sphere\r\n    if (obj.getBoundingSphere) {\r\n        this._tested_sphere.copy( obj.getBoundingSphere() );\r\n    } else if (obj.geometry)  {\r\n        //fuck this shit, why don't exists method getBoundingSphere, which encapsulates this?\r\n        if ( obj.geometry.boundingSphere === null ) obj.geometry.computeBoundingSphere();\r\n         //copy sphere from object geometry and transform it with object. matrixWorld\r\n        this._tested_sphere.copy( obj.geometry.boundingSphere );\r\n        //console.log(\"get bounding sphere\", this._tested_sphere);\r\n    } else {\r\n        return false;\r\n    }\r\n\r\n    //test bounding spere\r\n    obj.updateMatrixWorld(true);        \r\n    this._tested_sphere.applyMatrix4( obj.matrixWorld );\r\n    //find intersection\r\n    var inter = this._fakecaster.ray.intersectsSphere( this._tested_sphere );\r\n    //console.log(\"inter with sphere, level\", level, inter, sphere.center, raycaster.ray);\r\n    //add to intersected list, if success\r\n    if (inter) {\r\n        this.intersected_objects.push(obj);\r\n        return true;\r\n    } else {\r\n        return false;\r\n    }\r\n}\r\n\r\n\r\nSimple_Collider.prototype.find_intersection_with_bounding_sphere = function(object, top ) {\r\n\r\n    if ( !object.non_collideble && (object.visible || this.params.check_invisible)) {\r\n        this.check_object_bounding_sphere(object);\r\n    }\r\n    if ( !this.params.recursive) return;\r\n    \r\n    \r\n    //test children\r\n    var children = object.children;\r\n    for ( var i = 0; i < children.length; i ++ ) {\r\n        var child = children[i];\r\n        this.find_intersection_with_bounding_sphere( child );\r\n    }\r\n}\r\n\r\n\r\n\r\nexport {Simple_Collider};\n\n\n// WEBPACK FOOTER //\n// ./src/base/simple_collider.js","\r\nvar Color_Picker = {\r\n    props: {\r\n        value: {\r\n            type: Object,\r\n            default: function () {\r\n                return {r: 0, g: 0, b:0}\r\n            }\r\n        }\r\n    },\r\n    template: '<div>\\\r\n    <p>Red Green Blue Color\\\r\n    <p>\\\r\n    <input type=\"range\" min=\"0\" max=\"255\" @change=\"changed\" :value=\"value.r\" ref=\"r\" id=\"r\" >\\\r\n    <input type=\"range\" min=\"0\" max=\"255\" @change=\"changed\" :value=\"value.g\" ref=\"g\" id=\"g\">\\\r\n    <input type=\"range\" min=\"0\" max=\"255\" @change=\"changed\" :value=\"value.b\" ref=\"b\" id=\"b\">\\\r\n    </div>',\r\n    data: function () {\r\n        return {\r\n            new_value : {\r\n                r: 0,\r\n                g: 0,\r\n                b: 0\r\n            }\r\n        }\r\n    },\r\n    methods: {\r\n        changed: function (event) {\r\n            this.value[event.target.id] = event.target.value;\r\n            this.$emit('input', this.value);\r\n        }\r\n    }\r\n};\r\n\r\n\r\n//Vue.component(\"color-picker\", Color_Picker);\r\n\r\nexport {Color_Picker};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/gui/color_picker.js","import {Particles_Props} from './particles_props.js';\r\nimport {Texture_Panel} from './texture_panel.js';\r\n\r\nvar Particles_Panel = \r\n{\r\n    props: {\r\n        particles : {\r\n            type: Object,\r\n            default: function () { return []; },\r\n        },\r\n        textures : {\r\n            type: Object,\r\n            default: function () { return []; },\r\n        },\r\n        selected: {\r\n            type: String,\r\n            default: ''\r\n        }\r\n    },\r\n\tdata: function () {\r\n    \r\n       \r\n       return  {\r\n                first_time: true,\r\n                particle_params: {},\r\n                my_selected : false,\r\n                texture_panel_is_visible: false,\r\n            };\r\n    },\r\n    methods:\r\n    {\r\n        add_to_select: function (id)\r\n        {\r\n            //console.log(\"select new \", id, this.particles);\r\n            this.particles.push(id);\r\n            this.my_selected = id;\r\n        },\r\n        create_particles: function ()\r\n        {\r\n            event_hub.$emit(\"create_particles\");\r\n        },\r\n\t\tremove_particles: function (event) \r\n\t\t{\r\n           event_hub.$emit(\"remove_particles\", this.my_selected);        \r\n\t\t\tfor(var i = 0; i < this.particles.length; i++) {\r\n\t\t\t\tif (this.particles[i] == this.my_selected) {\r\n\t\t\t\t\tthis.particles.splice(i, 1);\r\n                    //selecte next available particles or empty\r\n\t\t\t\t\tif (this.particles.length > 0) {\r\n                        if (i+ 1 < this.particles.length) {\r\n                            this.my_selected = this.particles[i+1];\r\n                        } else  {\r\n                            this.my_selected = this.particles[0];\r\n                        }\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.my_selected = '';\r\n\t\t\t\t\t}\r\n                    \r\n                    break;\r\n\t\t\t\t}\r\n           }\r\n\t\t},\r\n        \r\n        change_colors: function (event)\r\n        {\r\n            event_hub.$emit(\"change_particles_color\", this.my_selected, event);\r\n        },\r\n        \r\n        show_texture_panel: function (event)\r\n        {\r\n            this.texture_panel_is_visible = !this.texture_panel_is_visible;\r\n            //console.log(\"this \", this.texture_panel_is_visible);\r\n        },\r\n        \r\n\t\tselect_particles: function (event)\r\n\t\t{\r\n            this.particle_params = event_hub.get_particle_params(this.my_selected);                  \r\n\t\t},\r\n\t\tplay: function (event)\r\n\t\t{\r\n            event_hub.$emit(\"replay\", this.my_selected, this.particle_params);\r\n\t\t},\r\n        \r\n    },\r\n    created: function ()\r\n    {\r\n    \r\n        var self = this;\r\n        event_hub.$on(\"adding_particles\", function (id)\r\n        {\r\n            self.add_to_select(id);\r\n        });\r\n    \r\n        if (!!this.selected) {\r\n            this.my_selected = this.selected;\r\n        } else {\r\n            if (this.particles.length > 0) {\r\n                this.my_selected = this.particles[0];\r\n            }\r\n        }\r\n        if (this.my_selected) {\r\n            this.particle_params = event_hub.get_particle_params(this.my_selected);        \r\n        }\r\n    },\r\n\r\n    watch: {\r\n        particles: function (arr) {\r\n            //console.log(\"watch particles\", arr);\r\n            if (this.particles.length > 0) {\r\n                if (this.first_time) {\r\n                    this.my_selected = this.particles[0];\r\n                    this.first_time = false;                            \r\n                }\r\n            }\r\n        },\r\n        my_selected: function (new_selected) \r\n        {\r\n            //console.log(\"watch new selected\", new_selected);\r\n            this.particle_params = event_hub.get_particle_params(this.my_selected);\r\n        }\r\n    },\r\n        \r\n    template: \r\n    '<div>\\\r\n\t<button type=\"button\" id=\"btn-add\" v-on:click=\"create_particles\">New</button>\\\r\n\t<br>\\\r\n\t<select v-model=\"my_selected\" id=\"object-list\" ref=\"particles_list\">\\\r\n\t\t<option disabled value=\"\">Please select one</option>\\\r\n\t  <option v-for=\"option in particles\" v-bind:value=\"option\">\\\r\n\t\t{{ option }}\\\r\n\t  </option>\\\r\n\t</select>\\\r\n\t<br>\\\r\n    <span>Selected: {{ my_selected }}</span><br>\\\r\n        <button type=\"button\" id=\"btn-play\" v-on:click=\"play\">Refresh</button>\\\r\n        <button type=\"button\" id=\"btn-remove\" v-on:click=\"remove_particles\">Remove</button>\\\r\n    <p>  <span class=\"info-panel\">Particles properties</span></p>\\\r\n    <div class=\"particles-properties\">\\\r\n        <div v-if=\"my_selected\" >\\\r\n            <ParticlesProps  :params=\"particle_params\" />\\\r\n            <a href=\"javascript:void(0)\" @click=\"show_texture_panel\">Show texture panel</a>\\\r\n            <div class=\"dummy\" v-if=\"texture_panel_is_visible\">\\\r\n            <texture-panel :textures=\"textures\" :object_id=\"my_selected\" :selected=\"particle_params.texture\"/>\\\r\n            </div>\\\r\n        </div>\\\r\n    </div>\\\r\n    </div>',\r\n   \r\n   \r\n    components: {\r\n        'ParticlesProps': Particles_Props,\r\n        'texture-panel': Texture_Panel,\r\n    },\r\n};\r\n\r\n\r\n//Vue.component(\"particles-panel\", Particles_Panel);\r\n\r\nexport {Particles_Panel};\n\n\n// WEBPACK FOOTER //\n// ./src/gui/particles_panel.js","import {Color_Picker} from './color_picker.js';\r\n\r\nvar Blending_Selector = {\r\n    props: {\r\n        \"blending\": {\r\n            type : String,\r\n            required: true,\r\n            default: \"no\"\r\n         },\r\n    },\r\n    template:\r\n        '<select v-model=\"blending\" id=\"blending\" v-on:change=\"select\">\\\r\n            <option value=\"no\">no</option>\\\r\n            <option value=\"additive\">additive</option>\\\r\n            <option value=\"one_alpha\">one, minus src alpha</option>\\\r\n            <option value=\"alpha_one\">minus src alpha, one</option>\\\r\n            <option value=\"alpha\">alpha</option>\\\r\n        </select>',\r\n    methods: {\r\n        select: function (event) {\r\n            this.$emit(\"change\", this.blending);\r\n        }\r\n    },\r\n};\r\n\r\nvar Behavior = {\r\n    props: [\"affect_method\", \"emit_method\"],\r\n    \r\n    data: function () {\r\n        return {\r\n            behavior: false\r\n        }\r\n    },\r\n\r\n    template: '<div>\\\r\n    <button type=\"button\" @click=\"show_behavior\">Show Behaviour</button>\\\r\n    <div class=\"behavior\" v-if=\"behavior\">\\\r\n    <p>affect method<br>\\\r\n    <textarea v-model=\"affect_method\"></textarea>\\\r\n    <p>emit method<br>\\\r\n    <textarea v-model=\"emit_method\"></textarea>\\\r\n    </div>',\r\n    methods: {\r\n        show_behavior: function(f) {\r\n            var behavior = !this.behavior;\r\n            this.behavior = behavior;\r\n        }\r\n    },\r\n\r\n};\r\n\r\nvar Particle_Params = \r\n{\r\n    props: {\r\n        \"params\": {\r\n            type: Object,\r\n            default: function () {\r\n                return {};\r\n            }\r\n        }\r\n    },\r\n\r\n    template: '<div @keyup.13=\"fire\">\\\r\n        <div class=\"prop-column\">\\\r\n            Life Length: <br/>\\\r\n            <input type=\"text\" id=\"life_length\" v-model.number=\"params.life_length\" type=\"number\" step=\"0.1\" />\\\r\n        </div>\\\r\n        <div class=\"prop-column\">\\\r\n            Emit per second <br/>\\\r\n            <input type=\"text\" id=\"emit_per_second\" v-model.number=\"params.emit_per_second\" type=\"number\" />\\\r\n        </div>\\\r\n        <div class=\"prop-column\">\\\r\n            Number of particles<br/>\\\r\n            <input type=\"text\" id=\"count\" v-model.number=\"params.count\" type=\"number\" />\\\r\n        </div>\\\r\n        <div class=\"prop-column\">\\\r\n            Point Size<br/>\\\r\n            <input type=\"text\" id=\"size\" v-model.number=\"params.size\" type=\"number\" step=\"0.1\" />\\\r\n        </div>\\\r\n</div>',\r\n    methods: {\r\n        fire: function (event) {\r\n            this.$parent.fire(event);\r\n        }\r\n    }\r\n};\r\n   \r\nvar Particles_Props = \r\n{\r\n    props: {\r\n        \"params\": {\r\n            type: Object,\r\n            default: function () {\r\n                return {};\r\n            }\r\n        }\r\n    },\r\n    template: '<div>  <particle-params :params=params />\\\r\n        <color-picker :value=\"params.color\" @input=\"update_color\"></color-picker>\\\r\n        <p>Blending mode</p>\\\r\n            <blending-mode :blending=params.blending @change=\"blending_change\"> </blending-mode>\\\r\n        <p>Precomputed alpha <input type=\"checkbox\" v-model=\"params.precomputed_alpha\" @change=\"fire\" id=\"pre_alpha\"></p>\\\r\n        <behavior :affect_method=params.affect_method :emit_method=params.emit_method />\\\r\n    <div>',\r\n    \r\n    data: function () {\r\n        return {\r\n            behavior: false\r\n        }\r\n    },\r\n    watch: {\r\n        params: function ()\r\n        {\r\n            //console.log(\"change \", this.params.id);\r\n        }\r\n    },\r\n    methods: {\r\n        blending_change: function (event) {\r\n            this.params.blending = event;\r\n            this.emit_param_change(\"blending\", event);\r\n        },\r\n        emit_param_change: function (key, value)\r\n        {\r\n            var params ={};\r\n            params[key] = value;\r\n            event_hub.$emit(\"change_params\", this.params.id, params);\r\n        },\r\n        fire: function (event)\r\n        {\r\n            var value = (event.target.type === 'checkbox') ? event.target.checked : event.target.value;\r\n            this.emit_param_change(event.target.id, value);\r\n        },\r\n        \r\n        update_color: function (event)\r\n        {\r\n            event_hub.$emit('change_color', this.params.id, event);\r\n        },\r\n    \r\n    },\r\n    components: {\r\n        'color-picker': Color_Picker,\r\n        'blending-mode': Blending_Selector,\r\n        'behavior': Behavior,\r\n        'particle-params': Particle_Params,\r\n    },\r\n};\r\n\r\n//Vue.component(\"ParticlesProps\", Particles_Props);\r\n\r\n\r\nexport {Particles_Props};\n\n\n// WEBPACK FOOTER //\n// ./src/gui/particles_props.js","\r\nvar Texture_Panel = \r\n{\r\n    template: \r\n        '<div class=\"texture-panel\">\\\r\n            <div class=\"high-tools-panel\">\\\r\n            <select id=\"texture_select\" v-model=\"selected\" v-on:change=\"choose_texture\">\\\r\n            <option v-for=\"option in textures\" v-bind:value=\"option\">\\\r\n                {{ option }}\\\r\n            </option>\\\r\n            </select>\\\r\n            <button type=\"button\" v-on:click=\"apply\">apply</button>\\\r\n            </div>\\\r\n            <div class=\"texture-canvas\">\\\r\n            <canvas id=\"texture-canvas-obj\" class=\"texture-canvas\" ref=\"canvas\">\\\r\n            </canvas>\\\r\n            </div>\\\r\n            <div class=\"texture-info\">\\\r\n                Texture Format  {{format}} <br />\\\r\n                Texture Width {{texture_width}} Height {{texture_height}}\\\r\n            </div>\\\r\n            <div class=\"clear\" />\\\r\n        </div>',\r\n\r\n        //texture dictionaries, selected texture, object id, which selected texture\r\n    props: [\"textures\", \"selected\", \"object_id\"],\r\n    \r\n    data: function () {\r\n        return {\r\n            selected_texture: '',\r\n            texture_width : 0,\r\n            texture_height : 0,\r\n            format : '',\r\n            panel_visible: false,\r\n            selected: '',\r\n        }\r\n    },\r\n    \r\n    methods: {\r\n        show_panel: function (event)\r\n        {\r\n            this.panel_visible = !this.panel_visible;\r\n        },\r\n        choose_texture: function(event)\r\n        {\r\n            this.selected = event.target.value;\r\n            this.selected_texture = this.selected;\r\n            this.draw_texture(this.selected_texture);\r\n        },\r\n        apply: function ()\r\n        {\r\n            //console.log(\"apply of \", this.object_id, this.selected_texture);\r\n            event_hub.$emit(\"select_texture\", this.object_id, this.selected_texture);\r\n        },\r\n        draw_texture: function (name)\r\n        {\r\n            if (!name) return;\r\n            var texture = event_hub.get_texture(name);\r\n            if (!texture) {\r\n                console.error(\"Oh, Fuck! Texture \" + name + \" not found!\");\r\n                return;\r\n            }\r\n            this.format = texture_format_to_string(texture.format);\r\n            var image = texture.image;\r\n            this.texture_width = image.naturalWidth || image.width;\r\n            this.texture_height = image.naturalHeight || image.height;\r\n            \r\n            var canvas = this.$refs[\"canvas\"];\r\n            my_draw_image(canvas, image, 0, 0);\r\n        },\r\n        \r\n        get_texture_from_particles: function (id)\r\n        {\r\n            if (!id) {\r\n                return;\r\n            }\r\n            this.selected_texture = event_hub.get_texture_from_particles(id);\r\n            this.draw_texture(this.selected_texture);\r\n        }\r\n    },\r\n\r\n    mounted: function () {\r\n      this.get_texture_from_particles(this.object_id);\r\n      //console.log(\"mount of texture panel\", this.object_id, this.selected_texture, this.selected);\r\n      //print(\"<h3>Hi! I mounted and my texture is \" + this.selected_texture + \",\" + this.selected + \"</h3>\");\r\n    },\r\n\r\n    \r\n    watch: {\r\n        object_id: function (value) { \r\n           this.get_texture_from_particles(value);\r\n         },\r\n    },\r\n   \r\n    \r\n};\r\n\r\n\r\n\r\n\r\nexport {Texture_Panel};\n\n\n// WEBPACK FOOTER //\n// ./src/gui/texture_panel.js","import {My_Lib} from '../base/my_lib.js';\r\n\r\nfunction Color_Domain(r,g,b)\r\n{\r\n    this.color = new THREE.Color(r,g,b);\r\n    this.uuid = _.generateUUID();\r\n    this.name = '';\r\n    this.type = \"Color_Domain\";\r\n}\r\n\r\n_.copy_object(Color_Domain.prototype, {\r\n    toJSON: function (child)\r\n    {\r\n        var data = {};\r\n        data.uuid = this.uuid;\r\n        if (this.name !== '') {\r\n            data.name = this.name;\r\n        }\r\n        data.type = this.type;\r\n        data.color = {r: this.color.r, g: this.color.g, b: this.color.b};\r\n        return ;\r\n    },\r\n    parse: function (json)\r\n    {\r\n        this.uuid = json.uuid;\r\n        if (json.name !== undefined) {\r\n            this.name = json.name;\r\n        }\r\n        if (json.color !== undefined) {\r\n            this.color.set(json.color.r, json.color.g, json.color.b);\r\n        }\r\n    },\r\n    emit: function (color)\r\n    {\r\n        color.r = this.color.r;\r\n        color.g = this.color.g;\r\n        color.b = this.color.b;\r\n    },\r\n    fill: function (color, offset) \r\n    {\r\n        color[offset+0] = this.color.r;\r\n        color[offset+1] = this.color.g;\r\n        color[offset+2] = this.color.b;\r\n    }\r\n});\r\n\r\nMy_Lib.Register_Class('Color_Domain', Color_Domain);\r\n\r\nfunction Table_Color(table)\r\n{\r\n    if (table !== undefined) {\r\n        this.copy_table(table);        \r\n    } else {\r\n        this.default_table();\r\n    }\r\n}\r\n\r\nTable_Color.prototype = Object.create(Color_Domain);\r\n\r\n_.copy_object(Table_Color.prototype, {\r\n    constructor: Table_Color,\r\n    copy_table: function (table)\r\n    {\r\n        this.table = new Array(table.length);\r\n        for(var i = 0; i < table.length; i++) {\r\n            this.table = new THREE.Color(table[i]);\r\n        }\r\n    },\r\n    emit: function (color)\r\n    {\r\n        var index = Math.ceil(Math.random() * this.table.length) % this.table.length;\r\n        var src = this.table[index];\r\n        color.r = src.r;\r\n        color.g = src.g;\r\n        color.b = src.b;\r\n    },\r\n    fill: function (color, offset) \r\n    {\r\n        var index = Math.ceil(Math.random() * this.table.length) % this.table.length;\r\n        var src = this.table[index];\r\n        color[offset] = src.r;\r\n        color[offset+1] = src.g;\r\n        color[offset+2] = src.b;\r\n    },\r\n    default_table: function ()\r\n    {\r\n        this.table = new Array(8);\r\n        this.table[0] = new THREE.Color(1, 0, 0);\r\n        this.table[1] = new THREE.Color(0, 1, 0);\r\n        this.table[2] = new THREE.Color(0, 0, 1);\r\n        this.table[3] = new THREE.Color(1, 0, 1);\r\n        this.table[4] = new THREE.Color(1, 1, 0);\r\n        this.table[5] = new THREE.Color(1, 0.4, 0.4);\r\n        this.table[6] = new THREE.Color(0.5, 0.7, 0.98);\r\n        this.table[7] = new THREE.Color(0.9, 0.4, 0.4);\r\n    },\r\n    get: function ()\r\n    {\r\n        var r = {r: 0, g: 0, b: 0};\r\n        this.emit(r);\r\n        return r;\r\n    }\r\n});\r\n\r\nMy_Lib.Register_Class(\"Table_Color\", Table_Color);\r\n\r\nexport {Color_Domain, Table_Color};\n\n\n// WEBPACK FOOTER //\n// ./src/particles/color_domain.js","var Particle_Shaders = {};\r\n\r\n(function () \r\n{\r\n\r\n//particle attributes:\r\n//position\r\n//color\r\n//left, size\r\nvar vertex_shader = [\r\n//'attribute vec4 position;',\r\n'attribute vec4 color;',\r\n'attribute float params;',\r\n'varying vec4 vcolor;',\r\n'uniform float lifetime;',\r\n'uniform float point_size;',\r\n'uniform vec2 screen_size;',\r\n'#ifndef DYNAMIC_COLORS',\r\n    'uniform vec3 particle_color;',\r\n'#endif',\r\n'void main () {',\r\n\t'gl_Position = projectionMatrix * viewMatrix * vec4( position, 1.0 );',\r\n'#ifdef DYNAMIC_COLORS',\r\n\t'vcolor.rgb = color.rgb;',\r\n'#else',\r\n    'vcolor.rgb = particle_color.rgb;',\r\n'#endif',\r\n'#ifdef NO_FADE_COLOR',\r\n\t'vcolor.a = 1.0;',\r\n'#else',\r\n\t//params contains life length which decreased by time\r\n\t'float tmp = params / lifetime;',\r\n\t'tmp = min(tmp, 1.0);',\t\r\n\t'vcolor.a = tmp;',\r\n'#endif',\r\n\t'float t =  screen_size.y* projectionMatrix[1][1] / gl_Position.w;',\r\n\t't = t * point_size;',\r\n\t'if (params > 0.0) {',\r\n\t\t'gl_PointSize = t;',\r\n\t'}',\r\n\t'else {',\r\n\t\t//'vcolor.a = 0.0;',\r\n\t\t'gl_PointSize = 0.0;',\r\n        'gl_Position.z = -1000.0;',\r\n\t'}',\r\n'}'\r\n];\r\n\r\nvar fragment_shader = [\r\n\t'varying vec4 vcolor;',\r\n\t'#ifdef PARTICLE_TEXTURE',\r\n\t\t'uniform sampler2D sprite;',\r\n\t'#endif',\r\n\t'void main() {',\r\n\t'#ifdef PARTICLE_TEXTURE',\r\n\t\t'vec4 tex = texture2D( sprite, gl_PointCoord );',\r\n\t\t'vec3 fragment_color = tex.rgb;',\r\n\t\t'fragment_color.rgb *= vcolor.rgb;',\r\n\t\t'float alpha = tex.a;',\t\r\n\t'#else',\r\n\t\t'vec3 fragment_color = vcolor.rgb;',\r\n\t\t'float alpha = 1.0;',\r\n\t'#endif',\r\n\t'#ifdef PRE_ALPHA',\r\n\t\t'fragment_color.rgb *= alpha;',\r\n\t'#endif',\r\n\t'#ifndef NO_FADE_COLOR',\r\n\t\t'float fragment_alpha = alpha * vcolor.a;',\r\n\t'#else',\r\n\t\t'float fragment_alpha = alpha;',\r\n\t'#endif',\r\n\t\t'gl_FragColor = vec4(fragment_color.rgb, fragment_alpha);',\r\n\t'}',\r\n];\r\n\r\nParticle_Shaders.vertex = vertex_shader.join( '\\n' );\r\nParticle_Shaders.fragment = fragment_shader.join( '\\n' );\r\n})();\r\n\r\nexport {Particle_Shaders};\n\n\n// WEBPACK FOOTER //\n// ./src/particles/particle_shaders.js","import {My_Lib} from '../base/my_lib.js';\r\nimport {Particle_Emitter} from './particle_emitter.js';\r\nimport {Particle_Affector} from './particle_affector.js';\r\nimport {Particles_Points} from './particles_points.js';\r\nimport {Particle_Shaders} from './particle_shaders.js';\r\nimport {Color_Domain} from './color_domain.js';\r\n\r\n\r\nfunction Particle_System(data)\r\n{\r\n    this.uuid = _.generateUUID();    \r\n    \r\n    this.params = this.config_params(data);\r\n\r\n  \r\n\tthis.emitter = this.params.emitter;\r\n\tthis.affector = this.params.affector;    \r\n    this.particle_lifetime = this.params.particle_lifetime;\r\n    this.texture = this.params.texture;\r\n\t\r\n\tthis.dynamic_color = false;\r\n\r\n\tvar count = this.params.count;\r\n\t\r\n\tthis.material = this.create_particle_material();\r\n\tthis.node = new Particles_Points(this.create_particle_geometry(count), this.material);\r\n    this.node.name = this.name;\r\n    this.node.boundingSphere.radius = this.params.bounding_radius;\r\n    this.node.non_collideble = this.params.non_collideble;\r\n    \r\n}\r\n\r\n\r\nParticle_System.prototype.config_params = function (data)\r\n{\r\n    var params = \r\n    {\r\n    };\r\n    //default\r\n    params.particle_lifetime = 3.0;\r\n    params.no_fade_color = false;\r\n    params.pre_alpha = true;\r\n    params.depth_test = true;\r\n    params.depth_write = false;\r\n    params.color  = {\"r\":1, \"g\":1, \"b\":1};\r\n\tparams.blending = \"one_alpha\";\r\n    params.size = 1;\r\n    params.count = 100;\r\n    params.name = '';\r\n    params.bounding_radius = 2.0;\r\n    params.discrete_emission = false;\r\n    params.apply_world_matrix_on_emit = true;\r\n    params.non_collideble = false;\r\n    \r\n    for(var key in data) {\r\n        if (Object.prototype.hasOwnProperty.call(data, key)){\r\n            if (data[key] !== undefined) {\r\n                params[key] = data[key];\r\n            }\r\n        }\r\n    }\r\n    \r\n\tparams.emitter = data.emitter || new Particle_Emitter(1);\r\n\tparams.affector = data.affector || new Particle_Affector();\r\n    \r\n    return params;\r\n}\r\n\r\nParticle_System.prototype.set_name = function (name)\r\n{\r\n    this.name = name;\r\n    this.node.name = name;\r\n}\r\n\r\nParticle_System.prototype.suicide = function ()\r\n{\r\n\tthis.node.parent.remove(this.node);\r\n    main_event_hub.emit(\"kill_me\", this);\r\n}\r\n\r\n\r\nParticle_System.prototype.create_particle_data = function (count)\r\n{\r\n    var particle_data = new Array(count);\r\n    var p;\r\n    //var matrix = this.node.worldMatrix();\r\n    for(var i =0;i < count; i++) {\r\n\t\tp = {};\r\n\t\tp.position = new THREE.Vector3(0,0,0);\r\n\t\tp.velocity = new THREE.Vector3(0,0,0);\r\n        \r\n        //p.position.copy(this.node.position);\r\n        //p.position.applyMatrix4(matrix);\r\n        //p.velocity.applyMatrix4_rotation(matrix);\r\n        \r\n\t\tp.lifetime = 0;        \r\n\t\tparticle_data[i] = p;\r\n    }\r\n    this.particle_data = particle_data;\r\n}\r\n\r\nParticle_System.prototype.create_particle_geometry = function(count)\r\n{\r\n    this.create_particle_data(count);\r\n    \r\n\tvar vertices = new Float32Array(count * 3); // position\r\n\tvar colors = new Float32Array(count * 3);\r\n\tvar params = new Float32Array(count);\r\n\t\r\n    var particle;\r\n    for (var i = 0; i < count; i++) {\r\n        particle = this.particle_data[i];\r\n\t\t//create particle\r\n\t\tvertices[i*3] = particle.position.x;\r\n\t\tvertices[i*3+1] = particle.position.y;\r\n\t\tvertices[i*3+2] = particle.position.z;\r\n\r\n\t\tparams[i] = 0.0;\r\n        \r\n        if (this.params.color_domain) {\r\n            this.params.color_domain.fill(colors, i*3);\r\n        } else {\r\n            colors[i*3] = this.params.color.r;\r\n            colors[i*3+1] = this.params.color.g;\r\n            colors[i*3+2] = this.params.color.b;\r\n       }\r\n\t}\r\n\r\n\tthis.geometry = {};\r\n\tthis.geometry.vertices = new THREE.BufferAttribute(vertices, 3).setDynamic(true);\r\n\tthis.geometry.colors = new THREE.BufferAttribute(colors, 3)\r\n\tif (this.dynamic_color) {\r\n\t\tthis.geometry.colors.setDynamic(true);\r\n\t}\r\n\tthis.geometry.params = new THREE.BufferAttribute(params, 1).setDynamic(true);\r\n\tvar geom = new THREE.BufferGeometry(); \t\r\n\tthis.geometry.buffer = geom;\t\r\n\tgeom.addAttribute('position', this.geometry.vertices);\r\n\tgeom.addAttribute('color', this.geometry.colors);\r\n\tgeom.addAttribute('params', this.geometry.params);\t\r\n\r\n    return geom;\r\n}\r\n\r\n\r\nParticle_System.prototype.discrete_emit = function (count)\r\n{\r\n    this.emit_particles(0, count);\r\n\tthis.geometry.vertices.needsUpdate = true;\r\n\tthis.geometry.params.needsUpdate = true;\r\n\tthis.geometry.colors.needsUpdate = true;\r\n}\r\n\r\n\r\nParticle_System.prototype.emit_particles = function (dt, need_emit)\r\n{\r\n\t//emit particles\r\n\tvar p;\r\n\tvar verts = this.geometry.vertices.array;\r\n\tvar params = this.geometry.params.array;\r\n\t\r\n    var old_need_emit = need_emit;\r\n    this.node.updateMatrixWorld(true);\r\n    var matrix = this.node.matrixWorld;\r\n\tfor(var i =0; i < this.particle_data.length && need_emit > 0; i++) {\r\n\t\tif (!(params[i] > 0)) {\r\n        \r\n\t\t\tp = this.particle_data[i];\r\n\t\t\tthis.emitter.emit(p, null, matrix);\r\n\t\t\tp.lifetime = this.particle_lifetime;\r\n            \r\n\t\t\tverts[i*3] = p.position.x;\r\n\t\t\tverts[i*3+1] = p.position.y;\r\n\t\t\tverts[i*3+2] = p.position.z;\r\n\t\t\tparams[i] = p.lifetime;\r\n\t\t\tneed_emit--;\r\n\t\t\t//colors[i*3] = this.params.color.r\r\n\t\t\t//colors[i*3+1] = this.params.color.g;\r\n\t\t\t//colors[i*3+2] = this.params.color.b;\r\n\t\t}\r\n\t}\r\n    //console.log(\"created new particles \", old_need_emit - need_emit);\r\n}\r\n\r\nParticle_System.prototype.update_particle_geometry = function (dt)\r\n{\r\n\tvar verts = this.geometry.vertices.array;\r\n\tvar params = this.geometry.params.array;\r\n\tvar p;\r\n\tvar vert = new THREE.Vector3(0,0,0);\r\n\tvar dummy_color = {\"r\":1, \"b\":1, \"g\":1};\r\n\tfor(var i = 0; i < this.particle_data.length; i++) {\r\n\t\r\n\t\tif (params[i] > 0) {\r\n\t\t\tp = this.particle_data[i];\r\n\t\t\t\r\n\t\t\t//integrate\r\n\t\t\tp.position.x += p.velocity.x * dt;\r\n\t\t\tp.position.y += p.velocity.y * dt;\r\n\t\t\tp.position.z += p.velocity.z * dt;\r\n\t\t\tp.lifetime -= dt;\r\n\t\t\t\r\n\t\t\tif (p.lifetime <= 0 || !this.affector.affect(dt, p, vert, dummy_color)) {\r\n\t\t\t\tp.lifetime = 0;\r\n\t\t\t}\r\n\t\t\tparams[i] = p.lifetime;\t\t\t\r\n\t\t\tverts[i*3] = p.position.x;\r\n\t\t\tverts[i*3+1] = p.position.y;\r\n\t\t\tverts[i*3+2] = p.position.z;\r\n\t\t}\r\n\t}\r\n\r\n    if (!this.params.discrete_emission) {\r\n        var need_emit = this.emitter.calc_emitted_particles(dt);\r\n        this.emit_particles(dt, need_emit);\r\n    }\r\n\t\r\n\tthis.geometry.vertices.needsUpdate = true;\r\n\tthis.geometry.params.needsUpdate = true;\r\n\tthis.geometry.colors.needsUpdate = true;\r\n}\r\n\r\n\r\n\r\n\r\nParticle_System.prototype.update = function (dt)\r\n{\r\n\tthis.update_particle_geometry(dt);\r\n}\r\n\r\n\r\nParticle_System.prototype.generate_material_name = function ()\r\n{\r\n\tvar my_name = \"MY_PARTICLE_MATERIAL\";\r\n\tif (!!this.texture) {\r\n\t\tmy_name +=  \"_WITH_TEXTURE\";\r\n\t}\r\n\tif (this.params.no_fade_color) {\r\n\t\tmy_name += \"_NO_FADE_COLOR\";\r\n\t}\r\n\treturn my_name;\r\n}\r\n\r\nParticle_System.prototype.blending_mode = \r\n{\r\n\t\"additive\": {\r\n\t\t\"blendSrc\": THREE.OneFactor,\r\n\t\t\"blendDst\": THREE.OneFactor\r\n\t},\r\n\t\"alpha\": {\r\n\t\t\"blendSrc\": THREE.SrcAlphaFactor,\r\n\t\t\"blendDst\": THREE.OneMinusSrcAlphaFactor\r\n\t},\r\n\t\"one_alpha\": {\r\n\t\t\"blendSrc\": THREE.OneFactor,\r\n\t\t\"blendDst\": THREE.OneMinusSrcAlphaFactor\r\n\t},\r\n\t\"alpha_one\": {\r\n\t\t\"blendSrc\": THREE.SrcAlphaFactor,\r\n\t\t\"blendDst\": THREE.OneFactor\r\n\t}\r\n};\r\n\r\nParticle_System.prototype.convert_blending_mode = function (blending)\r\n{\r\n    var three_blending;\r\n\tvar factors = this.blending_mode[\"one_alpha\"];\r\n    if (blending === 'no') {\r\n        three_blending = THREE.NoBlending;\r\n    } else {\r\n        three_blending = THREE.CustomBlending;    \r\n        if (this.blending_mode[blending]) {\r\n            factors = this.blending_mode[blending];\r\n        }\r\n    }\r\n    return {\"blending\": three_blending, \"factors\":factors};\r\n}\r\n\r\nParticle_System.prototype.set_texture = function (texture)\r\n{\r\n\tif (typeof texture === 'string') {\r\n        if (this.params.texture === texture) {\r\n            return;\r\n        }\r\n        this.params.texture = texture;\r\n\t\tthis.texture = My_Lib.Texture_Manager.get(texture);\r\n\t} else {\r\n        console.error(\"Oh Shit! texture in set_texture is not string! it's object or undefined!\", texture);\r\n    }\r\n\r\n    if (this.material.uniforms.sprite) {\r\n        this.material.uniforms.sprite.value = this.texture;\r\n    } else {\r\n        //this.material.uniforms.sprite = {value: texture};\r\n        this.recreate_material();\r\n        console.error(\"Oh Shit! Our shader has not texture! Need create shader with texture!\");\r\n    }\r\n}\r\n\r\n\r\nParticle_System.prototype.create_uniforms = function ()\r\n{\r\n    var uniforms = \r\n    {\r\n        \"lifetime\": {\r\n            value: this.particle_lifetime\r\n        },\r\n        \"point_size\": {\r\n            value: this.params.size\r\n        },\r\n        \"screen_size\": {\r\n            value: new THREE.Vector2(My_Lib.Viewport.width, My_Lib.Viewport.height)\r\n        }\r\n    };\r\n    if (!!this.texture) {\r\n        uniforms[\"sprite\"] = {\r\n            value: this.texture\r\n        }\r\n    };\r\n    if (!this.dynamic_color) {\r\n        uniforms[\"particle_color\"] = {value: this.params.color};\r\n    }\r\n    return uniforms;\r\n}\r\n\r\nParticle_System.prototype.calc_defines = function ()\r\n{\r\n    var defines = {};\r\n    if (this.params.pre_alpha) {\r\n        defines[\"PRE_ALPHA\"] = true;\r\n    }\r\n\tif (!!this.texture) {\r\n        defines[\"PARTICLE_TEXTURE\"] = true;\r\n    }\r\n    if (this.params.no_fade_color) {\r\n        defines[\"NO_FADE_COLOR\"] = true;\r\n    }\r\n    if (this.params.color_domain) {\r\n        defines[\"DYNAMIC_COLORS\"] = true;\r\n    }\r\n    return defines;\r\n}\r\n\r\n\r\nParticle_System.prototype.select_texture = function (texture)\r\n{\r\n\tif (typeof this.texture === 'string') {\r\n\t\tthis.texture = My_Lib.Texture_Manager.get(this.texture);\r\n        if (!this.texture) {\r\n            console.error(\"Oh, not found texture <\" + this.params.texture + \"> in create particle material! Instead get \"+this.texture);\r\n        }\r\n\t}\r\n}\r\n\r\nParticle_System.prototype.create_particle_material = function()\r\n{\r\n\t\r\n    this.select_texture(this.texture);\r\n    \r\n    var blend_obj = this.convert_blending_mode(this.params.blending);\r\n    \r\n    \r\n    var uniforms = this.create_uniforms();\r\n    var defines = this.calc_defines();\r\n    \r\n\tvar mat = new THREE.ShaderMaterial({\r\n\t\ttransparent: true,\r\n\t\tdepthWrite: this.params.depth_write,\r\n\t\tdepthTest: this.params.depth_test,\r\n        blending: blend_obj.blending,\r\n        blendSrc: blend_obj.factors.blendSrc,\r\n        blendDst: blend_obj.factors.blendDst,\r\n\t\tdefines: defines,\r\n\t\tuniforms: uniforms,\r\n\t\tvertexShader: Particle_Shaders.vertex,\r\n\t\tfragmentShader: Particle_Shaders.fragment\r\n\t});\r\n\treturn mat;\r\n}\r\n\r\nParticle_System.prototype.recreate_material = function ()\r\n{\r\n    this.node.material = this.material = this.create_particle_material();\r\n}\r\n\r\n\r\nParticle_System.prototype.set_pre_alpha = function (pre_alpha)\r\n{\r\n    if (this.params.pre_alpha !== !!pre_alpha) {\r\n        this.params.pre_alpha = pre_alpha;\r\n        this.recreate_material();\r\n    }\r\n}\r\n\r\nParticle_System.prototype.set_point_size = function (size)\r\n{\r\n    if (this.params.size != size) {\r\n        this.params.size = size;\r\n        this.node.material.uniforms[\"point_size\"].value = size;\r\n    }\r\n}\r\n\r\nParticle_System.prototype.set_blending = function (blending)\r\n{\r\n    this.params.blending = blending;\r\n    var b = this.convert_blending_mode(blending);\r\n    this.material.blending = b.blending;\r\n    this.material.blendSrc = b.factors.blendSrc;\r\n    this.material.blendDst = b.factors.blendDst;\r\n}\r\n\r\n\r\n\r\n\r\nParticle_System.prototype.toJSON = function ()\r\n{\r\n\tvar data = {};\r\n    data.uuid = this.uuid;\r\n    data.node = this.node.uuid;\r\n    if (this.name || this.node.name) {\r\n        data.name = this.name || this.node.name;\r\n    }\r\n\tdata.params = {};\r\n\tif (this.params) {\r\n\t\t_.copy_object(data.params, this.params);\r\n\t}\r\n\tdata.params.emitter = this.emitter.toJSON();\r\n\tdata.params.affector = this.affector.toJSON();\r\n\treturn data;\r\n}\r\n\r\n\r\nParticle_System.prototype.set_emitter = function (emitter)\r\n{\r\n    this.emitter = this.params.emitter = emitter;\r\n}\r\n\r\nParticle_System.prototype.set_particle_life_length = function (val)\r\n{\r\n\tif (val !== this.params.particle_lifetime) {\r\n\t\tthis.params.particle_lifetime = this.particle_lifetime = val;\r\n\t\tthis.material.uniforms['lifetime'].value = val;\r\n\t}\r\n}\r\n\r\nParticle_System.prototype.set_emission_per_second = function (val)\r\n{\r\n\tthis.emitter.emit_per_second = val;\r\n}\r\n\r\nParticle_System.prototype.set_particle_count = function (count)\r\n{\r\n\tif (count !== this.particle_data.length) {\r\n\t\tthis.params.count = count;\r\n\t\tthis.node.geometry = this.create_particle_geometry(count);\r\n\t}\r\n}\r\n\r\nParticle_System.prototype.set_color = function (color)\r\n{\r\n    this.params.color.r = color.r;\r\n    this.params.color.g = color.g;\r\n    this.params.color.b = color.b;\r\n}\r\n\r\nParticle_System.prototype.set_bounding_sphere_radius = function (radius)\r\n{\r\n    this.node.boundingSphere.radius = radius;\r\n}\r\n\r\nexport {Particle_System};\n\n\n// WEBPACK FOOTER //\n// ./src/particles/particles.js","import {My_Lib} from '../base/my_lib.js';\r\nimport {Particle_Emitter} from './particle_emitter.js';\r\nimport {Particle_Affector} from './particle_affector.js';\r\nimport {Particles_Points} from './particles_points.js';\r\nimport {Particle_System} from './particles.js';\r\n\r\n\r\n function Particle_Manager ()\r\n{\r\n\tthis.particles = {};\r\n    this.particles_array = [];\r\n}\r\n\r\n_.copy_object(Particle_Manager.prototype, \r\n    {\r\n    constructor: Particle_Manager,\r\n    add:  function (ps,name)\r\n    {\r\n        if (!this.particles[name]) {\r\n            this.particles[name] = ps;\r\n            this.particles_array.push(ps);\r\n        }\r\n    },\r\n    remove_particles:  function (name)\r\n    {\r\n        var ps = this.particles[name];\r\n        var i = this.particles_array.indexOf(ps);\r\n        if (i >= 0) {\r\n            this.particles_array.splice(i, 1);\r\n        }\r\n        if (ps) {\r\n            ps.suicide();\r\n            delete this.particles[name];\r\n        }\r\n    },\r\n    get_particle_names:  function ()\r\n    {\r\n        var names = [];\r\n        for(var key in this.particles) {\r\n            names.push(key);\r\n        }\r\n        return names;\r\n    },\r\n\r\n    update : function (dt)\r\n    {\r\n        for(var i = 0; i < this.particles_array.length; i++) {\r\n            this.particles_array[i].update(dt);\r\n        }\r\n    },\r\n    \r\n    create_by_params: function (params)\r\n    {\r\n        var ps = new Particle_System(params);\r\n        this.add(ps);\r\n        return ps;\r\n    },\r\n\r\n\r\n    toJSON : function ()\r\n    {\r\n        var arr = []\r\n        \r\n        var data;\r\n        var p;\r\n        for(var key in this.particles){\r\n            p = this.particles[key];\r\n            if (p.uuid) {\r\n                data = p.toJSON();\r\n                arr.push(data);\r\n            }\r\n        }\r\n\r\n        return arr;\r\n    },\r\n\r\n    emitter_fabric:  function (params)\r\n    {\r\n        if (params.emitter) {\r\n            var emitter = My_Lib.Get_Class(params.emitter.name);\r\n            if (emitter) {\r\n                emitter = new emitter();\r\n            } else {\r\n                emitter = new Particle_Emitter();\r\n            }\r\n            emitter.parse(params.emitter.params);\r\n            return emitter;        \r\n        } \r\n        return undefined;\r\n    },\r\n\r\n    affector_fabric:  function (params)\r\n    {\r\n        if (params.affector) {\r\n            var affector = My_Lib.Get_Class(params.affector.name);\r\n            if (affector) {\r\n                affector = new affector();\r\n            } else {\r\n                affector = new Particle_Affector();\r\n            }\r\n            affector.parse(params.affector.params);\r\n            return affector;\r\n        }\r\n        return undefined;\r\n    },\r\n\r\n    fromJSON: function (json, callback, root, name)\r\n    {\r\n        if (this.particles[name]) {\r\n            console.log(\"WARNING Particle Manager! Particle System with this name already exists\", name);\r\n        }\r\n        \r\n        try\r\n        {\r\n            var data = JSON.parse(json);\r\n        }\r\n        catch (e)\r\n        {\r\n            console.log(\"error parsing json on \", name, json);\r\n            throw e;\r\n        }\r\n        \r\n        return this.parse(data, root, name);\r\n    },\r\n\r\n\r\n    parse: function (data, root, name)\r\n    {\r\n        var emitter = this.emitter_fabric(data.params);\r\n        var affector = this.affector_fabric(data.params);\r\n        data.params.emitter = emitter;\r\n        data.params.affector = affector;\r\n        \r\n        var ps = new Particle_System(data.params);\r\n        ps.set_name(data.name);\r\n\r\n            //add to scene graph\r\n        if (data.params.parent) {\r\n            var parent = root.getObjectByName(data.params.parent);\r\n            //console.log(data.params.parent, \"parent particles\", name, root);\r\n            parent.add(ps.node);\r\n        } else {\r\n           root.add(ps.node);\r\n        }\r\n\r\n        //ugly fucking hack\r\n        //copy node properties\r\n        this.add(ps, name);    \r\n        return ps;\r\n    },\r\n\r\n    load_particles:  function (json, root)\r\n    {\r\n        var particles = json.particles;\r\n        for(var i =0; i < particles.length; i++)\r\n        {\r\n            var p = particles[i];\r\n            var ps = this.parse(p, root, p.name);\r\n            ps.node.uuid = p.node;\r\n            ps.node.name = p.name;\r\n            var obj = root.getObjectByProperty(\"uuid\", p.node);\r\n            if (obj) {\r\n                ps.node.replace_object_with_this(obj);\r\n            }\r\n        }\r\n    },\r\n\r\n    create_name:  function ()\r\n    {\r\n        var number = this.particles_array.length + 1;\r\n        var begin_name = 'Particle_System_';\r\n        var testing = true;\r\n        while (testing) {\r\n            name = begin_name + number;\r\n            if (this.particles[name] !== undefined) {\r\n                number ++;\r\n            } else {\r\n                return name;\r\n            }\r\n        }\r\n    },\r\n\r\n    create_new : function ()\r\n    {\r\n        var name = this.create_name();\r\n        \r\n        var params = {};\r\n        var ps = new Particle_System(params);\r\n        ps.set_name(name);\r\n        this.add(ps, name);\r\n        return ps;\r\n    }\r\n});\r\n\r\n\r\nif (My_Lib.particle_manager === undefined) \r\n{\r\n    My_Lib.particle_manager = new Particle_Manager();\r\n}\r\n\r\nMy_Lib.Particles_Config = {\r\n\"box_size\": 10\r\n};\r\n\r\n\r\nexport {Particle_Manager};\n\n\n// WEBPACK FOOTER //\n// ./src/particles/particles_manager.js","var Point_Generators = {};\r\n\r\n\r\nPoint_Generators.Random_Direction = function ()\r\n{\r\n}\r\n\r\nPoint_Generators.Random_Direction.prototype.get_direction = function (vector)\r\n{\r\n\tvector.x = Math.random(); \r\n\tvector.y = Math.random(); \r\n\tvector.z = Math.random();\r\n}\r\n\r\nPoint_Generators.Sphere = function (radius)\r\n{\r\n\tthis.radius = radius;\r\n}\r\n\r\nPoint_Generators.Sphere.prototype.get_inner_point = function (vector)\r\n{\r\n\tvar alpha = Math.random() * Math.PI * 2;\r\n\tvar beta = Math.random() * Math.PI;\r\n\tvector.x = Math.cos(alpha) * Math.sin(beta);\r\n\tvector.y = Math.cos(beta);\r\n\tvector.z = Math.sin(alpha) * Math.sin(beta);\r\n}\r\n\r\nPoint_Generators.Sphere.prototype.get_normal = function (vector)\r\n{\r\n\tvector.x = Math.random() * 2 - 1;\r\n\tvector.y = Math.random() * 2 - 1;\r\n\tvector.z = Math.random() * 2 - 1;\r\n\tvector.normalize();\r\n}\r\n\r\nPoint_Generators.Sphere.prototype.get_point = function (vector) \r\n{\r\n\tthis.get_normal(vector);\r\n\tvector.multiplyScalar(this.radius);\r\n}\r\n\r\n\r\nexport {Point_Generators};\n\n\n// WEBPACK FOOTER //\n// ./src/particles/point_generators.js","export * from './base/event_hub.js';\r\n\r\nexport {My_Lib} from './base/my_lib.js';\r\n\r\nexport {Base_Animation, Euler_Animation, Scale_Animation} from './base/animations.js';\r\nexport {Mouse_Intersector} from './base/mouse_intersector.js';\r\nexport {Mouse_Camera_Controller} from './base/mouse_camera_controller.js';\r\nexport {Loading_Manager} from './base/loading_manager.js';\r\nexport {Package_Manager} from './base/package_manager.js';\r\n\r\n\r\n\r\n\r\nexport {Particles_Points} from './particles/particles_points.js';\r\nexport {Particle_Emitter} from './particles/particle_emitter.js';\r\n\r\nexport {Particle_Forces} from './particles/forces.js';\r\n\r\nexport {Particle_Affector} from './particles/particle_affector.js';\r\n\r\nexport {Point_Generators} from './particles/point_generators.js';\r\n\r\nexport {Custom_Emitter} from './particles/custom_emitter.js';\r\n\r\nexport {Custom_Affector} from './particles/custom_affector.js';\r\n\r\nexport {Cone_Emitter, Star_Dust_Emitter, Sphere_Emitter, Star_Dust_Affector} from './particles/test_emitters.js';\r\n\r\nexport {Particle_Shaders} from './particles/particle_shaders.js';\r\n\r\nexport {Particle_System} from './particles/particles.js';\r\n\r\nexport {Particle_Manager} from './particles/particles_manager.js';\r\n\r\nexport {Scene_Serializer} from './base/scene_serializer.js';\r\nexport * from './mixins/threejs_mixins.js';\r\nexport * from './mixins/camera_mixin.js';\r\n\r\nexport {Application} from './app/application.js';\r\n\r\nexport {Color_Domain, Table_Color} from './particles/color_domain.js';\r\n\r\n\r\nexport {Simple_Collider} from './base/simple_collider.js';\n\n\n// WEBPACK FOOTER //\n// ./src/engine_main_webpack.js","export {create_vue_app} from './gui/vueapp.js';\r\nexport {Color_Picker} from './gui/color_picker.js';\r\nexport {Texture_Panel} from './gui/texture_panel.js';\r\nexport {Particles_Props} from './gui/particles_props.js';\r\nexport {Particles_Panel} from './gui/particles_panel.js';\n\n\n// WEBPACK FOOTER //\n// ./src/gui_main_webpack.js","/*\r\nmain class\r\nthis has abstract virtual methods\r\nstart - which create renderer and conduct start initializations\r\nupdate - updated scene objects, animations, phisics\r\nrender - control scene rendering\r\nthis methods must rewrite on derived classes\r\nneed set \r\nPROPERTIES\r\nmain_camera - camera which point of view render whole scene and user interacts\r\ndom_screen - dom element which contain canvas and display scene\r\nrenderer - three.js renderer\r\ncanvas - is created by three.js renderer, it have to append to dom_screen children, fuck it\r\ncanvas width and height defining on creating it by renderer, fuck it\r\n\r\n\r\n\r\n*/\r\n\r\nimport {My_Lib} from '../base/my_lib.js';\r\nimport {main_event_hub, Event_Hub} from '../base/event_hub.js';\r\nimport {Mouse_Intersector} from '../base/mouse_intersector.js';\r\n\r\n\r\nfunction Application (config)\r\n{\r\n\r\n    this._lifecycle_event(\"before_created\");\r\n   \r\n    this._init_timer();\r\n    this._create_loop_function();\r\n    \r\n\tthis.mouse_controllers = [];\r\n    \r\n    main_event_hub.add_event_listener(\"kill_me\", function (obj) {\r\n        this.remove_animated_object(obj);\r\n    }, this);\r\n}\r\n\r\nApplication.prototype.start = function (config)\r\n{\r\n    console.log(\"start application...\");\r\n   this._set_configuration(config);\r\n}\r\n\r\nApplication.prototype._lifecycle_event = function (name, event)\r\n{\r\n    if (this[name]) {\r\n        return this[name](event);\r\n    }\r\n    return false;\r\n}\r\n\r\n\r\nApplication.prototype._init_timer = function ()\r\n{\r\n\tthis.clock = new THREE.Clock();\t\r\n\tthis.delta_time = 0;\r\n\tthis.animated_objects = [];\r\n}\r\n\r\n\r\nvar run_function = window.requestAnimationFrame ||\r\n\tfunction(callback){\r\n\t\twindow.setTimeout(callback, 1000 / 60);\r\n\t}\r\n\t\r\n\r\n\r\nApplication.prototype._create_loop_function = function ()\r\n{\r\n    var self = this;\r\n\tthis.run = function ()\r\n\t{\r\n\t\trun_function(function () \r\n\t\t{ \r\n\t\t\tself.loop();\r\n            //main_event_hub.emit(\"new_frame\");\r\n\t\t});\r\n\t}\r\n\t\r\n    //My_Lib.create_run_function(this);\r\n    \r\n    //main_even_hub.add_event_listener(\"new_frame\", this.loop, this);    \r\n}\r\n\r\n\r\nApplication.prototype.get_default_configuration = function ()\r\n{\r\n    return {\r\n        \"dom_element\": \"screen\",\r\n        \"render_params\": {\r\n            \"premultipliedAlpha\": true,\r\n            \"alpha\": true\r\n        },\r\n        \"viewport\": {\r\n            \"width\": 800,\r\n            \"height\": 600\r\n         },\r\n         \"clear_color\": 0x0000FF,\r\n        \"main_camera\": {\r\n            \"fov\": 80,\r\n            \"near\": 0.1,\r\n            \"far\": 1000,\r\n            \"aspect_ratio\": 1.3333333333333333,\r\n            \"position\": {\r\n                \"x\": 0,\r\n                \"y\": 0,\r\n                \"z\": 0\r\n            }\r\n        }\r\n    };\r\n}\r\n\r\nApplication.prototype._create_render = function (json)\r\n{\r\n    if (this.dom_screen || this.renderer) {\r\n        alert(\"Create render alert! Something strange happenes!\");\r\n    }\r\n    if (!this.dom_screen) {\r\n        this.dom_screen = document.getElementById(json.dom_element);\r\n    }\r\n    if (!this.renderer) {\r\n        this.renderer = new THREE.WebGLRenderer(json.render_params);\r\n    }\r\n    if (!!!this.dom_screen || typeof this.dom_screen === 'undefined') {\r\n        console.error(\"Some terrorous happens! dom element for screen not found! element id is \" + json.dom_element);\r\n    }\r\n    //console.log(\"found dome element \" + json.dom_element);\r\n    this.dom_screen.appendChild(this.renderer.domElement);\r\n    this.canvas = this.renderer.domElement;\r\n    \r\n    \r\n    this.renderer.setSize(json.viewport.width, json.viewport.height);\r\n    this.set_viewport(json.viewport.width, json.viewport.height);\r\n    this.renderer.setClearColor(json.clear_color);\r\n    \r\n    this._lifecycle_event(\"render_created\");\r\n}\r\n\r\nApplication.prototype._create_main_scene = function (json)\r\n{\r\n    var event = {prevent: false};\r\n    this._lifecycle_event(\"before_create_main_scene\", event);\r\n    /*\r\n    if (event.prevent) {\r\n        return;\r\n    }\r\n    */\r\n    if (!this.main_scene) {\r\n        this.main_scene = new THREE.Scene();\r\n    }\r\n    \r\n    var camera = json.main_camera;    \r\n    if (!this.main_camera) {\r\n        this.main_camera = new THREE.PerspectiveCamera(camera.fov, camera.aspect_ratio, camera.near, camera.far);\r\n        this.main_scene.add(this.main_camera);\r\n        this.main_camera.name = \"main_camera\";\r\n    } else {\r\n        this.main_camera.fov = camera.fov;\r\n        this.main_camera.near = camera.near;\r\n        this.main_camera.far = camera.far;\r\n        this.main_camera.aspect = camera.aspect_ratio;\r\n        this.main_camera.updateProjectionMatrix();\r\n    }\r\n    \r\n    this.main_camera.position.set(camera.position.x, camera.position.y, camera.position.z);\r\n}\r\n\r\nApplication.prototype.apply_configuration = function (json)\r\n{\r\n    this.configuration = json;\r\n    this._create_render(json);\r\n    this._create_main_scene(json);\r\n    this._lifecycle_event(\"created\");\r\n}\r\n\r\nApplication.prototype.load_configuration = function (url)\r\n{\r\n    var xhr = new THREE.XHRLoader();\r\n    \r\n    var self = this;\r\n    \r\n    var config = self.get_default_configuration();\r\n    \r\n    var configuration_is_applied = false;\r\n    \r\n    function onload (data) {\r\n        console.log(\"configuration loaded from url <<\" + url + \">>\");\r\n        var obj = JSON.parse(data);\r\n        //user config append to default config and may rewrite them, \r\n        //though user naven't to rewrite ALL config to change some params\r\n        _.copy_object(config, obj);\r\n        self.apply_configuration(config);\r\n        console.log(configuration_is_applied, \"onload\");        \r\n        configuration_is_applied = true;\r\n    }\r\n    function progress() {}\r\n    function error(event) {\r\n        console.error(\"Error on loading config!\", event.target.status);\r\n        console.log(\"Setting default configuration\");\r\n        console.log(configuration_is_applied, \"error\");        \r\n        configuration_is_applied = true;        \r\n        self.apply_configuration(config);\r\n    }\r\n    xhr.load(url, onload, progress, error);\r\n}\r\n\r\n\r\nApplication.prototype._set_configuration = function (config)\r\n{\r\n    var default_config = this.get_default_configuration();\r\n    \r\n    //this is url of configuration file\r\n    if (typeof config === 'string') {\r\n        console.log(\"get configuration from url >> \" + config);\r\n        this.load_configuration(config);\r\n        \r\n        //this is object filled with data\r\n    } else if (typeof config === 'object') {\r\n        console.log(\"get configuration from user object\");\r\n        _.copy_object(default_config,config);\r\n        this.apply_configuration(default_config);\r\n    //configuration not given, use default\r\n    } else {\r\n        console.log(\"_set_configuration: set default configration\");\r\n       this.apply_configuration(default_config);\r\n    }\r\n}\r\n\r\nApplication.extend = function (methods, child_func)\r\n{\r\n\r\n    var Child;\r\n    if (typeof child_func === 'undefined') {\r\n        Child = function ()\r\n        {\r\n            Application.apply(this, arguments);\r\n        }\r\n    } else {\r\n        Child = child_func;\r\n    }\r\n\r\n    //create new object and set prototype chain\r\n\tChild.prototype = Object.create(Application.prototype);\r\n    //copy methods to new object\r\n\t_.copy_object(Child.prototype, methods);\r\n    Child.prototype.constructor = Child;\r\n   \r\n    return Child;\r\n}\r\n\r\nApplication.extend_proto = function (proto, methods)\r\n{\r\n\tvar obj = Object.create(proto);\r\n\t_.copy_object(obj, methods);\r\n\tApplication.call(obj);\r\n\treturn obj;\r\n}\r\n\r\n\r\nApplication.prototype.loop = function () \r\n{\r\n\tvar delta = this.clock.getDelta();\r\n\t//fix this - add options to control min frame rate\r\n\tif (delta > 0.1) {\r\n\t\tdelta = 0.1;\r\n\t}\r\n\tthis.delta_time = delta;\r\n    this.do_update(delta);\r\n\tthis.update(delta);\r\n\tthis.render(delta);\r\n\tthis.run();\r\n    //My_Lib.run();\r\n}\r\n\r\n\r\n\r\nApplication.prototype.add_animated_object = function (obj)\r\n{\r\n\t//fix probably duplicates\r\n\tthis.animated_objects.push(obj);\r\n}\r\n\r\nApplication.prototype.remove_animated_object = function (obj)\r\n{\r\n\tfor(var i = 0; i < this.animated_objects.length; i++) {\r\n\t\tif (this.animated_objects[i] === obj) {\r\n\t\t\tthis.animated_objects.splice(i, 1);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\n\r\nApplication.prototype.update_all = function (delta)\r\n{\r\n\tvar obj;\r\n\tfor(var i = 0, len = this.animated_objects.length; i < len; i++) {\r\n\t\tobj = this.animated_objects[i];\r\n\t\tif (obj[\"update\"]) {\r\n\t\t\tobj.update(delta);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nApplication.prototype.pre_update = function (delta)\r\n{\r\n\tthis.update_all(delta);\r\n    My_Lib.particle_manager.update(delta);\r\n    //event\r\n    if (this.before_update !== undefined) {\r\n        this.before_update(delta);\r\n    }\r\n}\r\n\r\n\r\nApplication.prototype.do_update = function (dt)\r\n{\r\n    this.pre_update(dt);\r\n    this.update(dt);\r\n}\r\n\r\nApplication.prototype.update = function (delta)\r\n{\r\n}\r\n\r\n\r\nApplication.prototype.create_mouse_move_listener = function ()\r\n{\r\n\tif (this[\"mouse_move_listener\"]) {\r\n\t\treturn;\r\n\t}\r\n\tvar self = this;\r\n\tthis.mouse_move_listener = true;\r\n\tfunction mouse_move_listener(event) {\r\n\t\tvar vector = Mouse_Intersector.mouse_coords_to_vector(self.dom_screen, event);\t\t\r\n\t\tself.find_mouse_over_intersections(vector);\r\n\t};\r\n\tdocument.addEventListener(\"mousemove\", mouse_move_listener);\r\n}\r\n\r\nApplication.prototype.find_mouse_over_intersections = function(vector)\r\n{\r\n\tvector.unproject(this.main_camera);\r\n\tvar ray = new THREE.Raycaster( this.main_camera.position, vector.sub( this.main_camera.position ).normalize() );\r\n\tvar obj;\r\n\tfor(var i =0, len = this.mouse_controllers.length; i < len; i++){\r\n\t\tobj = this.mouse_controllers[i];\r\n\t\tif (obj.over) {\r\n\t\t\t// create an array containing all objects in the scene with which the ray intersects\r\n\t\t\t//var intersects = ray.intersectObjects( [grid_text.root], true ); \r\n\t\t\t//console.log(fake_plane.root.children[0].geometry);\r\n\t\t\tvar intersects = ray.intersectObjects( [obj.root], true ); \r\n\t\t\tobj.callback(intersects);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nApplication.prototype.add_mouse_controller = function (root, over, click, callback)\r\n{\r\n\tvar tmp = new My_Lib.Mouse_Controller(root, over, click, callback)\r\n\tthis.mouse_controllers.push( tmp );\r\n\tif (over) {\r\n\t\tthis.create_mouse_move_listener();\r\n\t}\r\n\treturn tmp;\r\n}\r\n\r\n\r\n\r\nApplication.prototype.set_viewport = function (width, height)\r\n{\r\n\tMy_Lib.Viewport.width = width;\r\n\tMy_Lib.Viewport.height = height;\r\n}\r\n\r\nApplication.prototype.render = function (delta) \r\n{\r\n\tthis.renderer.setClearColor(this.configuration.clear_color);\r\n\tthis.renderer.autoClear = true;\r\n\tthis.renderer.render(this.main_scene, this.main_camera);\r\n}\r\n\r\n\r\n\r\nexport {Application};\n\n\n// WEBPACK FOOTER //\n// ./src/app/application.js","import {My_Lib} from './my_lib.js';\r\n\r\n//length - simple length of animations\r\n//-1 - infinite\r\n//0 - stop\r\n//> 0 - length of animation, \r\n//if time > length, animation stop\r\n//need rewrite this crap to safe floating point mannere\r\n//and append more controle on animation \r\n    function Base_Animation ()\r\n    {\r\n        this.time = 0;\r\n        this.time_scale = 1.0;\r\n        this.type = \"Base_Animation\";\r\n        this.uuid = _.generateUUID();\r\n        this.length = -1;\r\n        this.stopped = false;\r\n    }\r\n    \r\n    Base_Animation.prototype.update = function (dt)\r\n    {\r\n        var scaled_dt = dt * this.time_scale;\r\n        this.time += scaled_dt;\r\n        if (this.length < 0 || this.time < this.length) {\r\n            this.calc_animation(dt);\r\n        }\r\n    }\r\n    \r\n    Base_Animation.prototype.stop = function ()\r\n    {\r\n        this.stopped = true;\r\n    }\r\n    \r\n    Base_Animation.prototype.start = function ()\r\n    {\r\n        this.stopped = false;\r\n    }\r\n    \r\n    Base_Animation.prototype.reset = function ()\r\n    {\r\n        this.time = 0;\r\n    }\r\n    \r\n    Base_Animation.prototype.calc_animation = function (dt)\r\n    {\r\n        \r\n    }\r\n    \r\n    Base_Animation.prototype.apply = function(obj)\r\n    {\r\n    }\r\n    \r\n    Base_Animation.prototype.toJSON = function (data)\r\n    {\r\n        var data = {};\r\n        data.uuid = this.uuid;\r\n        data.type = this.type;\r\n        if (this.name !== '') {\r\n            data.name = this.name;\r\n        }\r\n        data.time_scale = this.time_scale === undefined ? 1.0 : this.time_scale;\r\n        data.length = this.length;\r\n        return data;\r\n    }\r\n    \r\n    Base_Animation.prototype.parse = function (param)\r\n    {\r\n        this.type = param.type;\r\n        this.uuid = param.uuid;\r\n        this.name = param.name ? param.name : '';\r\n        this.time_scale = (param.time_scale === undefined) ? 1.0 : param.time_scale;\r\n        this.length = param.length === undefined ? -1 : param.length;\r\n    }\r\n    \r\n\r\n    \r\n    \r\n        \r\nfunction Euler_Animation (x, y, z)\r\n{\r\n    Base_Animation.call(this);\r\n    this.type = \"Euler_Animation\";\r\n\tthis.xspeed = x;\r\n\tthis.yspeed = y;\r\n\tthis.zspeed = z;\r\n    this.x = 0;\r\n    this.y = 0;\r\n    this.z = 0;\r\n    this.name = '';\r\n}\r\n\r\nEuler_Animation.prototype = Object.create(Base_Animation.prototype);\r\n\r\n\r\nEuler_Animation.prototype.constructor = Euler_Animation;\r\n\r\nEuler_Animation.prototype.calc_animation = function (dt)\r\n{\r\n    //console.log(this.xspeed,this.yspeed, this.zpeed, dt, this.time_scale);\r\n    dt *= this.time_scale;\r\n\tthis.x += this.xspeed * dt;\r\n\tthis.y += this.yspeed * dt;\r\n\tthis.z += this.zspeed * dt;\r\n}\r\n    \r\nEuler_Animation.prototype.apply = function (obj)\r\n{\r\n    obj.rotation.set(this.x,this.y, this.z);\r\n}\r\n\r\nEuler_Animation.prototype.toJSON = function (json)\r\n{\r\n   var data = Base_Animation.prototype.toJSON.call(this);\r\n   data.xspeed = this.xspeed;\r\n   data.yspeed = this.yspeed;\r\n   data.zspeed = this.zspeed;\r\n   return data;\r\n}\r\n\r\nEuler_Animation.prototype.parse = function (param)\r\n{\r\n    Base_Animation.prototype.parse.call(this, param);\r\n    this.xspeed = param.xspeed;\r\n    this.yspeed = param.yspeed;\r\n    this.zspeed = param.zspeed;\r\n    this.x = this.y = this.z = 0;    \r\n}\r\n\r\n\r\nfunction Scale_Animation(x, y, z)\r\n{\r\n    Base_Animation.call(this);\r\n    //speed of scale\r\n    this.xscale = x;\r\n    this.yscale = y;\r\n    this.zscale = z;\r\n    this.x = 1.0;\r\n    this.y = 1.0;\r\n    this.z = 1.0;\r\n}\r\n\r\nScale_Animation.prototype = Object.create(Base_Animation.prototype);\r\n\r\n_.copy_object(Scale_Animation.prototype, {\r\n    constructor: Scale_Animation,\r\n    calc_animation: function (dt) \r\n    {\r\n        dt = dt * this.time_scale;\r\n        this.x += this.xscale * dt;\r\n        this.y += this.yscale * dt;\r\n        this.z += this.zscale * dt;\r\n    },\r\n    apply:function (obj) {\r\n        obj.scale.set(this.x, this.y, this.z);\r\n    },\r\n    reset: function () {\r\n        if (this.first) {\r\n        }\r\n        this.x = 1.0;\r\n        this.y = 1.0;\r\n        this.z = 1.0;\r\n        this.time = 0;\r\n    }\r\n});\r\n\r\n\r\nMy_Lib.Register_Class(\"Base_Animation\", Base_Animation);\r\nMy_Lib.Register_Class(\"Euler_Animation\", Euler_Animation);\r\nMy_Lib.Register_Class(\"Scale_Animation\", Scale_Animation);\r\n\r\n\r\nexport { Base_Animation, Euler_Animation, Scale_Animation };\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/base/animations.js","import {My_Lib} from './my_lib.js';\r\n\r\n//events: \r\n//item_loaded\r\n//onerror\r\n//onprogress\r\n//finished\r\nfunction Chain_Loader()\r\n{\r\n}\r\n\r\nChain_Loader.prototype = {\r\n\tconstructor: Chain_Loader,\r\n\tstart: function (list) \r\n\t{\r\n\t\tthis.list = list;\r\n\t\tthis.index = 0;\r\n\t\tthis.load(this.list[0]);\r\n\t\tthis.stop_by_error = false;\r\n\t},\r\n\t\r\n\tnext: function(resource)\r\n\t{\r\n\t\tif (this.item_loaded && resource) {\r\n\t\t\tthis.item_loaded(resource,this.list[this.index]);\r\n\t\t}\r\n\t\tthis.index++;\r\n\t\tif (this.index < this.list.length) {\r\n\t\t\tthis.load(this.list[this.index]);\r\n\t\t} else {\r\n\t\t\tif (this.finished) {\r\n\t\t\t\tthis.finished();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\t\r\n\tdo_error: function (error)\r\n\t{\r\n\t\tif (this.onerror) {\r\n\t\t\tthis.onerror(error);\r\n\t\t} else {\r\n\t\t\tconsole.error(\"Chain Loader Error!\", error);\r\n\t\t}\r\n\t\tif (!this.stop_by_error) {\r\n\t\t\tthis.next();\r\n\t\t}\r\n\t},\r\n\t\r\n\tdo_progress: function ()\r\n\t{\r\n\t\tif (this.onprogress) {\r\n\t\t\tthis.onprogress.apply(this, arguments);\r\n\t\t}\r\n\t},\r\n\t\t\r\n\tload: function (item)\r\n\t{\r\n\t\tvar self = this;\r\n\t\tif (this.load_func) {\r\n\t\t\tthis.load_func(item, \r\n\t\t\tfunction (item) { self.next.apply(self, arguments); },\r\n\t\t\tfunction (item) { self.do_error.apply(self, arguments); },\r\n\t\t\tfunction (item) { self.do_progress.apply(self, arguments); });\r\n\t\t}\r\n\t}\r\n};\r\n\r\n\r\nfunction test_chain_loader() \r\n{\r\n\tvar cl = new Chain_Loader();\r\n\tcl.item_loaded = function (item) {console.log(\"load item \", item);}\r\n\tcl.finished = function (item) {console.log(\"loader manager - job done\");}\r\n\tcl.load_func = function (item, next, error, progress) { \r\n\t\tif (item) {\r\n\t\t\tnext(item);\r\n\t\t} else {\r\n\t\t\terror(item);\r\n\t\t}\r\n\t}\r\n\tcl.start([\"first\", \"second\", null, \"tree\"]);\r\n}\r\n//test_chain_loader();\r\n\r\n\r\n\r\n\r\nfunction Loading_Manager ()\r\n{\r\n\tthis.resources = {};\r\n\tthis.texture_loader = new THREE.TextureLoader();\r\n}\r\n\r\nLoading_Manager.prototype = {\r\n\tconstructor: Loading_Manager,\r\n\tget: function (name)\r\n\t{\r\n\t\treturn this.resources[name];\r\n\t},\r\n\t\r\n\tget_async: function (name, callback)\r\n\t{\r\n\t\t//already loaded?\r\n\t\tvar texture = this.get(name);\r\n\t\tif (texture) {\r\n\t\t\tif (callback) {\r\n\t\t\t\tcallback(texture);\r\n\t\t\t}\r\n\t\t\treturn texture;\r\n\t\t}\r\n\r\n\t\t//if not load this async\r\n\t\tvar self = this;\r\n\t\ttexture = this.texture_loader.load(name, function (texture)\r\n\t\t{\r\n\t\t\tif (callback) {\r\n\t\t\t\tcallback(texture);\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.resources[name] = texture;\t\r\n\t\treturn texture;\r\n\t},\r\n\t\r\n\r\n\tload_list: function (resource_list, on_load, load_func, on_progress)\r\n\t{\r\n\t\tvar self = this;\r\n\t\t\r\n\t\tvar cl = new Chain_Loader();\r\n\t\tvar self = this;\r\n\t\tcl.onerror = function (error) {\r\n\t\t\tconsole.error(\"ERROR loading texture\", error, cl.list[cl.index]);\t\r\n\t\t}\r\n\t\tcl.item_loaded = function (resource, name) {\r\n\t\t\tself.resources[name] = resource;\r\n\t\t\tif (self.on_resource_loaded) {\r\n\t\t\t\tself.on_resource_loaded(resource);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcl.on_progress = function () {\r\n\t\t\tif (on_progress) {\r\n\t\t\t\ton_progress();\r\n\t\t\t}\r\n\t\t}\r\n\t\tcl.load_func = function () {\r\n\t\t\tload_func.apply(this, arguments);\r\n\t\t}\r\n\t\tcl.finished = function ()\r\n\t\t{\r\n\t\t\tif (on_load) {\r\n\t\t\t\ton_load();\r\n\t\t\t}\r\n\t\t}\r\n\t\tcl.start(resource_list);\r\n\t\t\r\n\t},\r\n\r\n\tload_list_textures: function (resource_list, on_load)\r\n\t{\r\n\t\tvar self = this;\r\n\t\tthis.load_list(resource_list, on_load, function (url, next, error, progress ) \r\n\t\t{\r\n\t\t\tvar texture = self.texture_loader.load(url, next, progress, error);\r\n\t\t});\r\n\t},\r\n\r\n\tload_list_json: function (resource_list, on_load, progress)\r\n\t{\r\n\t\tvar self = this;\r\n\t\tvar loader = new THREE.XHRLoader();\t\r\n\t\tthis.load_list(resource_list, on_load, function (url, next, error, progress) \r\n\t\t{\r\n\t\t\tvar texture = loader.load(url, next, progress, error);\r\n\t\t}, progress);\r\n\t},\r\n\t\r\n\tfree: function ()\r\n\t{\r\n\t\tthis.resources = {};\r\n\t}\r\n};\r\n\r\n\r\nMy_Lib.Texture_Manager = new Loading_Manager();\t\r\n\r\nexport { Loading_Manager };\n\n\n// WEBPACK FOOTER //\n// ./src/base/loading_manager.js","//TODO: remove this ugly crap and replace something reasonable\r\n\r\nimport {My_Lib} from './my_lib.js';\r\n\r\n//this ugly class loading texture list in json format, parse it, and loading textures\r\n//then it call event data_loaded, when give texture list in json format\r\n\r\nfunction Package_Manager()\r\n{\r\n    this.state = {};\r\n}\r\n\r\n//load json file with descriptions of package: texture list, particles list, scene objects list\r\nPackage_Manager.prototype.load = function (url, defaults)\r\n{\r\n    this.defaults = defaults;\r\n    var self = this;\r\n    this.state = {\r\n        \"type\": \"start\"\r\n    };\r\n    \r\n    var self = this;\r\n    function onload (data) {\r\n        self.state[\"type\"] = \"done\";\r\n        self.state[\"data\"] = data;\r\n        \r\n        self.parse_package_description(data);        \r\n    }    \r\n    function error(event) {\r\n        self.state[\"type\"] = \"error\";\r\n        self.state[\"error\"] = event;\r\n        console.error(\"ERror! Failed loading resources with url \"+url, event.target);        \r\n        if (self.error){\r\n            self.error(event.target);\r\n        }\r\n        self.pack = self.defaults\r\n        self.load_resources(self.defaults);\r\n\r\n    }\r\n    function progress()\r\n    {\r\n    }\r\n    var xhr = new THREE.XHRLoader();\r\n    xhr.load(url, onload, progress, error);\r\n}\r\n\r\n//parse loaded json file \r\nPackage_Manager.prototype.parse_package_description = function (data)\r\n{\r\n    console.log(\"packaged description loaded, begin parsing...\");\r\n  try {\r\n        var pack = JSON.parse(data);\r\n        this.pack = pack;\r\n        if (this.loaded) {\r\n            this.loaded(pack);\r\n        }\r\n        \r\n   } \r\n   catch(e) {\r\n        console.error(\"error parsing resources \", e);\r\n        if (this.error){\r\n            this.error(event);\r\n        }\r\n        return;        \r\n   }\r\n   this.load_resources(pack);\r\n}\r\n\r\n\r\nPackage_Manager.prototype.load_resources = function (pack)\r\n{\r\n    var self = this;\r\n    //load textures\r\n   console.log(\"Package Manager: begin loading textures...\");    \r\n    My_Lib.Texture_Manager.load_list_textures(pack.textures, function (){\r\n        //load json descriptions files\r\n                if (self.data_loaded) {\r\n                    self.data_loaded(pack);\r\n                }\r\n    })\r\n}\r\n\r\n\r\nexport { Package_Manager };\n\n\n// WEBPACK FOOTER //\n// ./src/base/package_manager.js","import {My_Lib} from './my_lib.js';\r\nimport {Particle_Manager} from '../particles/particles_manager.js'\r\n\r\nfunction Scene_Serializer(root)\r\n{\r\n    this.animation_library = {};\r\n}\r\n\r\nScene_Serializer.prototype.toJSON = function (root)\r\n{\r\n    this.json = root.toJSON();\r\n    console.log(\"my lib particle manager\", My_Lib.particle_manager);\r\n    this.json[\"particles\"] = My_Lib.particle_manager.toJSON();\r\n    var anims = root.collect_animations(root);\r\n    if (anims.count > 0) {\r\n        this.json[\"myanimations\"] = anims;\r\n    }\r\n    \r\n    return this.json;\r\n}\r\n\r\n\r\n\r\nScene_Serializer.prototype.create_animations = function (animations) {\r\n    for(var key in animations) {\r\n        if ( this.animation_library[key] === undefined && Object.prototype.hasOwnProperty.call(animations, key)) {\r\n            var data = animations[key];\r\n            //console.log(\"create animations \", data.uuid);            \r\n            var anim =  My_Lib.Abstract_Fabric(data);\r\n            if (anim) {\r\n                this.animation_library[key] = anim;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\nScene_Serializer.prototype.bind_animations = function (animdata)\r\n{\r\n    if (!animdata) return;\r\n    \r\n    var bindings = animdata.bindings;\r\n    \r\n    //console.log(\"bind animation\");\r\n    var self = this;\r\n    function copy_animations(obj, bind)\r\n    {\r\n        for(var i = 0; i < bind.animations.length; i++){\r\n            var anim_uuid = bind.animations[i];\r\n            obj.add_animation( self.animation_library[anim_uuid] );\r\n        }\r\n    }\r\n    \r\n     for(var i =0; i < bindings.length; i++) {\r\n        var bind = bindings[i];\r\n        var uuid = bind.uuid;\r\n        var obj = this.root.getObjectByProperty(\"uuid\", uuid);\r\n        if (obj) {\r\n            //console.log(\"binding \" + uuid + \" object to animation \"+uuid);\r\n            copy_animations(obj, bind);\r\n        }\r\n    }\r\n}\r\n\r\n\r\nScene_Serializer.prototype.load_from_json = function (url)\r\n{\r\n    var self = this;\r\n    function onload(json)\r\n    {\r\n        try {\r\n            var data = JSON.parse(json);\r\n        }\r\n        catch(e) {\r\n            console.error(\"Failed to parse scene \", e);\r\n            throw e;\r\n        }\r\n        if (data === undefined) {\r\n            console.error(\"Something fucking happened, failed to load scene \", url);\r\n            return;\r\n        }\r\n        self.load(data);\r\n    }\r\n    function progress()\r\n    {\r\n    }\r\n    function error(e)\r\n    {\r\n        console.error(e.target);\r\n        throw e;\r\n    }\r\n    var xhr = new THREE.XHRLoader();\r\n    xhr.load(url, onload, progress, error);\r\n}\r\n\r\nScene_Serializer.prototype.load = function (json)\r\n{\r\n    this.animation_library = {};\r\n    var o = new THREE.ObjectLoader();\r\n    if (json !== undefined) {\r\n        this.json = json;\r\n    }\r\n    var root = o.parse(this.json, function () {console.log(\"onload\")});\r\n    this.root = root;    \r\n\r\n    My_Lib.particle_manager.load_particles(this.json, root);\r\n    \r\n    this.create_animations(this.json.myanimations.animations);\r\n    this.bind_animations(this.json.myanimations);\r\n    this.main_camera = root.getObjectByName(\"main_camera\");\r\n    \r\n    if (this.scene_loaded) {\r\n        this.scene_loaded(root);\r\n    }\r\n    return root;\r\n}\r\n\r\nexport { Scene_Serializer };\n\n\n// WEBPACK FOOTER //\n// ./src/base/scene_serializer.js","export * from './engine_main_webpack.js';\r\nexport * from './gui_main_webpack.js';\n\n\n// WEBPACK FOOTER //\n// ./src/editor_webpack_dev.js","import {Particles_Panel} from './particles_panel.js';\r\n\r\nfunction create_vue_app(id) {\r\n\r\n\tvar app2 = new Vue({\r\n\t\tel: id,\r\n        \r\n        components: {\r\n            'particles-panel': Particles_Panel,\r\n        },\r\n\t\tdata: {\r\n            particles: [],\r\n            textures: [],\r\n        },\r\n        template: '<div id=\"app\">\\\r\n            <particles-panel :particles=\"particles\" :textures=\"textures\"></particles-panel>\\\r\n            </div>',\r\n\t});\r\n\r\n\treturn app2;\r\n}\r\n\r\nexport {create_vue_app};\n\n\n// WEBPACK FOOTER //\n// ./src/gui/vueapp.js","import {Mouse_Camera_Controller} from '../base/mouse_camera_controller.js';\r\n\r\nfunction Mixin()\r\n{\r\n\r\n    //need for unproject object and dragging\r\n    THREE.PerspectiveCamera.prototype.get_forward_plane_by_object = function (obj)\r\n    {\r\n        var z = new THREE.Vector3();\r\n        z.setFromMatrixColumn( this.matrixWorld, 2 );\r\n        var dist = obj.position.dot(z);             \r\n        var plane= new THREE.Plane(z.negate(), dist);\r\n        return plane;\r\n    }\r\n\r\n    \r\n    THREE.PerspectiveCamera.prototype.get_ray_from_screen_coordinates = function (canvas, x,y)\r\n    {\r\n        var mc = new Mouse_Camera_Controller(canvas, this);\r\n        var ray = mc.get_ray_from_camera_in_screen_coordinates(x,y);\r\n        return ray;\r\n    }\r\n\r\n    \r\n}\r\n\r\nMixin();\r\nexport {Mixin};\n\n\n// WEBPACK FOOTER //\n// ./src/mixins/camera_mixin.js","function Mix_It()\r\n{\r\n\r\n\r\n\r\n\t//FIX\r\n\tTHREE.Vector3.prototype.applyMatrix4_rotation = function ( m ) \r\n\t{\r\n\t\t// input: THREE.Matrix4 affine matrix\r\n\r\n\t\tvar x = this.x, y = this.y, z = this.z;\r\n\t\tvar e = m.elements;\r\n\r\n\t\tthis.x = e[ 0 ] * x + e[ 4 ] * y + e[ 8 ]  * z;\r\n\t\tthis.y = e[ 1 ] * x + e[ 5 ] * y + e[ 9 ]  * z;\r\n\t\tthis.z = e[ 2 ] * x + e[ 6 ] * y + e[ 10 ] * z;\r\n\r\n\t\treturn this;\r\n \t}\r\n\r\nvar Object3D_Animation_Mixin = {\r\n    \r\n    add_animation: function (anim)\r\n    {\r\n        if (!this.animations) {\r\n            this.animations = [];\r\n        }\r\n        if (this.animations.indexOf(anim) < 0) {\r\n            this.animations.push(anim);\r\n        }\r\n    },\r\n    \r\n    remove_animation: function (anim)\r\n    {\r\n        if (this.animations) {\r\n            var i = this.animations.indexOf(anim);\r\n            if (i > -1) {\r\n                this.animations.splice(i, 1);\r\n            }\r\n        }\r\n    },\r\n    \r\n    update:  function (dt)\r\n    {\r\n        //console.log(\"object update\", dt);\r\n        if (this.animations !== undefined) {\r\n            for(var i =0; i < this.animations.length; i++) {\r\n                var anim = this.animations[i];\r\n                anim.update(dt);\r\n                //console.log(this.rotation);\r\n                anim.apply(this);\r\n                //console.log(this.rotation);\r\n            }\r\n        }\r\n    \r\n        for(var i = 0; i < this.children.length; i++) {\r\n            var obj = this.children[i];\r\n            if (obj.update) {\r\n                obj.update(dt);\r\n            }\r\n        }\r\n    },\r\n    \r\n    \r\n};\r\n_.copy_object(THREE.Object3D.prototype, Object3D_Animation_Mixin);\r\n\r\n\r\nTHREE.Object3D.prototype.old_toJson = THREE.Object3D.toJSON;\r\n\r\nvar Object3D_Serialization_Mixin = \r\n{\r\n    standard_serialization: function (meta) \r\n    {\r\n\t\t// standard Object3D serialization\r\n\t\tvar object = {};\r\n\r\n\t\tobject.uuid = this.uuid;\r\n\t\tobject.type = this.type;\r\n\t\tif ( this.name !== '' ) object.name = this.name;\r\n\t\tif ( JSON.stringify( this.userData ) !== '{}' ) object.userData = this.userData;\r\n\t\tif ( this.castShadow === true ) object.castShadow = true;\r\n\t\tif ( this.receiveShadow === true ) object.receiveShadow = true;\r\n\t\tif ( this.visible === false ) object.visible = false;\r\n\r\n\t\tobject.matrix = this.matrix.toArray();\r\n        \r\n\r\n        if (this.type !== \"particles_points\")\r\n        {\r\n            if (this.geometry !== undefined) {\r\n                object.geometry = this.geometry.uuid;\r\n            }\r\n            if ( this.material !== undefined ) {\r\n                object.material = this.material.uuid;\r\n            }\r\n            \r\n            if ( this.material !== undefined  &&  meta.materials[ this.material.uuid ] === undefined ) {\r\n                    meta.materials[ this.material.uuid ] = this.material.toJSON( meta);\r\n            }\r\n\r\n            if ( this.geometry !== undefined && meta.geometries[ this.geometry.uuid ] === undefined ) {\r\n                    meta.geometries[ this.geometry.uuid ] = this.geometry.toJSON( meta );\r\n            }\r\n        }\r\n        \r\n        if (this.animations) {\r\n            object.animations = [];\r\n            for(var i =0; i < this.animations.length; i++) {\r\n                object.animations.push ( this.animations[i].uuid );\r\n            }\r\n        }\r\n        \r\n\t\tif ( this.children.length > 0 ) {\r\n\t\t\tobject.children = [];\r\n\t\t\tfor ( var i = 0; i < this.children.length; i ++ ) \r\n            {\r\n                var child = this.children[ i ];\r\n\t\t\t\t//object.children.push( child.standard_serialization( meta ) );\r\n                object.children.push( child.toJSON( meta ) );\r\n\t\t\t}\r\n\t\t}\r\n        return object;\r\n    },\r\n    \r\n    collect_materials: function (meta) \r\n    {\r\n\t\tif ( this.material !== undefined  &&  meta.materials[ this.material.uuid ] === undefined ) {\r\n                meta.materials[ this.material.uuid ] = this.material.toJSON( meta);\r\n\t\t}\r\n        \r\n\t\tfor ( var i = 0; i < this.children.length; i ++ ) {\r\n\t\t\tthis.children[ i ].collect_materials(meta);\r\n\t\t}\r\n    },\r\n    \r\n    collect_geometry: function (meta)\r\n    {\r\n\t\tif ( this.geometry !== undefined && meta.geometries[ this.geometry.uuid ] === undefined ) {\r\n\t\t\t\tmeta.geometries[ this.geometry.uuid ] = this.geometry.toJSON( meta );\r\n\t\t}\r\n\r\n\t\tfor ( var i = 0; i < this.children.length; i ++ ) {\r\n\t\t\tthis.children[ i ].collect_geometry(meta);\r\n\t\t}\r\n    },\r\n    \r\n\ttoJSON1: function ( meta ) {\r\n    \r\n\t\t// extract data from the cache hash\r\n\t\t// remove metadata on each item\r\n\t\t// and return as array\r\n\t\tfunction extractFromCache( cache, t ) {\r\n\t\t\tvar values = [];\r\n\t\t\tfor ( var key in cache ) {\r\n\t\t\t\tvar data = cache[ key ];\r\n\t\t\t\tdelete data.metadata;\r\n\t\t\t\tvalues.push( data );\r\n\t\t\t}\r\n\t\t\treturn values;\r\n\t\t}\r\n    \r\n\r\n        this.updateMatrixWorld(true);\r\n        \r\n\t\t// meta is '' when called from JSON.stringify\r\n\t\tvar isRootObject = ( meta === undefined || meta === '' );\r\n\r\n\t\tvar output = {};\r\n\r\n\t\tif ( isRootObject ) {\r\n\r\n            meta = {\r\n\t\t\t\tgeometries: {},\r\n\t\t\t\tmaterials: {},\r\n\t\t\t\ttextures: {},\r\n\t\t\t\timages: {}\r\n\t\t\t};\r\n            \r\n            \r\n            //this.collect_materials(meta);\r\n            //this.collect_geometry(meta);\r\n            var object = this.standard_serialization(meta);\r\n            \r\n            \r\n\t\t\toutput.metadata = {\r\n\t\t\t\tversion: 4.4,\r\n\t\t\t\ttype: 'Object',\r\n\t\t\t\tgenerator: 'Object3D.toJSON'\r\n\t\t\t};\r\n\r\n\t\t\tvar geometries = extractFromCache( meta.geometries, \"geoim\" );\r\n\t\t\tvar materials = extractFromCache( meta.materials, \"materials\" );\r\n\t\t\tvar textures = extractFromCache( meta.textures, \"textures\" );\r\n\t\t\tvar images = extractFromCache( meta.images, \"images\" );\r\n\r\n\t\t\tif ( geometries.length > 0 ) output.geometries = geometries;\r\n\t\t\tif ( materials.length > 0 ) output.materials = materials;\r\n\t\t\tif ( textures.length > 0 ) output.textures = textures;\r\n\t\t\tif ( images.length > 0 ) output.images = images;\r\n\r\n            var anims = this.collect_animations(this);\r\n            if (anims.count > 0) {\r\n                output[\"myanimations\"] = anims;\r\n            }\r\n           \r\n            output.object = object;\r\n\t\t} else {\r\n            output.object = this.standard_serialization(meta);\r\n            output.type = this.type;\r\n            if (output.object === undefined) {\r\n                console.log(\"i am undefined\", this);\r\n            }\r\n        }\r\n\r\n\t\treturn output;\r\n\r\n\r\n\t},\r\n    \r\n    collect_animations: function (scene)\r\n    {\r\n        var data = {\r\n            animations : {},\r\n            bindings : [],\r\n            count: 0\r\n        };\r\n        \r\n        function collect_animations_recursive(root)\r\n        {\r\n            if (root.animations) {\r\n                for(var i =0; i < root.animations.length; i++) {\r\n                    var anim = root.animations[i];\r\n                    if (data.animations[ anim.uuid ] === undefined) {\r\n                        data.animations[ anim.uuid] = anim.toJSON() ;\r\n                        data.count++;\r\n                    }\r\n                }\r\n                \r\n                var bind = {};\r\n                bind.uuid = root.uuid\r\n                bind.animations = [];\r\n                for(var i =0; i < root.animations.length; i++) {\r\n                    bind.animations.push( root.animations[i].uuid);\r\n                }\r\n                data.bindings.push(bind);\r\n            }\r\n            \r\n            if (root.children) {\r\n                for(var i = 0; i < root.children.length; i++) {\r\n                    collect_animations_recursive( root.children[i] );\r\n                }\r\n            }\r\n        }\r\n        collect_animations_recursive(scene);\r\n        return data;\r\n    },\r\n    \r\n \r\n};\r\n\r\n\r\n  _.copy_object(THREE.Object3D.prototype, Object3D_Serialization_Mixin);\r\n  \r\nTHREE.Object3D.prototype.dm_mark = 'yes,this object has been marked by black magic, owned by me, dark matters'; \r\n\r\n//replace source with this\r\nTHREE.Object3D.prototype.replace_object_with_this = function ( source ) {\r\n\r\n    this.uuid = source.uuid;\r\n    this.name = source.name;\r\n\r\n    this.up.copy( source.up );\r\n    this.position.copy( source.position );\r\n    this.quaternion.copy( source.quaternion );\r\n    this.scale.copy( source.scale );\r\n\r\n    this.matrix.copy( source.matrix );\r\n    this.matrixWorld.copy( source.matrixWorld );\r\n\r\n    this.matrixAutoUpdate = source.matrixAutoUpdate;\r\n    this.matrixWorldNeedsUpdate = source.matrixWorldNeedsUpdate;\r\n\r\n    this.visible = source.visible;\r\n\r\n    this.castShadow = source.castShadow;\r\n    this.receiveShadow = source.receiveShadow;\r\n\r\n    this.frustumCulled = source.frustumCulled;\r\n    this.renderOrder = source.renderOrder;\r\n\r\n    this.userData = JSON.parse( JSON.stringify( source.userData ) );\r\n\r\n    //copy array of children, not clone\r\n    for ( var i = 0; i < source.children.length; i ++ ) {\r\n        this.add( source.children[ i ] );\r\n    }\r\n    source.parent.add(this);\r\n    source.parent.remove(source);\r\n    \r\n    this.animations = source.animations;\r\n}\r\n\r\n\r\n}\r\n\r\nMix_It();\r\n\r\nexport {Mix_It};\n\n\n// WEBPACK FOOTER //\n// ./src/mixins/threejs_mixins.js","import {My_Lib} from '../base/my_lib.js';\r\nimport {Particle_Affector} from './particle_affector.js';\r\n\r\nfunction Custom_Affector()\r\n{\r\n\tParticle_Affector.apply(this, arguments);\r\n    this.custom_func = function dummy () {return true;};\r\n}\r\n\r\n\r\nCustom_Affector.prototype = Object.create(Particle_Affector.prototype);\r\n\r\n_.copy_object(Custom_Affector.prototype, \r\n    {\r\n    constructor: Custom_Affector,\r\n   \taffect: function (dt, pdata, vert)\r\n\t{\r\n        return this.custom_func(dt, p, vert);\r\n\t},\r\n    test_func: function () {\r\n        var p = {\r\n            position: {x: 0, y: 0, z: 0},\r\n            velocity: {x: 0, y: 0, z: 0}\r\n        };\r\n        var color = {r: 0, g: 0, b: 0};\r\n        this.custom_func(p, color);\r\n    },\r\n    set_affect_function: function (source) {    \r\n        if (typeof source === 'function') {\r\n            this.custom_func = source;\r\n        } else if (typeof source  === 'string') {\r\n            try {\r\n                this.custom_func = new Function ('dt,p,vert', source);\r\n                this.test_func();\r\n            }\r\n            catch (e) {\r\n                alert(e);\r\n                this.custom_func = undefined;\r\n            }\r\n            this.source_code = source;\r\n        }\r\n    },\r\n    \r\n\ttoJSON: function ()\r\n\t{\r\n        var data = {\r\n            name: \"Custom_Affector\"\r\n        };\r\n\t\tdata.params = My_Lib.Particle_Affector.prototype.toJSON.call(this, this);\r\n\t\tparams[\"source_code\"] = this.source_code;\r\n\t\treturn data;\r\n\t},\r\n\tparse: function (json)\r\n\t{\r\n\t\tMy_Lib.Particle_Affector.prototype.parse(this, json);\r\n\t\tthis.set_affect_func(json.source_code);\r\n\t}\r\n\r\n});\r\n\r\nMy_Lib.Register_Class(\"Custom_Affector\", Custom_Affector);\r\n\r\nexport {Custom_Affector};\n\n\n// WEBPACK FOOTER //\n// ./src/particles/custom_affector.js","import {My_Lib} from '../base/my_lib.js';\r\nimport {Particle_Emitter} from './particle_emitter.js';\r\n\r\n\r\nfunction Custom_Emitter()\r\n{\r\n\tParticle_Emitter.apply(this, arguments);\r\n}\r\n\r\n\r\nCustom_Emitter.prototype = Object.create(Particle_Emitter.prototype);\r\n\r\nvar methods = {\r\n    emit: function (p, color) {\r\n        if (this.custom_func) {\r\n            this.custom_func(p, color);\r\n        }\r\n    },\r\n    test_func: function () {\r\n        var p = {\r\n            position: {x: 0, y: 0, z: 0},\r\n            velocity: {x: 0, y: 0, z: 0}\r\n        };\r\n        var color = {r: 0, g: 0, b: 0};\r\n        this.custom_func(p, color);\r\n    },\r\n    set_emit_function: function (source) {\r\n        if (typeof source === 'function') {\r\n            this.custom_func = source;\r\n        } else if (typeof source  === 'string') {\r\n            try {\r\n                this.custom_func = new Function ('p', 'color', source);\r\n                this.test_func();\r\n            }\r\n            catch (e) {\r\n                alert(e);\r\n                this.custom_func = undefined;\r\n            }\r\n            this.source_code = source;\r\n        }\r\n    },\r\n    toJSON: function () {\r\n        var data = {};\r\n        data.name = \"Custom_Emitter\";\r\n        data.params = My_Lib.Particle_Emitter.prototype.toJSON.call(this, this);\r\n        if (this.source_code) {\r\n            data.params.source_code = this.source_code;\r\n        }\r\n        return data;\r\n    },\r\n    parse: function (data) {\r\n        My_Lib.Particle_Emitter.prototype.parse.call(this, data);        \r\n        this.set_emit_function (data.source_code);\r\n    },\r\n    constructor: Custom_Emitter,\r\n};\r\n\r\n_.copy_object(Custom_Emitter.prototype, methods);\r\nMy_Lib.Register_Class(\"Custom_Emitter\", Custom_Emitter);\r\n\r\n\r\nfunction test()\r\n{\r\n    var t = new Custom_Emitter();\r\n    var source = 'p.position.z = -100; p.velocity.y = 100;';\r\n    t.set_emit_function(source);\r\n    var p = {\r\n        velocity: {x: 0, y: 0, z: 0},\r\n        position: {x: 0, y: 0, z: 0}\r\n    };\r\n    t.custom_func(p);\r\n    console.log(p);\r\n    var json = t.toJSON();\r\n    console.log(json);\r\n    \r\n    t = new Custom_Emitter();\r\n    t.parse(json.params);\r\n    //console.log(t.custom_func);    \r\n}\r\n\r\n//test();\r\n\r\n/*\r\nCustom_Emitter.prototype = Object.create(My_Lib.Particle_Emitter.prototype);\r\nCustom_Emitter.prototype.constructor = Cone_Emitter;\r\nMy_Lib.Register_Class(\"Custom_Emitter\", Cone_Emitter);\r\n*/\r\n\r\nexport {Custom_Emitter};\n\n\n// WEBPACK FOOTER //\n// ./src/particles/custom_emitter.js","import {My_Lib} from '../base/my_lib.js';\r\n\r\nvar Particle_Forces = {};\r\n\r\n//base class\r\nParticle_Forces.Force = function ()\r\n{\r\n}\r\n\r\n\r\n_.copy_object(Particle_Forces.Force.prototype,{\r\n\t\tcalc: function (dt, particle, acceleration) \r\n\t\t{\r\n\t\t},\r\n\t\ttoJSON: function (child) \r\n\t\t{\r\n\t\t\treturn {};\r\n\t\t},\r\n\t\tparse: function (json) \r\n\t\t{\r\n\t\t},\r\n});\r\n\r\n//constant force\r\nParticle_Forces.Constant_Force = function (force)\r\n{\r\n\tif (typeof force !== 'undefined') {\r\n\t\tthis.force = force;\r\n\t} else {\r\n\t\tthis.force = {x:0, y:0, z:0};\r\n\t}\r\n}\r\n\r\nParticle_Forces.Constant_Force.prototype = Object.create(Particle_Forces.Force.prototype);\r\n_.copy_object(Particle_Forces.Constant_Force.prototype, {\r\n\tconstructor: Particle_Forces.Constant_Force,\r\n\tcalc: function (dt, p, acceleration) \r\n\t{\r\n\t\tacceleration.x += this.force.x;\r\n\t\tacceleration.y += this.force.y;\r\n\t\tacceleration.z += this.force.z;\r\n\t},\r\n\ttoJSON: function (child)\r\n\t{\r\n\t\tvar data = {};\r\n\t\tdata.name = \"Constant_Force\";\r\n\t\tdata.force = _.create_clone_object(this.force);\r\n\t\treturn data;\r\n\t},\r\n\tparse: function (json)\r\n\t{\t\r\n\t\tif (json.force) {\r\n\t\t\t_.copy_object(this.force, json.force);\r\n\t\t}\r\n\t}\r\n});\r\n\r\nMy_Lib.Register_Class(\"Constant_Force\", Particle_Forces.Constant_Force);\r\n\r\nexport {Particle_Forces};\n\n\n// WEBPACK FOOTER //\n// ./src/particles/forces.js","import {My_Lib} from '../base/my_lib.js';\r\nimport {Point_Generators} from './point_generators.js';\r\nimport {Particle_Emitter} from './particle_emitter.js';\r\nimport {Particle_Affector} from './particle_affector.js';\r\n\r\nfunction  Cone_Emitter()\r\n{\r\n\tParticle_Emitter.apply(this, arguments);\r\n\tthis.generator = new Point_Generators.Random_Direction();\r\n\tthis.origin = new THREE.Vector3(1, 1, 0);\r\n\tthis.velocity = new THREE.Vector3(0, 1, 0);\r\n\tthis.dispersion = {\"min\": 5, \"max\": 10};\r\n\tthis.dispersion.delta = 5;\r\n\tthis.speed = {min: 5, max: 10, delta:5};\r\n\tthis.color = new THREE.Color(1, 1, 1);\r\n}\r\n\r\nCone_Emitter.prototype = Object.create(Particle_Emitter.prototype);\r\nCone_Emitter.prototype.constructor = Cone_Emitter;\r\nMy_Lib.Register_Class(\"Cone_Emitter\", Cone_Emitter);\r\n\r\nCone_Emitter.prototype.toJSON = function ()\r\n{\r\n\tvar data = {};\r\n\tdata.name = \"Cone_Emitter\";\r\n\tdata.params = Particle_Emitter.prototype.toJSON.call(this, this);\r\n\t_.clone_field_list_one_level_recursion(this, data.params, \r\n\t[\"origin\", \r\n\t\"velocity\", \r\n\t\"dispersion\",\r\n\t\"speed\"]);\r\n\t\r\n\treturn data;\r\n}\r\n\r\nCone_Emitter.prototype.parse = function (data)\r\n{\r\n\tParticle_Emitter.prototype.parse.call(this, data);\r\n\tthis.origin.copy(data.origin);\r\n\tthis.velocity.copy(data.velocity);\r\n\tthis.set_dispersion(data.dispersion.min, data.dispersion.max);\r\n\tthis.set_speed(data.speed.min, data.speed.max);\r\n}\r\n\r\nCone_Emitter.prototype.set_speed = function (min, max)\r\n{\r\n\tthis.speed.min = min;\r\n\tthis.speed.max = max;\r\n\tthis.speed.delta = max - min;\r\n}\r\n\r\n\r\nCone_Emitter.prototype.set_dispersion = function (min, max)\r\n{\r\n\tthis.dispersion.min = min;\r\n\tthis.dispersion.max = max;\r\n\tthis.dispersion.delta = max - min;\r\n}\r\n\r\n\r\n\r\n\r\nCone_Emitter.prototype.emit = function (p, color, matrix)\r\n{\r\n\tp.position.copy(this.origin);\r\n\t\r\n\tthis.generator.get_direction(p.velocity);\r\n\tp.velocity.multiplyScalar(Math.random()*this.dispersion.delta + this.dispersion.min);\t\r\n\tp.velocity.add(this.velocity).normalize();\r\n\t\r\n    if (matrix) {\r\n        p.position.applyMatrix4(matrix);\r\n        p.velocity.applyMatrix4_rotation(matrix);\r\n    }\r\n        \r\n\tp.velocity.multiplyScalar(Math.random()*this.speed.delta + this.speed.min);\t\r\n\t\r\n    \r\n\tif (color) {\r\n\t\tthis.emit_color(color);\r\n\t}\r\n    \r\n}\r\n\r\nCone_Emitter.prototype.emit_color = function (color) \r\n{\r\n\tcolor.copy(this.color);\r\n}\r\n\r\nfunction Sphere_Emitter(radius, speed)\r\n{\r\n\tParticle_Emitter.call(this);\r\n\tthis.radius = radius || 1;\r\n    this.speed = speed || 1;\r\n\tthis.generator = new Point_Generators.Sphere(radius);\r\n    this.from_center = true;\r\n    Object.defineProperty(this, 'radius', {\r\n        configurable: true,\r\n        enumerable: true,\r\n        set: function (value) { radius = value; generator.radius = value;}\r\n    });\r\n}\r\n\r\nSphere_Emitter.prototype = Object.create(Particle_Emitter.prototype);\r\n\r\n_.copy_object(Sphere_Emitter.prototype, {\r\n    constructor: Sphere_Emitter,\r\n    emit: function (p, color, matrix)\r\n    {\r\n        if (this.from_center) {\r\n            p.position.set(0,0,0);\r\n        } else {\r\n            this.generator.get_point(p.position);\r\n        }\r\n        this.generator.get_normal(p.velocity);\r\n        if (matrix) {\r\n            p.position.applyMatrix4(matrix);\r\n            p.velocity.applyMatrix4_rotation(matrix);\r\n        }\r\n        p.velocity.multiplyScalar(this.speed);\r\n    },\r\n    toJSON: function (json) {\r\n\t\tvar params = Particle_Emitter.prototype.toJSON.call(this, this);\r\n        params.radius = this.radius;\r\n        params.speed = this.speed;\r\n        //params.generator.radius = this.radius;\r\n    },\r\n    parse: function (json) {\r\n\t\tParticle_Emitter.prototype.parse.call(this, json);\r\n        this.radius = json.radius;\r\n        this.speed = json.speed;\r\n    }\r\n});\r\n\r\nMy_Lib.Register_Class(\"Sphere_Emitter\", Sphere_Emitter);\r\n\r\n\r\nfunction Star_Dust_Emitter ()\r\n{\r\n\tParticle_Emitter.apply(this, arguments);\r\n\tthis.start_position = new THREE.Vector3(0, 0, 0);\r\n\tthis.end_position = new THREE.Vector3(1, 1, 1);\r\n\tthis.delta = new THREE.Vector3(1, 1, 1);\t\r\n\tthis.velocity = new THREE.Vector3(0, 0, 1);\r\n}\r\n\r\nStar_Dust_Emitter.prototype = Object.create(Particle_Emitter.prototype);\r\nStar_Dust_Emitter.prototype.constructor = Star_Dust_Emitter;\r\n_.copy_object( Star_Dust_Emitter.prototype,{\r\n\tset_velocity: function (x,y, z) \r\n\t{\r\n\t\tthis.velocity.set(x, y, z);\r\n\t},\r\n\tset_position_range : function (start, end)\r\n\t{\r\n\t\tthis.start_position.copy(start);\r\n\t\tthis.end_position.copy(end);\r\n\t\tthis.delta.set(end.x - start.x, end.y-start.y, end.z-start.z);\r\n\t\t\r\n\t},\r\n\tget_position: function (vector)\r\n\t{\r\n\t\tvector.x = Math.random() * this.delta.x + this.start_position.x;\r\n\t\tvector.y = Math.random() * this.delta.y + this.start_position.y;\r\n\t\tvector.z = Math.random() * this.delta.z + this.start_position.z;\r\n\t},\r\n\tget_velocity: function (vector)\r\n\t{\r\n\t\tvector.x = this.velocity.x;\r\n\t\tvector.y = this.velocity.y;\r\n\t\tvector.z = this.velocity.z;\r\n\t},\r\n\temit: function (p)\r\n\t{\r\n\t\tthis.get_position(p.position);\r\n\t\tif (this.parent) {\r\n\t\t\tthis.parent.localToWorld(p.position);\r\n\t\t}\r\n\t\tthis.get_velocity(p.velocity);\r\n\t},\r\n\ttoJSON: function ()\r\n\t{\r\n\t\tvar params = Particle_Emitter.prototype.toJSON.call(this, this);\r\n\t\t_.clone_field_list_one_level_recursion(this, params, [\"velocity\", \r\n\t\t\"start_position\",\r\n\t\t\"end_position\"])\r\n\t\tvar data = {\r\n\t\t\t\"name\": \"Star_Dust_Emitter\",\r\n\t\t\t\"params\": params,\r\n\t\t};\r\n\t\treturn data;\r\n\t},\r\n\tparse: function (json)\r\n\t{\r\n\t\tParticle_Emitter.prototype.parse.call(this, json);\r\n\t\tthis.set_position_range(json.start_position, json.end_position);\r\n\t\tthis.velocity.copy(json.velocity);\r\n\t}\r\n\t\r\n});\r\n\r\nMy_Lib.Register_Class(\"Star_Dust_Emitter\", Star_Dust_Emitter);\r\n\r\n\r\nfunction Star_Dust_Affector (end)\r\n{\r\n\tthis.end = end || 0;\r\n}\r\n\r\n\r\nStar_Dust_Affector.prototype = Object.create(Particle_Affector.prototype);\r\nStar_Dust_Affector.prototype.constructor = Star_Dust_Affector;\r\n\r\n_.copy_object(Star_Dust_Affector.prototype,{\r\n\taffect: function (dt, pdata, vert)\r\n\t{\r\n\t\tif (pdata.position.z > this.end) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t},\r\n\ttoJSON: function ()\r\n\t{\r\n\t\tvar params = Particle_Affector.prototype.toJSON.call(this, this);\r\n\t\tparams[\"end\"] = this.end;\r\n\t\tvar data = {\r\n\t\t\t\"name\": \"Star_Dust_Affector\",\r\n\t\t\t\"params\": params,\r\n\r\n\t\t};\r\n\t\treturn data;\r\n\t},\r\n\tparse: function (json)\r\n\t{\r\n\t\tParticle_Affector.prototype.parse(this, json);\r\n\t\tthis.end = json.end;\r\n\t}\r\n});\r\n\r\nMy_Lib.Register_Class(\"Star_Dust_Affector\", Star_Dust_Affector);\r\n\r\nexport {Cone_Emitter, Star_Dust_Emitter, Sphere_Emitter, Star_Dust_Affector};\n\n\n// WEBPACK FOOTER //\n// ./src/particles/test_emitters.js"],"sourceRoot":""}